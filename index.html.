<!DOCTYPE html>
<html lang="en" data-theme="dark" data-accent="cherry">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>GBA â€” Graphics By Amer</title>
<link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,300;0,400;0,600;1,300;1,400&family=Jost:wght@200;300;400;500&family=DM+Serif+Display:ital@0;1&display=swap" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/ScrollTrigger.min.js"></script>
<style>
/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   DESIGN TOKENS â€” THEME ENGINE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
:root {
  /* â”€â”€ Dark + Cherry (default) â”€â”€ */
  --primary: #C8264A;
  --primary-glow: rgba(200,38,74,.45);
  --secondary: #E8789A;
  --accent-rgb: 200,38,74;
  --bg: #0D0A0B;
  --bg2: #160F12;
  --text: #EDE8EA;
  --text-muted: #8A7F83;
  --card-bg: rgba(30,20,24,.88);
  --card-hover: rgba(45,30,36,.98);
  --card-dark: rgba(18,12,15,.92);
  --header-bg: rgba(13,10,11,.82);
  --panel-bg: #100C0E;
  --input-bg: rgba(22,15,18,.92);
  --border: rgba(255,255,255,.07);
  --border-strong: rgba(255,255,255,.12);
  --shadow: rgba(0,0,0,.4);
  --shadow-lg: rgba(0,0,0,.6);
  --grad-c1: #6B0018;
  --grad-c2: #C8264A;
  --grad-c3: #FF6B8A;
  --search-hl: rgba(200,38,74,.38);
  --logo-fill: #C8264A;
  --logo-brush: rgba(200,38,74,.35);
  --logo-glow: drop-shadow(0 0 8px rgba(200,38,74,.6));
}

/* â”€â”€ Dark + Mango â”€â”€ */
[data-theme="dark"][data-accent="mango"] {
  --primary: #F07B00;
  --primary-glow: rgba(240,123,0,.45);
  --secondary: #FFD166;
  --accent-rgb: 240,123,0;
  --bg: #0D0900;
  --bg2: #160E00;
  --text: #EDE8DF;
  --text-muted: #8A7D6A;
  --card-bg: rgba(30,22,8,.88);
  --card-hover: rgba(45,33,10,.98);
  --card-dark: rgba(18,13,4,.92);
  --header-bg: rgba(13,9,0,.82);
  --panel-bg: #0F0900;
  --input-bg: rgba(22,16,5,.92);
  --grad-c1: #6B3700;
  --grad-c2: #F07B00;
  --grad-c3: #FFD166;
  --search-hl: rgba(240,123,0,.38);
  --logo-fill: #F07B00;
  --logo-brush: rgba(240,123,0,.35);
  --logo-glow: drop-shadow(0 0 8px rgba(240,123,0,.6));
}

/* â”€â”€ Dark + Cocktail â”€â”€ */
[data-theme="dark"][data-accent="cocktail"] {
  --primary: #00C9A7;
  --primary-glow: rgba(0,201,167,.4);
  --secondary: #7B61FF;
  --accent-rgb: 0,201,167;
  --bg: #050E0D;
  --bg2: #091614;
  --text: #E0EDEB;
  --text-muted: #6A8A86;
  --card-bg: rgba(10,30,28,.88);
  --card-hover: rgba(15,45,42,.98);
  --card-dark: rgba(5,18,16,.92);
  --header-bg: rgba(5,14,13,.82);
  --panel-bg: #060F0E;
  --input-bg: rgba(10,22,20,.92);
  --grad-c1: #004D40;
  --grad-c2: #00C9A7;
  --grad-c3: #7B61FF;
  --search-hl: rgba(0,201,167,.38);
  --logo-fill: #00C9A7;
  --logo-brush: rgba(0,201,167,.3);
  --logo-glow: drop-shadow(0 0 8px rgba(0,201,167,.55));
}

/* â”€â”€ Light + Cherry â”€â”€ */
[data-theme="light"] {
  --primary: #B01F3E;
  --primary-glow: rgba(176,31,62,.3);
  --secondary: #D4607A;
  --accent-rgb: 176,31,62;
  --bg: #FAF7F8;
  --bg2: #F2ECED;
  --text: #1A0A0F;
  --text-muted: #7A6268;
  --card-bg: rgba(255,255,255,.82);
  --card-hover: rgba(255,255,255,.98);
  --card-dark: rgba(240,234,236,.7);
  --header-bg: rgba(250,247,248,.88);
  --panel-bg: #FAF7F8;
  --input-bg: rgba(255,255,255,.92);
  --border: rgba(0,0,0,.08);
  --border-strong: rgba(0,0,0,.13);
  --shadow: rgba(0,0,0,.07);
  --shadow-lg: rgba(0,0,0,.13);
  --grad-c1: #7A0020;
  --grad-c2: #B01F3E;
  --grad-c3: #E85A7A;
  --search-hl: rgba(176,31,62,.28);
  --logo-fill: #B01F3E;
  --logo-brush: rgba(176,31,62,.18);
  --logo-glow: drop-shadow(0 0 6px rgba(176,31,62,.4));
}

[data-theme="light"][data-accent="mango"] {
  --primary: #D46900;
  --primary-glow: rgba(212,105,0,.3);
  --secondary: #FFC044;
  --accent-rgb: 212,105,0;
  --bg: #FAF8F0;
  --bg2: #F2EDE0;
  --text: #1A1000;
  --text-muted: #7A6A48;
  --card-bg: rgba(255,255,255,.82);
  --card-hover: rgba(255,255,255,.98);
  --card-dark: rgba(240,235,220,.7);
  --header-bg: rgba(250,248,240,.88);
  --panel-bg: #FAF8F0;
  --input-bg: rgba(255,255,255,.92);
  --grad-c1: #7A3800;
  --grad-c2: #D46900;
  --grad-c3: #FFC044;
  --search-hl: rgba(212,105,0,.28);
  --logo-fill: #D46900;
  --logo-brush: rgba(212,105,0,.2);
  --logo-glow: drop-shadow(0 0 6px rgba(212,105,0,.4));
}

[data-theme="light"][data-accent="cocktail"] {
  --primary: #008C74;
  --primary-glow: rgba(0,140,116,.28);
  --secondary: #5A44CC;
  --accent-rgb: 0,140,116;
  --bg: #F0FAF8;
  --bg2: #E4F5F1;
  --text: #001A16;
  --text-muted: #4A7A72;
  --card-bg: rgba(255,255,255,.82);
  --card-hover: rgba(255,255,255,.98);
  --card-dark: rgba(220,240,236,.7);
  --header-bg: rgba(240,250,248,.88);
  --panel-bg: #F0FAF8;
  --input-bg: rgba(255,255,255,.92);
  --grad-c1: #004D40;
  --grad-c2: #008C74;
  --grad-c3: #5A44CC;
  --search-hl: rgba(0,140,116,.28);
  --logo-fill: #008C74;
  --logo-brush: rgba(0,140,116,.2);
  --logo-glow: drop-shadow(0 0 6px rgba(0,140,116,.4));
}

/* â”€â”€ Dark + Void (Deep Space Purple) â”€â”€ */
[data-theme="dark"][data-accent="void"] {
  --primary: #8B5CF6;
  --primary-glow: rgba(139,92,246,.5);
  --secondary: #C4B5FD;
  --accent-rgb: 139,92,246;
  --bg: #07050F;
  --bg2: #0E0A1A;
  --text: #EDE8FF;
  --text-muted: #7A6A9A;
  --card-bg: rgba(20,15,35,.88);
  --card-hover: rgba(30,22,52,.98);
  --card-dark: rgba(12,9,22,.92);
  --header-bg: rgba(7,5,15,.82);
  --panel-bg: #09060F;
  --input-bg: rgba(18,12,30,.92);
  --border: rgba(255,255,255,.07);
  --border-strong: rgba(255,255,255,.12);
  --shadow: rgba(0,0,0,.5);
  --shadow-lg: rgba(0,0,0,.7);
  --grad-c1: #3B0764;
  --grad-c2: #8B5CF6;
  --grad-c3: #EC4899;
  --search-hl: rgba(139,92,246,.38);
  --logo-fill: #8B5CF6;
  --logo-brush: rgba(139,92,246,.35);
  --logo-glow: drop-shadow(0 0 8px rgba(139,92,246,.7));
}

/* â”€â”€ Dark + Arctic (Ice Blue) â”€â”€ */
[data-theme="dark"][data-accent="arctic"] {
  --primary: #38BDF8;
  --primary-glow: rgba(56,189,248,.45);
  --secondary: #7DD3FC;
  --accent-rgb: 56,189,248;
  --bg: #030D14;
  --bg2: #071626;
  --text: #E0F4FF;
  --text-muted: #527A90;
  --card-bg: rgba(8,25,42,.88);
  --card-hover: rgba(12,38,62,.98);
  --card-dark: rgba(5,16,28,.92);
  --header-bg: rgba(3,13,20,.82);
  --panel-bg: #040F1A;
  --input-bg: rgba(8,20,35,.92);
  --border: rgba(56,189,248,.1);
  --border-strong: rgba(56,189,248,.18);
  --shadow: rgba(0,0,0,.5);
  --shadow-lg: rgba(0,0,0,.7);
  --grad-c1: #0C4A6E;
  --grad-c2: #38BDF8;
  --grad-c3: #BAE6FD;
  --search-hl: rgba(56,189,248,.28);
  --logo-fill: #38BDF8;
  --logo-brush: rgba(56,189,248,.25);
  --logo-glow: drop-shadow(0 0 8px rgba(56,189,248,.7));
}

/* â”€â”€ Dark + Ember (Volcanic Red-Orange) â”€â”€ */
[data-theme="dark"][data-accent="ember"] {
  --primary: #F97316;
  --primary-glow: rgba(249,115,22,.5);
  --secondary: #FCD34D;
  --accent-rgb: 249,115,22;
  --bg: #100800;
  --bg2: #1A0C00;
  --text: #FFF0E0;
  --text-muted: #8A6040;
  --card-bg: rgba(35,18,0,.88);
  --card-hover: rgba(50,25,0,.98);
  --card-dark: rgba(20,10,0,.92);
  --header-bg: rgba(16,8,0,.82);
  --panel-bg: #120900;
  --input-bg: rgba(28,14,0,.92);
  --border: rgba(255,255,255,.07);
  --border-strong: rgba(255,255,255,.12);
  --shadow: rgba(0,0,0,.5);
  --shadow-lg: rgba(0,0,0,.7);
  --grad-c1: #7C2D12;
  --grad-c2: #F97316;
  --grad-c3: #FCD34D;
  --search-hl: rgba(249,115,22,.38);
  --logo-fill: #F97316;
  --logo-brush: rgba(249,115,22,.35);
  --logo-glow: drop-shadow(0 0 8px rgba(249,115,22,.7));
}

/* â”€â”€ Dark + Forest (Deep Green) â”€â”€ */
[data-theme="dark"][data-accent="forest"] {
  --primary: #22C55E;
  --primary-glow: rgba(34,197,94,.45);
  --secondary: #86EFAC;
  --accent-rgb: 34,197,94;
  --bg: #030D06;
  --bg2: #06160A;
  --text: #E0FFE8;
  --text-muted: #4A7A58;
  --card-bg: rgba(8,28,14,.88);
  --card-hover: rgba(12,42,20,.98);
  --card-dark: rgba(5,18,9,.92);
  --header-bg: rgba(3,13,6,.82);
  --panel-bg: #040F07;
  --input-bg: rgba(8,22,12,.92);
  --border: rgba(34,197,94,.1);
  --border-strong: rgba(34,197,94,.18);
  --shadow: rgba(0,0,0,.5);
  --shadow-lg: rgba(0,0,0,.7);
  --grad-c1: #14532D;
  --grad-c2: #22C55E;
  --grad-c3: #86EFAC;
  --search-hl: rgba(34,197,94,.28);
  --logo-fill: #22C55E;
  --logo-brush: rgba(34,197,94,.25);
  --logo-glow: drop-shadow(0 0 8px rgba(34,197,94,.6));
}

/* â”€â”€ Dark + Rose Gold â”€â”€ */
[data-theme="dark"][data-accent="rosegold"] {
  --primary: #E8A598;
  --primary-glow: rgba(232,165,152,.45);
  --secondary: #F5C6BC;
  --accent-rgb: 232,165,152;
  --bg: #100A09;
  --bg2: #1A1210;
  --text: #FFF0EC;
  --text-muted: #8A6A65;
  --card-bg: rgba(32,20,18,.88);
  --card-hover: rgba(46,28,25,.98);
  --card-dark: rgba(20,12,10,.92);
  --header-bg: rgba(16,10,9,.82);
  --panel-bg: #120C0B;
  --input-bg: rgba(26,16,14,.92);
  --border: rgba(232,165,152,.1);
  --border-strong: rgba(232,165,152,.18);
  --shadow: rgba(0,0,0,.5);
  --shadow-lg: rgba(0,0,0,.7);
  --grad-c1: #7C3A2E;
  --grad-c2: #E8A598;
  --grad-c3: #F5C6BC;
  --search-hl: rgba(232,165,152,.3);
  --logo-fill: #E8A598;
  --logo-brush: rgba(232,165,152,.25);
  --logo-glow: drop-shadow(0 0 8px rgba(232,165,152,.6));
}

/* â”€â”€ Light + Void â”€â”€ */
[data-theme="light"][data-accent="void"] {
  --primary: #7C3AED;
  --primary-glow: rgba(124,58,237,.3);
  --secondary: #A78BFA;
  --accent-rgb: 124,58,237;
  --bg: #F9F7FF;
  --bg2: #F0ECFF;
  --text: #1A0A2E;
  --text-muted: #6A5A8A;
  --card-bg: rgba(255,255,255,.82);
  --card-hover: rgba(255,255,255,.98);
  --card-dark: rgba(235,228,255,.7);
  --header-bg: rgba(249,247,255,.88);
  --panel-bg: #F9F7FF;
  --input-bg: rgba(255,255,255,.92);
  --grad-c1: #4C1D95;
  --grad-c2: #7C3AED;
  --grad-c3: #EC4899;
  --search-hl: rgba(124,58,237,.25);
  --logo-fill: #7C3AED;
  --logo-brush: rgba(124,58,237,.18);
  --logo-glow: drop-shadow(0 0 6px rgba(124,58,237,.4));
}

/* â”€â”€ Light + Arctic â”€â”€ */
[data-theme="light"][data-accent="arctic"] {
  --primary: #0284C7;
  --primary-glow: rgba(2,132,199,.28);
  --secondary: #38BDF8;
  --accent-rgb: 2,132,199;
  --bg: #F0FAFF;
  --bg2: #E0F5FF;
  --text: #001A2E;
  --text-muted: #3A6A88;
  --card-bg: rgba(255,255,255,.82);
  --card-hover: rgba(255,255,255,.98);
  --card-dark: rgba(210,240,255,.7);
  --header-bg: rgba(240,250,255,.88);
  --panel-bg: #F0FAFF;
  --input-bg: rgba(255,255,255,.92);
  --border: rgba(0,0,0,.08);
  --border-strong: rgba(0,0,0,.13);
  --shadow: rgba(0,0,0,.07);
  --shadow-lg: rgba(0,0,0,.13);
  --grad-c1: #0C4A6E;
  --grad-c2: #0284C7;
  --grad-c3: #38BDF8;
  --search-hl: rgba(2,132,199,.25);
  --logo-fill: #0284C7;
  --logo-brush: rgba(2,132,199,.18);
  --logo-glow: drop-shadow(0 0 6px rgba(2,132,199,.4));
}

/* â”€â”€ Light + Ember â”€â”€ */
[data-theme="light"][data-accent="ember"] {
  --primary: #C2410C;
  --primary-glow: rgba(194,65,12,.28);
  --secondary: #FB923C;
  --accent-rgb: 194,65,12;
  --bg: #FFF7F0;
  --bg2: #FFEDE0;
  --text: #1A0800;
  --text-muted: #7A4A28;
  --card-bg: rgba(255,255,255,.82);
  --card-hover: rgba(255,255,255,.98);
  --card-dark: rgba(255,235,210,.7);
  --header-bg: rgba(255,247,240,.88);
  --panel-bg: #FFF7F0;
  --input-bg: rgba(255,255,255,.92);
  --border: rgba(0,0,0,.08);
  --border-strong: rgba(0,0,0,.13);
  --shadow: rgba(0,0,0,.07);
  --shadow-lg: rgba(0,0,0,.13);
  --grad-c1: #7C2D12;
  --grad-c2: #C2410C;
  --grad-c3: #FB923C;
  --search-hl: rgba(194,65,12,.25);
  --logo-fill: #C2410C;
  --logo-brush: rgba(194,65,12,.18);
  --logo-glow: drop-shadow(0 0 6px rgba(194,65,12,.4));
}

/* â”€â”€ Light + Forest â”€â”€ */
[data-theme="light"][data-accent="forest"] {
  --primary: #15803D;
  --primary-glow: rgba(21,128,61,.28);
  --secondary: #4ADE80;
  --accent-rgb: 21,128,61;
  --bg: #F0FFF4;
  --bg2: #DCFFE8;
  --text: #001A0D;
  --text-muted: #3A7A52;
  --card-bg: rgba(255,255,255,.82);
  --card-hover: rgba(255,255,255,.98);
  --card-dark: rgba(210,255,228,.7);
  --header-bg: rgba(240,255,244,.88);
  --panel-bg: #F0FFF4;
  --input-bg: rgba(255,255,255,.92);
  --border: rgba(0,0,0,.08);
  --border-strong: rgba(0,0,0,.13);
  --shadow: rgba(0,0,0,.07);
  --shadow-lg: rgba(0,0,0,.13);
  --grad-c1: #14532D;
  --grad-c2: #15803D;
  --grad-c3: #4ADE80;
  --search-hl: rgba(21,128,61,.25);
  --logo-fill: #15803D;
  --logo-brush: rgba(21,128,61,.18);
  --logo-glow: drop-shadow(0 0 6px rgba(21,128,61,.4));
}

/* â”€â”€ Light + Rose Gold â”€â”€ */
[data-theme="light"][data-accent="rosegold"] {
  --primary: #BE6E62;
  --primary-glow: rgba(190,110,98,.28);
  --secondary: #E8A598;
  --accent-rgb: 190,110,98;
  --bg: #FFF8F7;
  --bg2: #FFEEED;
  --text: #1A0806;
  --text-muted: #7A5250;
  --card-bg: rgba(255,255,255,.82);
  --card-hover: rgba(255,255,255,.98);
  --card-dark: rgba(255,235,232,.7);
  --header-bg: rgba(255,248,247,.88);
  --panel-bg: #FFF8F7;
  --input-bg: rgba(255,255,255,.92);
  --border: rgba(0,0,0,.08);
  --border-strong: rgba(0,0,0,.13);
  --shadow: rgba(0,0,0,.07);
  --shadow-lg: rgba(0,0,0,.13);
  --grad-c1: #7C3A32;
  --grad-c2: #BE6E62;
  --grad-c3: #F5C6BC;
  --search-hl: rgba(190,110,98,.25);
  --logo-fill: #BE6E62;
  --logo-brush: rgba(190,110,98,.18);
  --logo-glow: drop-shadow(0 0 6px rgba(190,110,98,.4));
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   ANIMATED GRADIENT PROPERTY
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
@property --grad-angle {
  syntax: '<angle>';
  inherits: false;
  initial-value: 0deg;
}
@keyframes spin-grad { to { --grad-angle: 360deg; } }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   RESET & BASE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
*, *::before, *::after { margin: 0; padding: 0; box-sizing: border-box; }
*:focus { outline: none; }
*:focus-visible { outline: 2px solid var(--primary); outline-offset: 2px; }
button, a, select, input, textarea { -webkit-tap-highlight-color: transparent; user-select: none; }
input, textarea { user-select: text; }
html { scroll-behavior: smooth; }
body {
  font-family: 'Jost', sans-serif;
  background: var(--bg); color: var(--text);
  transition: background .5s, color .5s;
  overflow-x: hidden; overflow-y: scroll;
  scrollbar-width: none; -ms-overflow-style: none;
}
body::-webkit-scrollbar { display: none; }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   SCROLL PROGRESS BAR
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#scroll-progress {
  position: fixed; top: 0; left: 0; height: 2.5px; z-index: 10001;
  background: linear-gradient(90deg, var(--grad-c1), var(--grad-c2), var(--grad-c3));
  width: 0%; transition: width .05s linear;
  box-shadow: 0 0 10px var(--primary-glow), 0 0 20px rgba(var(--accent-rgb),.3);
  pointer-events: none;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   KINETIC HERO TEXT
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.hero-title .kinetic-word {
  display: inline-block;
  transition: color .3s;
}
.hero-title em.kinetic-word {
  font-style: italic;
  background: linear-gradient(135deg, var(--grad-c2), var(--grad-c3));
  -webkit-background-clip: text; -webkit-text-fill-color: transparent;
  background-clip: text;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   PARALLAX HERO LAYERS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.hero-img-card { will-change: transform; }
.hero-parallax-float { will-change: transform; }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   BACKGROUND CANVAS (WebGL-style optimized)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#bg-canvas {
  position: fixed; inset: 0; z-index: 0; pointer-events: none;
  will-change: transform;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   CUSTOM CURSOR
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#cursor-blob {
  position: fixed; width: 28px; height: 28px; border-radius: 50%;
  pointer-events: none; z-index: 99998; mix-blend-mode: screen;
  background: radial-gradient(circle, rgba(var(--accent-rgb),.9) 0%, rgba(var(--accent-rgb),.3) 60%, transparent 100%);
  transform: translate(-50%,-50%);
  transition: width .18s ease, height .18s ease, background .4s ease;
  filter: blur(1px); display: none;
}
#cursor-blob.hovered { width: 52px; height: 52px; filter: blur(2px); }
#cursor-trail-canvas { position: fixed; inset: 0; pointer-events: none; z-index: 99997; }
@media(hover:none),(pointer:coarse),(max-width:1024px) {
  #cursor-blob, #cursor-trail-canvas { display: none !important; }
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   HEADER â€” Glassmorphism + Shrink on Scroll
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
header {
  position: fixed; top: 0; left: 0; right: 0; z-index: 1000;
  background: var(--header-bg);
  backdrop-filter: blur(24px) saturate(180%);
  -webkit-backdrop-filter: blur(24px) saturate(180%);
  border-bottom: 1px solid var(--border);
  height: 64px; display: flex; align-items: center;
  padding: 0 28px; gap: 16px;
  transition: height .3s cubic-bezier(.34,1.1,.64,1), background .5s, box-shadow .3s;
  overflow-x: auto; overflow-y: visible;
  scrollbar-width: none;
}
header::-webkit-scrollbar { display: none; }
header.shrunk {
  height: 52px;
  box-shadow: 0 4px 30px var(--shadow-lg);
  background: var(--header-bg);
}

/* Logo */
.logo-area {
  display: flex; align-items: center; gap: 10px;
  flex-shrink: 0; cursor: pointer;
}
.logo-svg-wrap {
  width: 42px; height: 42px; border-radius: 50%;
  border: 1.5px solid var(--border-strong);
  background: var(--card-bg);
  display: flex; align-items: center; justify-content: center;
  overflow: hidden; transition: box-shadow .3s, transform .3s;
  flex-shrink: 0;
}
.logo-svg-wrap:hover {
  box-shadow: 0 0 0 2px var(--primary), 0 0 24px var(--primary-glow);
  transform: scale(1.08);
}
.logo-svg-wrap svg {
  width: 38px; height: 38px;
  transition: filter .4s;
}
.logo-svg-wrap:hover svg { filter: var(--logo-glow); }
.logo-text {
  font-family: 'Cormorant Garamond', serif;
  font-size: 17px; font-weight: 300; letter-spacing: .12em;
  color: var(--text); white-space: nowrap;
}

/* Nav */
nav { display: flex; align-items: center; flex-shrink: 0; position: relative; }
.nav-link {
  font-family: 'Jost', sans-serif; font-weight: 400; font-size: 13px;
  letter-spacing: .07em; color: var(--text);
  padding: 6px 16px; border-radius: 20px; cursor: pointer;
  transition: color .25s; position: relative;
  background: none; border: none; white-space: nowrap;
}
.nav-link:hover, .nav-link.active { color: var(--primary); }
.nav-indicator {
  position: absolute; bottom: 2px; left: 0;
  height: 2px; background: var(--primary); border-radius: 2px;
  transition: none; pointer-events: none;
  box-shadow: 0 0 8px var(--primary-glow);
}

/* Header right */
.header-right { display: flex; align-items: center; gap: 10px; margin-left: auto; flex-shrink: 0; }

/* Search */
.search-bar {
  display: flex; align-items: center;
  background: var(--card-bg); border: 1.5px solid var(--border-strong);
  border-radius: 20px; padding: 5px 14px; gap: 6px;
  transition: border-color .2s, background .5s; backdrop-filter: blur(8px);
}
.search-bar:focus-within { border-color: var(--primary); }
.search-bar input {
  background: none; border: none; outline: none;
  font-family: 'Jost', sans-serif; font-size: 12px; color: var(--text); width: 120px;
}
.search-bar input::placeholder { color: var(--text-muted); }
.s-icon { color: var(--text-muted); font-size: 14px; line-height: 1; }

/* Mode menu button */
.mode-btn {
  display: flex; flex-direction: column; align-items: center; gap: 1px;
  cursor: pointer; background: var(--card-bg);
  border: 1.5px solid var(--border-strong); border-radius: 12px;
  padding: 4px 10px; transition: background .2s, border-color .2s;
  flex-shrink: 0; position: relative;
}
.mode-btn:hover { border-color: var(--primary); }
.mode-icon { font-size: 14px; line-height: 1.2; transition: transform .4s; }
.mode-label { font-size: 9px; letter-spacing: .1em; text-transform: uppercase; color: var(--text-muted); }
.mode-btn:hover .mode-icon { transform: rotate(20deg) scale(1.15); }

/* Sign Up button â€” magnetic */
.btn-signup {
  padding: 7px 18px; background: var(--primary); color: #fff;
  border: none; border-radius: 20px; font-family: 'Jost', sans-serif;
  font-weight: 400; font-size: 12px; letter-spacing: .07em; cursor: pointer;
  transition: transform .22s, box-shadow .22s;
  box-shadow: 0 4px 18px var(--primary-glow); white-space: nowrap; flex-shrink: 0;
}
.btn-signup:hover { transform: translateY(-2px); box-shadow: 0 8px 28px var(--primary-glow); }

/* Hamburger */
.hamburger {
  width: 34px; height: 34px; display: flex; flex-direction: column;
  justify-content: center; align-items: center; gap: 4px;
  cursor: pointer; border-radius: 10px;
  border: 1.5px solid var(--border-strong);
  background: var(--card-bg); transition: background .2s;
  position: relative; flex-shrink: 0;
}
.hamburger:hover { background: var(--card-hover); }
.hamburger span { width: 14px; height: 1.5px; background: var(--text); border-radius: 2px; transition: background .3s; }

/* Dropdown */
.dd {
  position: fixed; top: 72px; right: 20px;
  background: var(--panel-bg); border: 1px solid var(--border-strong);
  border-radius: 16px; padding: 6px; min-width: 170px;
  box-shadow: 0 16px 50px var(--shadow-lg);
  display: none; flex-direction: column; gap: 2px; z-index: 9999;
  backdrop-filter: blur(24px); -webkit-backdrop-filter: blur(24px);
}
.dd.open { display: flex; animation: ddIn .2s cubic-bezier(.34,1.2,.64,1); }
@keyframes ddIn { from { opacity:0; transform:translateY(-10px) scale(.96); } to { opacity:1; transform:translateY(0) scale(1); } }
.dd-item {
  padding: 10px 16px; border-radius: 10px; cursor: pointer; font-size: 13px;
  color: var(--text); transition: background .15s, color .15s;
  border: none; background: none; text-align: left; font-family: 'Jost', sans-serif;
}
.dd-item:hover { background: var(--card-bg); color: var(--primary); }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   MODE MENU PANEL
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.mode-panel {
  position: fixed; top: 72px; right: 20px;
  background: var(--panel-bg); border: 1px solid var(--border-strong);
  border-radius: 20px; padding: 20px; width: 340px;
  max-height: calc(100vh - 90px); overflow-y: auto;
  box-shadow: 0 20px 60px var(--shadow-lg);
  display: none; flex-direction: column; gap: 16px; z-index: 9999;
  backdrop-filter: blur(28px); -webkit-backdrop-filter: blur(28px);
  scrollbar-width: thin; scrollbar-color: var(--border-strong) transparent;
}
.mode-panel::-webkit-scrollbar { width: 3px; }
.mode-panel::-webkit-scrollbar-thumb { background: var(--border-strong); border-radius: 2px; }
.mode-panel.open { display: flex; animation: ddIn .22s cubic-bezier(.34,1.2,.64,1); }
.mode-panel-title {
  font-size: 10px; letter-spacing: .18em; text-transform: uppercase;
  color: var(--text-muted); margin-bottom: 2px;
}
.mode-row { display: flex; gap: 8px; }
.mode-pill {
  flex: 1; padding: 9px 12px; border-radius: 12px; cursor: pointer;
  border: 1.5px solid var(--border-strong); background: var(--card-bg);
  font-family: 'Jost', sans-serif; font-size: 12px; color: var(--text);
  transition: all .2s; text-align: center; font-weight: 400;
}
.mode-pill:hover { border-color: var(--primary); color: var(--primary); }
.mode-pill.active { background: var(--primary); color: #fff; border-color: var(--primary); }
.accent-row { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 8px; }
.accent-pill {
  padding: 10px 8px; border-radius: 12px; cursor: pointer;
  border: 1.5px solid var(--border-strong); background: var(--card-bg);
  font-family: 'Jost', sans-serif; font-size: 11px; color: var(--text);
  transition: all .2s; text-align: center; display: flex;
  flex-direction: column; gap: 6px; align-items: center;
}
.accent-pill:hover { transform: translateY(-2px); }
.accent-pill.active { border-width: 2px; }
.accent-dot { width: 20px; height: 20px; border-radius: 50%; }
.accent-cherry .accent-dot { background: linear-gradient(135deg,#C8264A,#FF6B8A); }
.accent-cherry.active { border-color: #C8264A; color: #C8264A; }
.accent-mango .accent-dot { background: linear-gradient(135deg,#F07B00,#FFD166); }
.accent-mango.active { border-color: #F07B00; color: #F07B00; }
.accent-cocktail .accent-dot { background: linear-gradient(135deg,#00C9A7,#7B61FF); }
.accent-cocktail.active { border-color: #00C9A7; color: #00C9A7; }
.accent-void .accent-dot { background: linear-gradient(135deg,#8B5CF6,#EC4899); box-shadow: 0 0 8px rgba(139,92,246,.6); }
.accent-void.active { border-color: #8B5CF6; color: #8B5CF6; }
.accent-arctic .accent-dot { background: linear-gradient(135deg,#38BDF8,#7DD3FC); box-shadow: 0 0 8px rgba(56,189,248,.6); }
.accent-arctic.active { border-color: #38BDF8; color: #38BDF8; }
.accent-ember .accent-dot { background: linear-gradient(135deg,#F97316,#FCD34D); box-shadow: 0 0 8px rgba(249,115,22,.6); }
.accent-ember.active { border-color: #F97316; color: #F97316; }
.accent-forest .accent-dot { background: linear-gradient(135deg,#22C55E,#86EFAC); box-shadow: 0 0 8px rgba(34,197,94,.6); }
.accent-forest.active { border-color: #22C55E; color: #22C55E; }
.accent-rosegold .accent-dot { background: linear-gradient(135deg,#E8A598,#F5C6BC); box-shadow: 0 0 8px rgba(232,165,152,.6); }
.accent-rosegold.active { border-color: #E8A598; color: #E8A598; }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   MAIN
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
main { position: relative; z-index: 1; padding-top: 64px; }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   MARQUEE TICKER (2025 trend #4 bonus)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.marquee-strip {
  width: 100%; overflow: hidden; padding: 14px 0;
  border-top: 1px solid var(--border);
  border-bottom: 1px solid var(--border);
  background: var(--card-dark);
  position: relative; z-index: 1;
}
.marquee-track {
  display: flex; gap: 0; width: max-content;
  animation: marqueeScroll 28s linear infinite;
}
.marquee-strip:hover .marquee-track { animation-play-state: paused; }
.marquee-item {
  display: flex; align-items: center; gap: 10px;
  padding: 0 32px; white-space: nowrap;
  font-family: 'Cormorant Garamond', serif;
  font-size: 13px; letter-spacing: .22em; text-transform: uppercase;
  color: var(--text-muted); font-weight: 300;
}
.marquee-dot {
  width: 5px; height: 5px; border-radius: 50%;
  background: var(--primary); flex-shrink: 0;
  box-shadow: 0 0 6px var(--primary-glow);
}
@keyframes marqueeScroll {
  from { transform: translateX(0); }
  to { transform: translateX(-50%); }
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   HERO SECTION
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#home {
  min-height: calc(100vh - 64px);
  display: grid; grid-template-columns: 1fr 1fr;
  align-items: center;
  padding: 80px 7%; gap: 48px;
  position: relative; z-index: 1;
}

.hero-left {
  display: flex; flex-direction: column; gap: 28px;
  opacity: 0; transform: translateX(-40px);
}
.hero-img-card {
  width: 100%; aspect-ratio: 4/5; max-height: 520px;
  border-radius: 40px 40px 28px 28px;
  background: var(--card-bg);
  border: 1.5px solid var(--border-strong);
  box-shadow: 0 24px 80px var(--shadow-lg);
  position: relative; overflow: hidden;
  padding: 2px;
  transition: transform .5s cubic-bezier(.34,1.1,.64,1);
}
.hero-img-card:hover { transform: scale(1.018) translateY(-4px); }
.hero-img-card::before {
  content: ''; position: absolute; inset: -1px; border-radius: inherit;
  background: conic-gradient(from var(--grad-angle),var(--grad-c1),var(--grad-c2),var(--grad-c3),var(--grad-c1));
  animation: spin-grad 5s linear infinite; z-index: 0;
}
.hero-img-card::after {
  content: ''; position: absolute; inset: 2px; border-radius: 38px 38px 26px 26px;
  background: linear-gradient(160deg,var(--bg2) 0%,var(--card-bg) 100%);
  z-index: 1;
}
.hero-img-inner {
  position: absolute; inset: 2px; border-radius: 38px 38px 26px 26px;
  z-index: 2; display: flex; align-items: flex-end; justify-content: flex-start;
  padding: 28px;
  background: linear-gradient(160deg,var(--bg2) 0%,var(--card-bg) 60%);
}
.hero-img-inner::before {
  content: ''; position: absolute; bottom: 0; left: 50%; transform: translateX(-50%);
  width: 60%; height: 75%;
  background: linear-gradient(180deg,transparent 0%,var(--border-strong) 30%,var(--border) 100%);
  border-radius: 60% 60% 0 0; opacity: .18;
}
.phone-tag {
  position: relative; z-index: 3;
  background: var(--primary);
  backdrop-filter: blur(10px);
  border-radius: 14px; padding: 10px 18px;
  color: #fff; font-size: 13px; font-weight: 400; letter-spacing: .08em;
  box-shadow: 0 8px 30px var(--primary-glow);
  display: flex; align-items: center; gap: 8px;
  animation: pulsePill 3s ease-in-out infinite;
}
@keyframes pulsePill {
  0%,100% { box-shadow: 0 8px 30px var(--primary-glow); }
  50% { box-shadow: 0 12px 40px rgba(var(--accent-rgb),.7); }
}
.phone-tag::before { content: 'ğŸ“'; font-size: 15px; }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   HERO CSS ART
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.hero-art {
  position: absolute; inset: 0; border-radius: inherit;
  overflow: hidden; z-index: 2;
  display: flex; align-items: center; justify-content: center;
  background: radial-gradient(ellipse 70% 60% at 50% 40%, rgba(var(--accent-rgb),.07) 0%, transparent 70%);
}

/* Grid background */
.hero-art-grid {
  position: absolute; inset: 0;
  background-image:
    linear-gradient(rgba(var(--accent-rgb),.06) 1px, transparent 1px),
    linear-gradient(90deg, rgba(var(--accent-rgb),.06) 1px, transparent 1px);
  background-size: 42px 42px;
  mask-image: radial-gradient(ellipse 80% 80% at 50% 40%, black 30%, transparent 100%);
}

/* Center orb glow */
.hero-art-orb {
  position: absolute; width: 180px; height: 180px; border-radius: 50%;
  background: radial-gradient(circle, rgba(var(--accent-rgb),.18) 0%, rgba(var(--accent-rgb),.06) 50%, transparent 75%);
  filter: blur(18px);
  animation: orbPulse 4s ease-in-out infinite;
}
@keyframes orbPulse {
  0%,100% { transform: scale(1); opacity: .8; }
  50% { transform: scale(1.2); opacity: 1; }
}

/* Main ring */
.hero-art-ring {
  position: absolute; border-radius: 50%;
  border: 1px solid rgba(var(--accent-rgb),.25);
  box-shadow: 0 0 0 1px rgba(var(--accent-rgb),.05) inset;
}
.hero-art-ring-1 {
  width: 200px; height: 200px;
  border-style: dashed;
  animation: spinRing 18s linear infinite;
}
.hero-art-ring-2 {
  width: 270px; height: 270px;
  border-color: rgba(var(--accent-rgb),.14);
  animation: spinRing 28s linear infinite reverse;
}
.hero-art-ring-3 {
  width: 340px; height: 340px;
  border-color: rgba(var(--accent-rgb),.08);
  border-style: dotted;
  animation: spinRing 40s linear infinite;
}
@keyframes spinRing { to { transform: rotate(360deg); } }

/* Orbiting dots */
.hero-art-orb-dot {
  position: absolute; border-radius: 50%;
  background: var(--primary);
  box-shadow: 0 0 12px var(--primary-glow), 0 0 24px rgba(var(--accent-rgb),.4);
}
.hero-art-ring-1 .hero-art-orb-dot {
  width: 8px; height: 8px;
  top: -4px; left: 50%; transform: translateX(-50%);
}
.hero-art-ring-2 .hero-art-orb-dot {
  width: 6px; height: 6px;
  bottom: -3px; left: 50%; transform: translateX(-50%);
  background: var(--secondary);
  box-shadow: 0 0 10px rgba(var(--accent-rgb),.6);
}
.hero-art-ring-3 .hero-art-orb-dot {
  width: 5px; height: 5px;
  top: 50%; right: -2.5px; transform: translateY(-50%);
  background: rgba(var(--accent-rgb),.7);
  box-shadow: 0 0 8px rgba(var(--accent-rgb),.5);
}

/* Center monogram */
.hero-art-monogram {
  position: relative; z-index: 3;
  display: flex; flex-direction: column; align-items: center; gap: 4px;
}
.hero-art-letters {
  font-family: 'Cormorant Garamond', serif;
  font-size: 64px; font-weight: 600; line-height: 1;
  letter-spacing: .08em;
  background: linear-gradient(160deg, var(--grad-c3) 0%, var(--grad-c2) 50%, var(--grad-c1) 100%);
  -webkit-background-clip: text; -webkit-text-fill-color: transparent;
  background-clip: text;
  filter: drop-shadow(0 0 20px rgba(var(--accent-rgb),.5));
  animation: monogramGlow 4s ease-in-out infinite;
}
@keyframes monogramGlow {
  0%,100% { filter: drop-shadow(0 0 16px rgba(var(--accent-rgb),.4)); }
  50% { filter: drop-shadow(0 0 32px rgba(var(--accent-rgb),.8)); }
}
.hero-art-tagline {
  font-family: 'Jost', sans-serif; font-size: 9px;
  letter-spacing: .35em; text-transform: uppercase;
  color: var(--text-muted); opacity: .7;
}

/* Floating geometric chips */
.hero-art-chip {
  position: absolute;
  border: 1px solid rgba(var(--accent-rgb),.3);
  border-radius: 6px;
  background: rgba(var(--accent-rgb),.05);
  backdrop-filter: blur(4px);
  display: flex; align-items: center; justify-content: center;
  font-family: 'Jost', sans-serif; font-size: 9px;
  letter-spacing: .1em; color: var(--primary); opacity: .8;
  padding: 5px 10px; white-space: nowrap;
}
.hero-art-chip-1 {
  top: 18%; left: 8%;
  animation: floatA 6s ease-in-out infinite;
}
.hero-art-chip-2 {
  top: 22%; right: 7%;
  animation: floatB 7s ease-in-out infinite;
}
.hero-art-chip-3 {
  top: 62%; right: 9%;
  animation: floatA 8s ease-in-out infinite .5s;
}
@keyframes floatA {
  0%,100% { transform: translateY(0px) rotate(-1deg); }
  50% { transform: translateY(-10px) rotate(1deg); }
}
@keyframes floatB {
  0%,100% { transform: translateY(0px) rotate(1deg); }
  50% { transform: translateY(-13px) rotate(-1deg); }
}

/* Corner crosses */
.hero-art-cross {
  position: absolute; width: 14px; height: 14px;
  opacity: .3;
}
.hero-art-cross::before, .hero-art-cross::after {
  content: ''; position: absolute; background: var(--primary);
  border-radius: 1px;
}
.hero-art-cross::before { width: 14px; height: 1.5px; top: 50%; left: 0; transform: translateY(-50%); }
.hero-art-cross::after { width: 1.5px; height: 14px; left: 50%; top: 0; transform: translateX(-50%); }
.hero-art-cross-tl { top: 18px; left: 18px; }
.hero-art-cross-tr { top: 18px; right: 18px; }
.hero-art-cross-br { bottom: 70px; right: 18px; }

/* Scan line effect */
.hero-art-scan {
  position: absolute; left: 0; right: 0; height: 1px;
  background: linear-gradient(90deg, transparent, rgba(var(--accent-rgb),.4), transparent);
  animation: scanLine 5s ease-in-out infinite;
  opacity: 0;
}
@keyframes scanLine {
  0% { top: 10%; opacity: 0; }
  10% { opacity: .7; }
  90% { opacity: .4; }
  100% { top: 90%; opacity: 0; }
}

/* Diamond shape */
.hero-art-diamond {
  position: absolute; width: 10px; height: 10px;
  background: var(--primary); opacity: .5;
  transform: rotate(45deg);
  animation: floatB 9s ease-in-out infinite;
}
.hero-art-diamond-1 { top: 40%; left: 9%; }
.hero-art-diamond-2 { bottom: 28%; left: 12%; animation-delay: 2s; opacity: .3; width: 6px; height: 6px; }

/* Hero right */
.hero-right {
  display: flex; flex-direction: column; gap: 32px;
  opacity: 0; transform: translateX(40px);
}
.hero-eyebrow {
  font-size: 11px; letter-spacing: .22em; text-transform: uppercase;
  color: var(--primary); font-weight: 400;
}
.hero-title {
  font-family: 'DM Serif Display', serif;
  font-size: clamp(36px,5vw,68px);
  line-height: 1.08; letter-spacing: -.01em; color: var(--text);
  font-weight: 400;
}
.hero-title em {
  font-style: italic; color: var(--primary);
  text-shadow: 0 0 40px var(--primary-glow);
}
.hero-sub {
  font-size: 14px; color: var(--text-muted); line-height: 1.9;
  max-width: 420px; font-weight: 300;
}
.hero-actions { display: flex; gap: 14px; flex-wrap: wrap; }

/* Magnetic buttons */
.btn-p {
  padding: 13px 30px; background: var(--primary); color: #fff;
  border: none; border-radius: 24px; font-family: 'Jost', sans-serif;
  font-weight: 400; font-size: 13px; letter-spacing: .07em; cursor: pointer;
  transition: transform .22s, box-shadow .22s;
  box-shadow: 0 6px 24px var(--primary-glow); white-space: nowrap;
  position: relative; overflow: hidden;
}
.btn-p::after {
  content: ''; position: absolute; inset: 0; border-radius: inherit;
  background: rgba(255,255,255,.12); opacity: 0; transition: opacity .2s;
}
.btn-p:hover::after { opacity: 1; }
.btn-p:hover { transform: translateY(-3px); box-shadow: 0 12px 36px rgba(var(--accent-rgb),.5); }

.btn-o {
  padding: 13px 30px; background: transparent; color: var(--text);
  border: 1.5px solid var(--border-strong); border-radius: 24px;
  font-family: 'Jost', sans-serif; font-weight: 400; font-size: 13px;
  letter-spacing: .07em; cursor: pointer;
  transition: transform .22s, border-color .22s, color .22s; white-space: nowrap;
}
.btn-o:hover { border-color: var(--primary); color: var(--primary); transform: translateY(-3px); }

/* Floating badge */
.hero-badge {
  display: inline-flex; align-items: center; gap: 10px;
  background: var(--card-bg); border: 1.5px solid var(--border-strong);
  border-radius: 50px; padding: 10px 20px;
  backdrop-filter: blur(12px); width: fit-content;
  animation: floatUp 4s ease-in-out infinite;
}
@keyframes floatUp { 0%,100% { transform: translateY(0); } 50% { transform: translateY(-8px); } }
.badge-dot {
  width: 8px; height: 8px; border-radius: 50%; background: #4ade80;
  box-shadow: 0 0 10px rgba(74,222,128,.8);
  animation: dotPulse 2s ease-in-out infinite;
}
@keyframes dotPulse { 0%,100% { transform: scale(1); } 50% { transform: scale(1.4); } }
.badge-text { font-size: 12px; color: var(--text-muted); letter-spacing: .05em; }

/* â”€â”€ STATS ROW â”€â”€ */
.stats-row {
  display: flex; gap: 32px; padding: 0 7%;
  position: relative; z-index: 1;
}
.stat-item { text-align: center; }
.stat-num {
  font-family: 'DM Serif Display', serif;
  font-size: clamp(36px,4vw,56px); color: var(--primary);
  line-height: 1; display: block;
}
.stat-label {
  font-size: 11px; letter-spacing: .14em; text-transform: uppercase;
  color: var(--text-muted); margin-top: 4px; display: block;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   SEPARATORS & SECTION TITLES
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.sep { height: 80px; }
.sec-eyebrow {
  font-size: 11px; letter-spacing: .22em; text-transform: uppercase;
  color: var(--primary); margin-bottom: 10px; display: block;
}
.sec-title {
  font-family: 'DM Serif Display', serif;
  font-size: clamp(28px,4vw,48px); font-weight: 400;
  letter-spacing: -.01em; margin-bottom: 48px;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   ABOUT / ACCORDION CARDS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#about { padding: 80px 7%; position: relative; z-index: 1; }
.cards-row { display: flex; gap: 16px; align-items: flex-start; }
.acard {
  flex: 1; min-width: 0;
  background: var(--card-dark);
  border: 1.5px solid var(--border);
  border-radius: 24px; padding: 28px;
  cursor: pointer; position: relative; overflow: hidden;
  transition: flex .6s cubic-bezier(.34,1.1,.64,1), background .4s, border-color .4s, box-shadow .4s, filter .4s;
  filter: brightness(.85);
}
.acard.active { flex: 2.6; background: var(--card-bg); border-color: var(--primary); box-shadow: 0 20px 70px var(--shadow-lg); filter: brightness(1); }
.acard:not(.active) { filter: brightness(.72); }
.acard:not(.active):hover { filter: brightness(.88); }
.acard::before {
  content: ''; position: absolute; inset: -1px; border-radius: inherit;
  background: conic-gradient(from var(--grad-angle),var(--grad-c1),var(--grad-c2),var(--grad-c3),var(--grad-c1));
  animation: spin-grad 5s linear infinite; opacity: 0; transition: opacity .4s; z-index: 0;
}
.acard.active::before { opacity: 1; }
.acard::after {
  content: ''; position: absolute; inset: 2px; border-radius: 22px;
  background: var(--card-dark); z-index: 0; transition: background .4s;
}
.acard.active::after { background: var(--card-bg); }
.acard > * { position: relative; z-index: 1; }
.acard-img {
  width: 56px; height: 56px; border-radius: 50%;
  border: 1.5px solid var(--border-strong); background: var(--bg2);
  margin-bottom: 18px; transition: transform .4s, box-shadow .4s; flex-shrink: 0;
}
.acard.active .acard-img { transform: scale(1.1); box-shadow: 0 0 0 3px var(--primary), 0 0 20px var(--primary-glow); }
.acard-tag {
  font-size: 10px; letter-spacing: .15em; text-transform: uppercase;
  color: var(--primary); margin-bottom: 8px; display: block;
  opacity: 0; transform: translateY(6px); transition: opacity .4s .1s, transform .4s .1s;
}
.acard.active .acard-tag { opacity: 1; transform: translateY(0); }
.acard-title { font-family: 'DM Serif Display', serif; font-size: 22px; font-weight: 400; margin-bottom: 14px; line-height: 1.2; transition: font-size .4s; }
.acard:not(.active) .acard-title { font-size: 17px; }
.acard-preview { position: relative; max-height: 90px; overflow: hidden; transition: max-height .55s cubic-bezier(.34,1.1,.64,1); }
.acard.active .acard-preview { max-height: 600px; }
.acard-preview::after {
  content: ''; position: absolute; bottom: 0; left: 0; right: 0; height: 50px;
  background: linear-gradient(transparent,var(--card-dark)); transition: opacity .4s; pointer-events: none;
}
.acard.active .acard-preview::after { opacity: 0; }
.acard-text { font-size: 13px; color: var(--text-muted); line-height: 1.85; font-weight: 300; }
.acard-more { display: flex; align-items: center; gap: 6px; font-size: 11px; letter-spacing: .1em; text-transform: uppercase; color: var(--primary); margin-top: 18px; opacity: 0; transform: translateY(8px); transition: opacity .35s .2s, transform .35s .2s; }
.acard.active .acard-more { opacity: 1; transform: translateY(0); }
.acard-more-line { flex: 1; height: 1px; background: linear-gradient(90deg,var(--primary),transparent); }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   PREVIOUS WORKS SECTION
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#works { padding: 80px 7%; position: relative; z-index: 1; }
.works-header { display: flex; justify-content: space-between; align-items: flex-end; margin-bottom: 48px; }
.works-header .sec-title { margin-bottom: 0; }
.works-arrow {
  display: flex; align-items: center; gap: 8px;
  font-size: 12px; letter-spacing: .1em; text-transform: uppercase;
  color: var(--text-muted); cursor: pointer;
  transition: color .2s, gap .2s; border: none; background: none;
}
.works-arrow:hover { color: var(--primary); gap: 14px; }
.works-scroll { overflow-x: auto; padding-bottom: 12px; scrollbar-width: none; }
.works-scroll::-webkit-scrollbar { display: none; }
.works-row { display: flex; gap: 18px; width: max-content; padding: 4px 2px 8px; }
.work-card {
  width: 280px; height: 200px; background: var(--card-dark);
  border: 1.5px solid var(--border); border-radius: 20px;
  cursor: pointer; flex-shrink: 0; position: relative; overflow: hidden;
  transition: transform .38s cubic-bezier(.34,1.56,.64,1), box-shadow .38s, filter .38s;
  padding: 2px;
}
.work-card::before {
  content: ''; position: absolute; inset: -1px; border-radius: inherit;
  background: conic-gradient(from calc(var(--grad-angle)+80deg),var(--grad-c1),var(--grad-c2),var(--grad-c3),var(--grad-c1));
  animation: spin-grad 6s linear infinite; opacity: 0; transition: opacity .35s; z-index: 0;
}
.work-card:hover::before { opacity: 1; }
.work-card::after { content: ''; position: absolute; inset: 2px; border-radius: 18px; background: var(--card-dark); z-index: 0; transition: background .4s; }
.work-card:hover { transform: translateY(-10px) scale(1.02); box-shadow: 0 24px 60px var(--shadow-lg); }
.work-card-inner { position: absolute; inset: 2px; border-radius: 18px; z-index: 1; display: flex; align-items: flex-end; padding: 18px; }
.work-label { font-size: 12px; color: var(--text-muted); letter-spacing: .1em; text-transform: uppercase; opacity: .5; }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   NEWSLETTER SECTION
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#newsletter {
  padding: 80px 7%; position: relative; z-index: 1;
  display: flex; flex-direction: column; align-items: center; text-align: center;
}
.newsletter-card {
  background: var(--card-bg); border: 1.5px solid var(--border-strong);
  border-radius: 32px; padding: 60px 48px; max-width: 600px; width: 100%;
  position: relative; overflow: hidden;
  box-shadow: 0 20px 80px var(--shadow-lg);
}
.newsletter-card::before {
  content: ''; position: absolute; inset: -1px; border-radius: inherit;
  background: conic-gradient(from var(--grad-angle),var(--grad-c1),var(--grad-c2),var(--grad-c3),var(--grad-c1));
  animation: spin-grad 8s linear infinite; z-index: 0;
}
.newsletter-card::after {
  content: ''; position: absolute; inset: 2px; border-radius: 30px;
  background: var(--card-bg); z-index: 0;
}
.newsletter-card > * { position: relative; z-index: 1; }
.newsletter-eyebrow { font-size: 11px; letter-spacing: .22em; text-transform: uppercase; color: var(--primary); margin-bottom: 12px; display: block; }
.newsletter-title { font-family: 'DM Serif Display', serif; font-size: clamp(24px,3vw,36px); margin-bottom: 16px; }
.newsletter-sub { font-size: 13px; color: var(--text-muted); line-height: 1.8; margin-bottom: 32px; max-width: 420px; margin-left: auto; margin-right: auto; }
.newsletter-form { display: flex; gap: 10px; max-width: 420px; margin: 0 auto; }
.newsletter-form input {
  flex: 1; padding: 12px 18px; background: var(--input-bg);
  border: 1.5px solid var(--border-strong); border-radius: 20px;
  font-family: 'Jost', sans-serif; font-size: 13px; color: var(--text);
  outline: none; transition: border-color .2s;
}
.newsletter-form input:focus { border-color: var(--primary); }
.newsletter-form input::placeholder { color: var(--text-muted); }
.nl-success { font-size: 13px; color: #4ade80; margin-top: 14px; display: none; }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   FOOTER
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
footer {
  padding: 60px 7% 40px; border-top: 1px solid var(--border);
  position: relative; z-index: 1;
  display: grid; grid-template-columns: 1fr auto 1fr; align-items: center; gap: 32px;
}
.f-brand { display: flex; flex-direction: column; gap: 8px; }
.f-logo-text { font-family: 'Cormorant Garamond', serif; font-size: 22px; font-weight: 300; letter-spacing: .14em; color: var(--text); }
.f-sub { font-size: 12px; color: var(--text-muted); letter-spacing: .06em; }
.f-social { display: flex; flex-direction: column; align-items: center; gap: 14px; }
.f-social-label { font-size: 10px; letter-spacing: .18em; text-transform: uppercase; color: var(--text-muted); }
.f-dots { display: flex; gap: 10px; }
.fdot {
  width: 36px; height: 36px; border-radius: 50%; background: var(--bg2);
  border: 1.5px solid var(--border-strong); transition: box-shadow .3s, background .3s, transform .3s;
  cursor: pointer; display: flex; align-items: center; justify-content: center; font-size: 15px;
}
.fdot:hover { background: var(--primary); box-shadow: 0 0 16px var(--primary-glow); transform: translateY(-4px) scale(1.1); }
.f-copy { text-align: right; font-size: 11px; color: var(--text-muted); letter-spacing: .06em; line-height: 1.8; }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   LIVE CHAT WIDGET
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.chat-fab {
  position: fixed; bottom: 28px; right: 28px; z-index: 5000;
  width: 56px; height: 56px; border-radius: 50%;
  background: var(--primary); color: #fff;
  border: none; cursor: pointer; font-size: 22px;
  box-shadow: 0 8px 32px var(--primary-glow);
  transition: transform .3s cubic-bezier(.34,1.56,.64,1), box-shadow .3s;
  display: flex; align-items: center; justify-content: center;
}
.chat-fab:hover { transform: scale(1.12) translateY(-3px); box-shadow: 0 14px 44px rgba(var(--accent-rgb),.6); }
.chat-fab .chat-notif {
  position: absolute; top: -2px; right: -2px;
  width: 16px; height: 16px; border-radius: 50%;
  background: #ef4444; border: 2px solid var(--bg);
  font-size: 9px; font-weight: 600; display: none;
  align-items: center; justify-content: center; color: #fff;
}
.chat-fab .chat-notif.show { display: flex; animation: pulse-notif 2s infinite; }
@keyframes pulse-notif {
  0%,100% { transform: scale(1); }
  50% { transform: scale(1.2); }
}

.chat-window {
  position: fixed; bottom: 96px; right: 28px; z-index: 5000;
  width: 360px; height: 520px;
  background: var(--panel-bg); border: 1px solid var(--border-strong);
  border-radius: 24px; display: none; flex-direction: column;
  box-shadow: 0 24px 80px var(--shadow-lg);
  overflow: hidden;
  animation: chatIn .28s cubic-bezier(.34,1.2,.64,1);
}
.chat-window.open { display: flex; }
.chat-window.drag-over { border-color: var(--primary); box-shadow: 0 0 0 3px var(--primary-glow), 0 24px 80px var(--shadow-lg); }
.chat-drag-overlay {
  position: absolute; inset: 0; z-index: 10;
  background: rgba(var(--accent-rgb),.13);
  border-radius: 24px; border: 2px dashed var(--primary);
  display: none; align-items: center; justify-content: center;
  font-size: 28px; flex-direction: column; gap: 8px;
  pointer-events: none;
}
.chat-drag-overlay span { font-size: 13px; color: var(--primary); font-family: 'Jost', sans-serif; }
.chat-window.drag-over .chat-drag-overlay { display: flex; }
@keyframes chatIn { from { opacity:0; transform:translateY(20px) scale(.95); } to { opacity:1; transform:translateY(0) scale(1); } }

.chat-header {
  padding: 16px 18px; border-bottom: 1px solid var(--border);
  display: flex; align-items: center; gap: 12px;
  background: var(--card-bg); flex-shrink: 0;
}
.chat-avatar {
  width: 36px; height: 36px; border-radius: 50%;
  background: linear-gradient(135deg,var(--grad-c2),var(--grad-c3));
  display: flex; align-items: center; justify-content: center;
  font-size: 16px; flex-shrink: 0;
}
.chat-status-dot {
  width: 8px; height: 8px; border-radius: 50%; background: #4ade80;
  box-shadow: 0 0 8px rgba(74,222,128,.7); flex-shrink: 0;
}
.chat-header-info { flex: 1; }
.chat-header-name { font-size: 13px; font-weight: 500; color: var(--text); }
.chat-header-status { font-size: 11px; color: var(--text-muted); }
.chat-close {
  width: 28px; height: 28px; border-radius: 50%; background: var(--bg2);
  border: none; cursor: pointer; font-size: 14px; color: var(--text-muted);
  display: flex; align-items: center; justify-content: center;
  transition: background .2s; flex-shrink: 0;
}
.chat-close:hover { background: var(--primary); color: #fff; }

.chat-messages {
  flex: 1; overflow-y: auto; padding: 16px;
  display: flex; flex-direction: column; gap: 10px;
  scrollbar-width: thin; scrollbar-color: var(--border-strong) transparent;
}
.chat-messages::-webkit-scrollbar { width: 4px; }
.chat-messages::-webkit-scrollbar-thumb { background: var(--border-strong); border-radius: 2px; }

.chat-msg {
  display: flex; gap: 8px; align-items: flex-end;
  animation: msgIn .2s cubic-bezier(.34,1.2,.64,1);
}
@keyframes msgIn { from { opacity:0; transform:translateY(8px); } to { opacity:1; transform:translateY(0); } }
.chat-msg.mine { flex-direction: row-reverse; }
.chat-bubble {
  max-width: 76%; padding: 10px 14px; border-radius: 18px;
  font-size: 13px; line-height: 1.5; word-break: break-word;
}
.chat-msg:not(.mine) .chat-bubble { background: var(--card-bg); color: var(--text); border-radius: 4px 18px 18px 18px; }
.chat-msg.mine .chat-bubble { background: var(--primary); color: #fff; border-radius: 18px 4px 18px 18px; }
.chat-time { font-size: 10px; color: var(--text-muted); margin-bottom: 2px; flex-shrink: 0; }
.chat-msg-avatar { width: 24px; height: 24px; border-radius: 50%; background: var(--card-dark); border: 1px solid var(--border-strong); display: flex; align-items: center; justify-content: center; font-size: 11px; flex-shrink: 0; }
.chat-typing { display: flex; gap: 4px; align-items: center; padding: 10px 14px; background: var(--card-bg); border-radius: 4px 18px 18px 18px; width: fit-content; }
.typing-dot { width: 6px; height: 6px; border-radius: 50%; background: var(--text-muted); animation: typingBounce 1.2s infinite; }
.typing-dot:nth-child(2) { animation-delay: .2s; }
.typing-dot:nth-child(3) { animation-delay: .4s; }
@keyframes typingBounce { 0%,60%,100% { transform: translateY(0); } 30% { transform: translateY(-6px); } }
.chat-sys { text-align: center; font-size: 11px; color: var(--text-muted); padding: 4px 0; }
.chat-empty { text-align: center; padding: 32px 20px; color: var(--text-muted); font-size: 13px; line-height: 1.7; }

.chat-footer {
  padding: 12px 16px; border-top: 1px solid var(--border);
  display: flex; gap: 8px; align-items: center; flex-shrink: 0;
  background: var(--card-bg);
}
.chat-input {
  flex: 1; background: var(--input-bg); border: 1.5px solid var(--border-strong);
  border-radius: 20px; padding: 9px 14px;
  font-family: 'Jost', sans-serif; font-size: 13px; color: var(--text);
  outline: none; transition: border-color .2s; resize: none; max-height: 80px; overflow-y: auto;
}
.chat-input:focus { border-color: var(--primary); }
.chat-input::placeholder { color: var(--text-muted); }
.chat-send {
  width: 38px; height: 38px; border-radius: 50%; background: var(--primary);
  border: none; cursor: pointer; color: #fff; font-size: 16px;
  display: flex; align-items: center; justify-content: center;
  transition: transform .2s, box-shadow .2s; flex-shrink: 0;
}
.chat-send:hover { transform: scale(1.1); box-shadow: 0 4px 16px var(--primary-glow); }

/* Attach button */
.chat-attach {
  width: 34px; height: 34px; border-radius: 50%; background: var(--card-bg);
  border: 1.5px solid var(--border-strong); cursor: pointer; color: var(--text-muted);
  font-size: 16px; display: flex; align-items: center; justify-content: center;
  transition: border-color .2s, color .2s, background .2s; flex-shrink: 0;
}
.chat-attach:hover { border-color: var(--primary); color: var(--primary); background: rgba(var(--accent-rgb),.08); }

/* File attachment bubble */
.chat-file-bubble {
  max-width: 76%; border-radius: 14px; overflow: hidden;
  border: 1.5px solid rgba(var(--accent-rgb),.25); cursor: pointer;
  transition: border-color .2s;
}
.chat-file-bubble:hover { border-color: var(--primary); }
.chat-msg:not(.mine) .chat-file-bubble { background: var(--card-bg); }
.chat-msg.mine .chat-file-bubble { background: rgba(var(--accent-rgb),.15); border-color: rgba(var(--accent-rgb),.4); }

/* Image preview in bubble */
.chat-file-bubble img {
  display: block; max-width: 220px; max-height: 180px;
  width: 100%; object-fit: cover; border-radius: 12px 12px 0 0;
}
/* Video preview */
.chat-file-bubble video {
  display: block; max-width: 220px; max-height: 160px;
  width: 100%; border-radius: 12px 12px 0 0;
}
/* File info row */
.chat-file-info {
  display: flex; align-items: center; gap: 10px;
  padding: 9px 12px; font-size: 12px;
}
.chat-file-icon { font-size: 20px; flex-shrink: 0; }
.chat-file-name {
  flex: 1; font-weight: 500; white-space: nowrap;
  overflow: hidden; text-overflow: ellipsis; max-width: 140px;
  color: var(--text);
}
.chat-file-size { font-size: 10px; color: var(--text-muted); white-space: nowrap; }
.chat-file-dl {
  font-size: 11px; color: var(--primary); font-weight: 500;
  white-space: nowrap; text-decoration: none;
}
.chat-file-dl:hover { text-decoration: underline; }

/* Upload progress bar */
.chat-upload-bar {
  height: 3px; background: var(--border-strong); border-radius: 3px;
  overflow: hidden; margin: 0 12px 8px;
}
.chat-upload-bar-fill {
  height: 100%; background: var(--primary); border-radius: 3px;
  transition: width .2s; width: 0%;
}

/* â”€â”€ Admin chat overlay in Admin Panel â”€â”€ */
.adm-chat-tab-content { display: flex; flex-direction: column; height: calc(100vh - 180px); }
.adm-chat-list { width: 260px; flex-shrink: 0; border-right: 1px solid var(--border); overflow-y: auto; }
.adm-chat-item {
  padding: 14px 16px; border-bottom: 1px solid var(--border); cursor: pointer;
  transition: background .15s; display: flex; gap: 10px; align-items: center;
}
.adm-chat-item:hover, .adm-chat-item.active { background: var(--card-bg); }
.adm-chat-item-dot { width: 8px; height: 8px; border-radius: 50%; background: #4ade80; flex-shrink: 0; }
.adm-chat-item-dot.offline { background: var(--border-strong); }
.adm-chat-item-name { font-size: 13px; font-weight: 500; }
.adm-chat-item-preview { font-size: 11px; color: var(--text-muted); overflow: hidden; white-space: nowrap; text-overflow: ellipsis; }
.adm-chat-item-unread { min-width: 18px; height: 18px; border-radius: 9px; background: var(--primary); color: #fff; font-size: 10px; font-weight: 600; display: flex; align-items: center; justify-content: center; padding: 0 5px; }
.adm-chat-pane { flex: 1; display: flex; flex-direction: column; }
.adm-chat-messages { flex: 1; overflow-y: auto; padding: 16px; display: flex; flex-direction: column; gap: 10px; }
.adm-chat-footer { padding: 12px 16px; border-top: 1px solid var(--border); display: flex; gap: 8px; align-items: center; }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   FULLSCREEN AUTH
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.fs {
  position: fixed; inset: 0; background: var(--panel-bg);
  z-index: 3000; display: none; flex-direction: column; overflow-y: auto;
}
.fs.open { display: flex; animation: fsIn .28s ease; }
@keyframes fsIn { from { opacity:0; } to { opacity:1; } }
.fsh {
  display: flex; justify-content: space-between; align-items: center;
  padding: 20px 36px; border-bottom: 1px solid var(--border);
  position: sticky; top: 0; background: var(--panel-bg); z-index: 1;
}
.fsbrand { font-family: 'DM Serif Display', serif; font-size: 20px; font-weight: 400; letter-spacing: .04em; }
.fsclose {
  width: 34px; height: 34px; background: var(--card-bg);
  border: 1px solid var(--border-strong); border-radius: 50%;
  cursor: pointer; display: flex; align-items: center; justify-content: center;
  font-size: 18px; color: var(--text); transition: background .2s;
}
.fsclose:hover { background: var(--primary); color: #fff; border-color: var(--primary); }
.fsb { flex: 1; display: flex; align-items: flex-start; justify-content: center; padding: 48px 22px; }
.aw { width: 100%; max-width: 460px; display: flex; flex-direction: column; }
.atabs { display: flex; border-bottom: 1px solid var(--border); margin-bottom: 28px; gap: 4px; }
.atab {
  padding: 10px 24px;
  font-family: 'DM Serif Display', serif; font-size: 22px; font-weight: 400;
  cursor: pointer; color: var(--text-muted); border-bottom: 2px solid transparent;
  margin-bottom: -1px; transition: color .2s, border-color .2s;
  background: none; border-top: none; border-left: none; border-right: none;
}
.atab.active { color: var(--primary); border-bottom-color: var(--primary); }
.aform { display: flex; flex-direction: column; gap: 16px; }
.aform.h { display: none; }
.fg { display: flex; flex-direction: column; gap: 6px; }
.fl { font-size: 11px; letter-spacing: .1em; color: var(--text-muted); text-transform: uppercase; }
.fi2 {
  padding: 12px 16px; background: var(--input-bg);
  border: 1.5px solid var(--border-strong); border-radius: 12px;
  font-family: 'Jost', sans-serif; font-size: 13px; color: var(--text);
  outline: none; transition: border-color .2s, background .5s;
}
.fi2:focus { border-color: var(--primary); }
.tbox {
  background: var(--card-bg); border: 1.5px solid var(--border-strong);
  border-radius: 10px; padding: 14px; height: 88px; overflow-y: auto;
  font-size: 12px; color: var(--text-muted); line-height: 1.7; transition: background .5s;
}
.cbrow { display: flex; align-items: center; gap: 10px; cursor: pointer; }
.cbrow input { width: 16px; height: 16px; accent-color: var(--primary); cursor: pointer; flex-shrink: 0; }
.cbrow span { font-size: 13px; color: var(--text); }
mark.hl { background: var(--search-hl); color: inherit; border-radius: 3px; padding: 0 2px; }

/* â”€â”€ Password field wrapper â”€â”€ */
.pw-wrap {
  position: relative; display: flex; align-items: center;
}
.pw-wrap .fi2 { width: 100%; padding-right: 44px; }
.pw-eye {
  position: absolute; right: 14px; top: 50%; transform: translateY(-50%);
  background: none; border: none; cursor: pointer; color: var(--text-muted);
  font-size: 18px; line-height: 1; padding: 4px; transition: color .2s;
  display: flex; align-items: center; justify-content: center;
  width: 28px; height: 28px; border-radius: 50%;
}
.pw-eye:hover { color: var(--primary); background: rgba(var(--accent-rgb),.08); }
.pw-eye svg { width: 18px; height: 18px; }

/* â”€â”€ Age field group â”€â”€ */
.age-row { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }

/* DOB Sliders */
.dob-slider {
  -webkit-appearance: none;
  appearance: none;
  width: 100%;
  height: 4px;
  border-radius: 4px;
  background: var(--border-strong);
  outline: none;
  cursor: pointer;
  transition: background .2s;
}
.dob-slider::-webkit-slider-thumb {
  -webkit-appearance: none;
  appearance: none;
  width: 20px;
  height: 20px;
  border-radius: 50%;
  background: var(--primary);
  cursor: pointer;
  box-shadow: 0 0 0 3px var(--primary-glow);
  transition: box-shadow .2s, transform .15s;
}
.dob-slider::-webkit-slider-thumb:active {
  transform: scale(1.2);
  box-shadow: 0 0 0 6px var(--primary-glow);
}
.dob-slider::-moz-range-thumb {
  width: 20px;
  height: 20px;
  border-radius: 50%;
  background: var(--primary);
  cursor: pointer;
  border: none;
  box-shadow: 0 0 0 3px var(--primary-glow);
}
.dob-slider:focus::-webkit-slider-thumb {
  box-shadow: 0 0 0 5px var(--primary-glow);
}

/* â”€â”€ Auth strength indicator â”€â”€ */
.strength-dots {
  display: flex; gap: 4px; margin-top: 8px;
}
.strength-dot {
  flex: 1; height: 3px; border-radius: 3px;
  background: var(--border-strong); transition: background .3s;
}

/* â”€â”€ Auth panel glow header â”€â”€ */
.auth-glow-header {
  text-align: center; margin-bottom: 28px; padding-bottom: 24px;
  border-bottom: 1px solid var(--border);
}
.auth-glow-icon {
  width: 64px; height: 64px; border-radius: 50%;
  background: linear-gradient(135deg, var(--grad-c2), var(--grad-c3));
  margin: 0 auto 14px;
  display: flex; align-items: center; justify-content: center;
  font-size: 26px;
  box-shadow: 0 8px 32px var(--primary-glow);
  animation: iconPulse 3s ease-in-out infinite;
}
@keyframes iconPulse {
  0%, 100% { box-shadow: 0 8px 32px var(--primary-glow); }
  50% { box-shadow: 0 8px 48px var(--primary-glow), 0 0 0 8px rgba(var(--accent-rgb),.1); }
}
.auth-glow-title {
  font-family: 'DM Serif Display', serif;
  font-size: 24px; font-weight: 400; color: var(--text); margin-bottom: 4px;
}
.auth-glow-sub { font-size: 12px; color: var(--text-muted); letter-spacing: .04em; }

/* â”€â”€ Chat auth gate â”€â”€ */
.chat-auth-gate {
  flex: 1; display: flex; flex-direction: column; align-items: center;
  justify-content: center; padding: 24px; gap: 16px; text-align: center;
}
.chat-auth-icon {
  width: 64px; height: 64px; border-radius: 50%;
  background: linear-gradient(135deg,var(--grad-c2),var(--grad-c3));
  display: flex; align-items: center; justify-content: center;
  font-size: 26px;
  box-shadow: 0 6px 24px var(--primary-glow);
  margin-bottom: 6px;
}
.chat-auth-title { font-family: 'DM Serif Display', serif; font-size: 18px; color: var(--text); }
.chat-auth-sub { font-size: 12px; color: var(--text-muted); line-height: 1.7; max-width: 220px; }
.chat-auth-btns { display: flex; flex-direction: column; gap: 8px; width: 100%; }
.chat-auth-btns .btn-p { padding: 11px 20px; font-size: 13px; border-radius: 16px; }
.chat-auth-btns .btn-o { padding: 10px 20px; font-size: 12px; border-radius: 16px; }

/* â”€â”€ Profile picture upload in auth â”€â”€ */
.avatar-upload-ring {
  width: 72px; height: 72px; border-radius: 50%;
  border: 2px dashed var(--border-strong); cursor: pointer;
  display: flex; flex-direction: column; align-items: center; justify-content: center;
  gap: 4px; margin: 0 auto; transition: border-color .2s, background .2s;
  background: var(--card-bg); position: relative; overflow: hidden;
}
.avatar-upload-ring:hover { border-color: var(--primary); background: rgba(var(--accent-rgb),.06); }
.avatar-upload-ring img { width: 100%; height: 100%; object-fit: cover; position: absolute; inset: 0; border-radius: 50%; }
.avatar-upload-ring span { font-size: 22px; }
.avatar-upload-ring small { font-size: 9px; color: var(--text-muted); letter-spacing: .06em; }

/* â”€â”€ Country/DOB row â”€â”€ */
.fi2-select {
  padding: 12px 16px; background: var(--input-bg);
  border: 1.5px solid var(--border-strong); border-radius: 12px;
  font-family: 'Jost', sans-serif; font-size: 13px; color: var(--text);
  outline: none; transition: border-color .2s; cursor: pointer; width: 100%;
  -webkit-appearance: none;
}
.fi2-select:focus { border-color: var(--primary); }
.fi2-select option { background: var(--panel-bg); }

/* â”€â”€ Progress steps for signup â”€â”€ */
.signup-steps {
  display: flex; align-items: center; gap: 0; margin-bottom: 28px;
}
.signup-step-item {
  display: flex; align-items: center; flex: 1;
}
.signup-step-circle {
  width: 28px; height: 28px; border-radius: 50%;
  border: 2px solid var(--border-strong);
  display: flex; align-items: center; justify-content: center;
  font-size: 11px; font-weight: 600; color: var(--text-muted);
  transition: all .3s; flex-shrink: 0; background: var(--card-bg);
}
.signup-step-circle.active {
  border-color: var(--primary); color: var(--primary);
  background: rgba(var(--accent-rgb),.12);
  box-shadow: 0 0 12px rgba(var(--accent-rgb),.3);
}
.signup-step-circle.done {
  border-color: #4ade80; color: #fff; background: #4ade80;
}
.signup-step-line {
  flex: 1; height: 2px; background: var(--border-strong);
  transition: background .5s;
}
.signup-step-line.done { background: #4ade80; }
.signup-step-label {
  font-size: 9px; color: var(--text-muted); letter-spacing: .08em;
  text-transform: uppercase; margin-top: 4px; text-align: center;
}

/* â”€â”€ Mode panel themes grid â”€â”€ */
.accent-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; margin-top: 8px; }



/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   SCROLL REVEAL
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.reveal {
  opacity: 0; transform: translateY(32px);
  transition: opacity .75s ease, transform .75s cubic-bezier(.34,1.1,.64,1);
}
.reveal.visible { opacity: 1; transform: translateY(0); }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   ANNOUNCEMENT BANNER
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.adm-announce {
  padding: 14px 18px; border-radius: 12px; margin: 10px 7%;
  background: rgba(var(--accent-rgb),.1); border: 1px solid rgba(var(--accent-rgb),.3);
  font-size: 13px; color: var(--text); display: none; position: relative; z-index: 2;
}
.adm-announce.show { display: block; }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   RESPONSIVE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
@media(max-width:900px){
  #home { grid-template-columns:1fr; padding:60px 5% 50px; gap:32px; min-height:auto; }
  .hero-img-card { aspect-ratio:16/9; max-height:260px; }
  .cards-row { flex-direction:column; }
  .acard { flex:none !important; width:100%; }
  footer { grid-template-columns:1fr; gap:28px; }
  .f-copy { text-align:left; }
  .stats-row { gap:20px; }
  .newsletter-card { padding:36px 24px; }
  .newsletter-form { flex-direction:column; }
  .chat-window { width:calc(100vw - 40px); right:20px; }
  .marquee-item { padding: 0 20px; font-size:12px; }
}
@media(max-width:600px){
  .logo-text { display:none; }
  .search-bar input { width:80px; }
  .hero-title { font-size:32px; }
  .mode-panel { width: calc(100vw - 40px); right: 20px; }
}

/* â”€â”€ Large Desktop PC improvements â”€â”€ */
@media(min-width:1280px){
  #home { padding: 80px 10%; grid-template-columns: 1fr 1.1fr; gap: 64px; }
  .hero-img-card { max-height: 600px; }
  #about, #works, #newsletter { padding: 100px 10%; }
  .stats-row { padding: 0 10%; }
  header { padding: 0 40px; }
  .search-bar input { width: 160px; }
  .chat-window { width: 400px; height: 560px; }
  .acard-title { font-size: 24px; }
  .acard:not(.active) .acard-title { font-size:18px; }
}
@media(min-width:1600px){
  #home { padding: 80px 14%; }
  #about, #works, #newsletter { padding: 100px 14%; }
  .stats-row { padding: 0 14%; }
  header { padding: 0 56px; }
}

/* â”€â”€ 3D TILT â”€â”€ */
.loggedin-card {
  background: var(--card-bg); border: 1.5px solid var(--border-strong);
  border-radius: 20px; padding: 20px; position: relative; overflow: hidden;
}
.loggedin-card::before {
  content: ''; position: absolute; inset: -1px; border-radius: inherit;
  background: conic-gradient(from var(--grad-angle),var(--grad-c1),var(--grad-c2),var(--grad-c3),var(--grad-c1));
  animation: spin-grad 6s linear infinite; z-index: 0; opacity: .6;
}
.loggedin-card::after {
  content: ''; position: absolute; inset: 2px; border-radius: 18px;
  background: var(--card-bg); z-index: 0;
}
.loggedin-card > * { position: relative; z-index: 1; }

/* â”€â”€ Toast notification â”€â”€ */
.gba-toast {
  position: fixed; bottom: 90px; left: 50%; transform: translateX(-50%) translateY(20px);
  background: var(--panel-bg); border: 1px solid var(--border-strong);
  border-radius: 16px; padding: 14px 22px; z-index: 99999;
  display: flex; align-items: center; gap: 10px;
  box-shadow: 0 16px 48px rgba(0,0,0,.5);
  font-size: 13px; color: var(--text); white-space: nowrap;
  opacity: 0; pointer-events: none;
  transition: opacity .3s, transform .3s cubic-bezier(.34,1.2,.64,1);
}
.gba-toast.show { opacity: 1; transform: translateX(-50%) translateY(0); pointer-events: auto; }
.gba-toast-icon { font-size: 18px; }



/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   RTL SUPPORT
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
[dir="rtl"] .hero-left { align-items:flex-end; }
[dir="rtl"] .hero-right { align-items:flex-end; }
[dir="rtl"] .hero-actions { flex-direction:row-reverse; }
[dir="rtl"] .hero-eyebrow, [dir="rtl"] .hero-title, [dir="rtl"] .hero-sub { text-align:right; }
[dir="rtl"] .sec-eyebrow, [dir="rtl"] .sec-title { text-align:right; }
[dir="rtl"] .cards-row { direction:rtl; }
[dir="rtl"] footer { direction:rtl; }
[dir="rtl"] .f-copy { text-align:left; }
[dir="rtl"] .dd { right:auto; left:20px; }
[dir="rtl"] .mode-panel { right:auto; left:20px; }
[dir="rtl"] *:not(input):not(textarea):not(.phone-tag) { letter-spacing:0 !important; }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   ADMIN PANEL
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#admin-panel {
  position:fixed; inset:0; z-index:99999;
  background:var(--bg); display:none; flex-direction:column;
  animation:adminIn .3s cubic-bezier(.34,1.1,.64,1); overflow:hidden;
}
#admin-panel.open { display:flex; }
@keyframes adminIn { from{opacity:0;transform:translateY(30px);}to{opacity:1;transform:translateY(0);} }
.adm-header { height:60px;display:flex;align-items:center;padding:0 28px;gap:16px; background:var(--header-bg);border-bottom:1px solid var(--border-strong); backdrop-filter:blur(20px);flex-shrink:0; }
.adm-title { font-family:'DM Serif Display',serif;font-size:18px;font-weight:400; color:var(--text);display:flex;align-items:center;gap:10px; }
.adm-badge { font-size:10px;font-family:'Jost',sans-serif;letter-spacing:.12em; text-transform:uppercase;background:var(--primary);color:#fff; padding:3px 9px;border-radius:20px;font-weight:500; }
.adm-badge.co { background:#7c4dff; }
.adm-close { margin-left:auto;width:34px;height:34px;border-radius:10px; border:1.5px solid var(--border-strong);background:var(--card-bg); cursor:pointer;font-size:18px;color:var(--text); display:flex;align-items:center;justify-content:center; transition:background .2s; }
.adm-close:hover { background:var(--card-hover); }
.adm-tabs { display:flex;gap:4px;padding:16px 28px 0;flex-shrink:0; border-bottom:1px solid var(--border); overflow-x:auto; scrollbar-width:none; }
.adm-tabs::-webkit-scrollbar { display:none; }
.adm-tab { padding:9px 20px;border-radius:10px 10px 0 0;font-family:'Jost',sans-serif; font-size:12px;letter-spacing:.07em;cursor:pointer; border:1px solid transparent;border-bottom:none; background:none;color:var(--text-muted);transition:all .2s; white-space:nowrap; }
.adm-tab.active { background:var(--card-bg);color:var(--primary);border-color:var(--border-strong); }
.adm-tab:hover:not(.active) { color:var(--text); }
.adm-body { flex:1;overflow-y:auto;padding:24px 28px; }
.adm-section { display:none; }
.adm-section.active { display:block; }
.adm-stats { display:grid;grid-template-columns:repeat(auto-fit,minmax(150px,1fr)); gap:14px;margin-bottom:28px; }
.adm-stat { background:var(--card-bg);border:1px solid var(--border-strong); border-radius:16px;padding:18px 20px; }
.adm-stat-num { font-family:'DM Serif Display',serif;font-size:32px; color:var(--primary);line-height:1;margin-bottom:4px; }
.adm-stat-lbl { font-size:11px;letter-spacing:.1em;text-transform:uppercase; color:var(--text-muted); }
.adm-toolbar { display:flex;gap:10px;align-items:center;margin-bottom:18px;flex-wrap:wrap; }
.adm-search { background:var(--input-bg);border:1.5px solid var(--border-strong); border-radius:10px;padding:9px 14px;font-family:'Jost',sans-serif; font-size:12px;color:var(--text);outline:none;transition:border-color .2s; flex:1;min-width:160px; }
.adm-search:focus { border-color:var(--primary); }
.adm-filter { background:var(--input-bg);border:1.5px solid var(--border-strong); border-radius:10px;padding:9px 14px;font-family:'Jost',sans-serif; font-size:12px;color:var(--text);cursor:pointer;outline:none; }
.adm-table-wrap { overflow-x:auto; }
.adm-table { width:100%;border-collapse:collapse;font-size:12px; }
.adm-table th { text-align:left;padding:10px 14px;font-family:'Jost',sans-serif; font-weight:500;letter-spacing:.06em;font-size:11px;text-transform:uppercase; color:var(--text-muted);border-bottom:1px solid var(--border-strong); white-space:nowrap; }
.adm-table td { padding:12px 14px;border-bottom:1px solid var(--border); vertical-align:middle; }
.adm-table tr:last-child td { border-bottom:none; }
.adm-table tr:hover td { background:var(--card-bg); }
.adm-pill { display:inline-flex;align-items:center;padding:3px 10px; border-radius:20px;font-size:10px;font-weight:500;letter-spacing:.08em; }
.adm-pill.admin { background:rgba(var(--accent-rgb),.15);color:var(--primary); }
.adm-pill.co-adm { background:rgba(124,77,255,.15);color:#7c4dff; }
.adm-pill.vip { background:rgba(251,191,36,.15);color:#fbbf24; }
.adm-pill.active { background:rgba(74,222,128,.15);color:#4ade80; }
.adm-pill.banned { background:rgba(239,68,68,.15);color:#ef4444; }
.adm-pill.offline { background:var(--border);color:var(--text-muted); }
.adm-btn { display:inline-flex;align-items:center;gap:6px; padding:7px 14px;border-radius:8px;font-family:'Jost',sans-serif; font-size:12px;letter-spacing:.06em;cursor:pointer;border:none; transition:all .2s;white-space:nowrap; }
.adm-btn.danger { background:rgba(239,68,68,.15);color:#ef4444;border:1px solid rgba(239,68,68,.25); }
.adm-btn.danger:hover { background:#ef4444;color:#fff; }
.adm-btn.warn { background:rgba(251,146,60,.12);color:#fb923c;border:1px solid rgba(251,146,60,.25); }
.adm-btn.warn:hover { background:#fb923c;color:#fff; }
.adm-btn.info { background:rgba(var(--accent-rgb),.12);color:var(--primary);border:1px solid rgba(var(--accent-rgb),.25); }
.adm-btn.info:hover { background:var(--primary);color:#fff; }
.adm-btn.neutral { background:var(--card-bg);color:var(--text);border:1px solid var(--border-strong); }
.adm-btn.neutral:hover { background:var(--card-hover); }
.adm-log-entry { padding:12px 16px;border-radius:12px;background:var(--card-bg); border:1px solid var(--border);margin-bottom:8px;font-size:12px; }
.adm-log-type { display:inline-flex;align-items:center;padding:2px 8px;border-radius:6px; font-size:10px;font-weight:500;letter-spacing:.08em;text-transform:uppercase; margin-bottom:4px; }
.adm-modal-bg { position:fixed;inset:0;z-index:100000; background:rgba(0,0,0,.6);backdrop-filter:blur(6px); display:none;align-items:center;justify-content:center;padding:20px; }
.adm-modal-bg.open { display:flex; }
.adm-modal { background:var(--panel-bg);border:1px solid var(--border-strong); border-radius:20px;padding:28px;max-width:380px;width:100%; box-shadow:0 24px 80px var(--shadow-lg); animation:ddIn .22s cubic-bezier(.34,1.2,.64,1); }
.adm-modal h3 { font-family:'DM Serif Display',serif;font-size:20px;margin-bottom:10px; }
.adm-modal p { font-size:13px;color:var(--text-muted);line-height:1.7;margin-bottom:20px; }
.adm-modal-btns { display:flex;gap:10px;justify-content:flex-end; }
.adm-empty { text-align:center;padding:48px 20px;color:var(--text-muted);font-size:13px; }
.adm-empty-icon { font-size:36px;margin-bottom:12px;opacity:.5; }

/* Admin chat layout */
.adm-chat-layout { display:flex;height:calc(100vh - 240px);gap:0; border:1px solid var(--border-strong);border-radius:16px;overflow:hidden; }
.adm-chat-sidebar { width:240px;flex-shrink:0;border-right:1px solid var(--border);overflow-y:auto; }
.adm-chat-main { flex:1;display:flex;flex-direction:column; }
.adm-chat-header-pane { padding:12px 16px;border-bottom:1px solid var(--border);background:var(--card-bg); display:flex;align-items:center;gap:10px;flex-shrink:0; }
.adm-chat-msgs { flex:1;overflow-y:auto;padding:16px;display:flex;flex-direction:column;gap:10px; }
.adm-chat-input-row { padding:12px 16px;border-top:1px solid var(--border);display:flex;gap:8px;align-items:center;flex-shrink:0; }
.adm-chat-empty { flex:1;display:flex;align-items:center;justify-content:center;color:var(--text-muted);font-size:13px; }
</style>
</head>
<body>
<canvas id="bg-canvas"></canvas>
<div id="cursor-blob"></div>
<canvas id="cursor-trail-canvas"></canvas>

<!-- Scroll Progress Bar -->
<div id="scroll-progress"></div>

<!-- â•â•â• HEADER â•â•â• -->
<header id="site-header">
  <div class="logo-area" onclick="goTo('home')">
    <div class="logo-svg-wrap">
      <!-- GBA Logo SVG â€” faithful recreation, theme-adaptive -->
      <svg viewBox="0 0 80 80" xmlns="http://www.w3.org/2000/svg" id="gba-logo-svg">
        <!-- Outer circle (double ring) -->
        <circle cx="40" cy="40" r="36" fill="none" stroke="var(--logo-fill)" stroke-width=".8" opacity=".5"/>
        <circle cx="40" cy="40" r="33" fill="none" stroke="var(--logo-fill)" stroke-width=".8" opacity=".3"/>
        <!-- Top arc gap decorators -->
        <line x1="22" y1="9.5" x2="18" y2="10.5" stroke="var(--logo-fill)" stroke-width="1" stroke-linecap="round" opacity=".7"/>
        <line x1="58" y1="9.5" x2="62" y2="10.5" stroke="var(--logo-fill)" stroke-width="1" stroke-linecap="round" opacity=".7"/>
        <!-- "GRAPHIC" arced top text (simulated with individual letters) -->
        <text font-family="Cormorant Garamond,serif" font-size="8.5" letter-spacing="3.5" fill="var(--logo-fill)" opacity=".85" text-anchor="middle">
          <textPath href="#topArc" startOffset="50%">GRAPHIC</textPath>
        </text>
        <!-- "AMER" arced bottom text -->
        <text font-family="Cormorant Garamond,serif" font-size="8.5" letter-spacing="5" fill="var(--logo-fill)" opacity=".85" text-anchor="middle">
          <textPath href="#bottomArc" startOffset="50%">AMER</textPath>
        </text>
        <!-- Define arc paths -->
        <defs>
          <path id="topArc" d="M 12,40 A 28,28 0 0,1 68,40"/>
          <path id="bottomArc" d="M 14,46 A 28,28 0 0,0 66,46"/>
        </defs>
        <!-- Brushstroke background (sage/accent green) -->
        <ellipse cx="40" cy="40" rx="24" ry="11" fill="var(--logo-brush)" transform="rotate(-8,40,40)"/>
        <!-- GBA large serif letters -->
        <text x="37" y="45" text-anchor="middle" font-family="Cormorant Garamond,serif" font-size="26" font-weight="600" fill="var(--logo-fill)" opacity=".95">GBA</text>
        <!-- "by" small italic -->
        <text x="58" y="43" text-anchor="middle" font-family="Cormorant Garamond,serif" font-size="7" font-style="italic" fill="var(--logo-fill)" opacity=".75">by</text>
      </svg>
    </div>
    <span class="logo-text">Graphics By Amer</span>
  </div>

  <nav id="main-nav">
    <button class="nav-link active" id="nl-home" onclick="goTo('home',this)" data-en="Home" data-ar="Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©">Home</button>
    <button class="nav-link" id="nl-about" onclick="goTo('about',this)" data-en="About" data-ar="Ø¹Ù† GBA">About</button>
    <button class="nav-link" id="nl-works" onclick="goTo('works',this)" data-en="Works" data-ar="Ø§Ù„Ø£Ø¹Ù…Ø§Ù„">Works</button>
    <div class="nav-indicator" id="nav-indicator"></div>
  </nav>

  <div class="header-right">
    <div class="search-bar">
      <span class="s-icon">âŒ•</span>
      <input type="text" id="gsearch" placeholder="Searchâ€¦" oninput="handleSearch(this.value)">
    </div>
    <button class="btn-signup" id="auth-hero-btn" onclick="authBtnClick()">Sign Up</button>
    <div class="mode-btn" onclick="toggleModePanel(event)" id="mode-btn-trigger">
      <span class="mode-icon" id="mode-icon">ğŸŒ™</span>
      <span class="mode-label" data-en="Theme" data-ar="Ø§Ù„Ø«ÙŠÙ…">Theme</span>
    </div>
    <div class="hamburger" id="hbg" onclick="toggleDD(event)">
      <span></span><span></span><span></span>
    </div>
  </div>
</header>

<!-- Dropdown -->
<div class="dd" id="dd">
  <button class="dd-item" onclick="goTo('home');closeDD()" data-en="âŒ‚ Home" data-ar="âŒ‚ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©">âŒ‚ Home</button>
  <button class="dd-item" onclick="goTo('about');closeDD()" data-en="â—‰ About" data-ar="â—‰ Ø¹Ù† GBA">â—‰ About</button>
  <button class="dd-item" onclick="goTo('works');closeDD()" data-en="âœ¦ Previous Works" data-ar="âœ¦ Ø£Ø¹Ù…Ø§Ù„ Ø³Ø§Ø¨Ù‚Ø©">âœ¦ Previous Works</button>
  <button class="dd-item" onclick="authBtnClick();closeDD()" data-en="ğŸ‘¤ Account" data-ar="ğŸ‘¤ Ø§Ù„Ø­Ø³Ø§Ø¨">ğŸ‘¤ Account</button>
  <button class="dd-item" id="lang-btn" onclick="toggleLang();closeDD()">ğŸŒ Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</button>
  <button class="dd-item" id="dd-admin" onclick="openAdminPanel();closeDD();" style="display:none;color:var(--primary);" data-en="ğŸ›¡ï¸ Administration" data-ar="ğŸ›¡ï¸ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©">ğŸ›¡ï¸ Administration</button>
  <button class="dd-item" id="dd-logout" onclick="doLogout();closeDD();" style="display:none;color:#ef4444;" data-en="ğŸšª Log Out" data-ar="ğŸšª ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬">ğŸšª Log Out</button>
</div>

<!-- Mode Panel -->
<div class="mode-panel" id="mode-panel">
  <div>
    <div class="mode-panel-title">Base Mode</div>
    <div class="mode-row" style="margin-top:8px;">
      <button class="mode-pill active" id="pill-dark" onclick="setBaseMode('dark')">ğŸŒ™ Dark</button>
      <button class="mode-pill" id="pill-light" onclick="setBaseMode('light')">â˜€ï¸ Light</button>
    </div>
  </div>
  <div>
    <div class="mode-panel-title">Accent Color</div>
    <div style="display:grid;grid-template-columns:repeat(4,1fr);gap:8px;margin-top:8px;">
      <button class="accent-pill accent-cherry active" id="acc-cherry" onclick="setAccent('cherry')">
        <div class="accent-dot"></div><span>Cherry</span>
      </button>
      <button class="accent-pill accent-mango" id="acc-mango" onclick="setAccent('mango')">
        <div class="accent-dot"></div><span>Mango</span>
      </button>
      <button class="accent-pill accent-cocktail" id="acc-cocktail" onclick="setAccent('cocktail')">
        <div class="accent-dot"></div><span>Cocktail</span>
      </button>
      <button class="accent-pill accent-void" id="acc-void" onclick="setAccent('void')">
        <div class="accent-dot"></div><span>Void</span>
      </button>
      <button class="accent-pill accent-arctic" id="acc-arctic" onclick="setAccent('arctic')">
        <div class="accent-dot"></div><span>Arctic</span>
      </button>
      <button class="accent-pill accent-ember" id="acc-ember" onclick="setAccent('ember')">
        <div class="accent-dot"></div><span>Ember</span>
      </button>
      <button class="accent-pill accent-forest" id="acc-forest" onclick="setAccent('forest')">
        <div class="accent-dot"></div><span>Forest</span>
      </button>
      <button class="accent-pill accent-rosegold" id="acc-rosegold" onclick="setAccent('rosegold')">
        <div class="accent-dot"></div><span>Rose Gold</span>
      </button>
    </div>
  </div>
</div>

<main>

<!-- â•â•â• HERO â•â•â• -->
<section id="home">
  <div class="hero-left" id="hero-left">
    <div class="hero-img-card">
      <div class="hero-img-inner" style="padding:0;background:none;align-items:center;justify-content:center;">

        <!-- Canvas particle field -->
        <canvas id="hero-canvas" style="position:absolute;inset:0;width:100%;height:100%;border-radius:inherit;z-index:1;"></canvas>

        <!-- Grid overlay -->
        <div class="hero-art-grid" style="z-index:2;"></div>

        <!-- Scan line -->
        <div class="hero-art-scan" style="z-index:3;"></div>

        <!-- Rings -->
        <div class="hero-art-ring hero-art-ring-3" style="z-index:3;"><div class="hero-art-orb-dot"></div></div>
        <div class="hero-art-ring hero-art-ring-2" style="z-index:3;"><div class="hero-art-orb-dot"></div></div>
        <div class="hero-art-ring hero-art-ring-1" style="z-index:3;"><div class="hero-art-orb-dot"></div></div>

        <!-- Center glow orb -->
        <div class="hero-art-orb" style="z-index:4;"></div>

        <!-- Center monogram -->
        <div class="hero-art-monogram" style="z-index:5;">
          <div class="hero-art-letters">GBA</div>
          <div class="hero-art-tagline">Graphics By Amer</div>
        </div>

        <!-- Floating chips -->
        <div class="hero-art-chip hero-art-chip-1" style="z-index:5;">UI / UX</div>
        <div class="hero-art-chip hero-art-chip-2" style="z-index:5;">Branding</div>
        <div class="hero-art-chip hero-art-chip-3" style="z-index:5;">Web Dev</div>

        <!-- Diamonds -->
        <div class="hero-art-diamond hero-art-diamond-1" style="z-index:5;"></div>
        <div class="hero-art-diamond hero-art-diamond-2" style="z-index:5;"></div>

        <!-- Corner crosses -->
        <div class="hero-art-cross hero-art-cross-tl" style="z-index:5;"></div>
        <div class="hero-art-cross hero-art-cross-tr" style="z-index:5;"></div>
        <div class="hero-art-cross hero-art-cross-br" style="z-index:5;"></div>

        <!-- Phone tag -->
        <div class="phone-tag" id="live-phone-tag" style="position:absolute;bottom:24px;left:24px;z-index:6;">01515929659</div>

      </div>
    </div>
  </div>

  <div class="hero-right" id="hero-right">
    <div class="hero-badge">
      <div class="badge-dot"></div>
      <span class="badge-text" id="live-badge" data-en="Available for new projects" data-ar="Ù…ØªØ§Ø­ Ù„Ù„Ù…Ø´Ø§Ø±ÙŠØ¹ Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©">Available for new projects</span>
    </div>
    <div>
      <span class="hero-eyebrow" id="live-eyebrow" data-en="Graphics By Amer â€” GBA" data-ar="Ø¬Ø±Ø§ÙÙŠÙƒØ³ Ø¨Ø§ÙŠ Ø¹Ø§Ù…Ø± â€” GBA">Graphics By Amer â€” GBA</span>
      <h1 class="hero-title" id="hero-title-el">
        <span id="live-h1" data-en="Websites that" data-ar="Ù…ÙˆØ§Ù‚Ø¹ ØªØ¨Ø¯Ùˆ">Websites that</span><br>
        <span data-en="feel" data-ar="ÙˆÙƒØ£Ù†Ù‡Ø§ ØªØ³Ø§ÙˆÙŠ"> feel </span><em id="live-hem" class="kinetic-word" data-en="trillion" data-ar="Ù…Ù„ÙŠØ§Ø±">trillion</em><br>
        <span id="live-h3" data-en="dollar." data-ar="Ø¯ÙˆÙ„Ø§Ø±.">dollar.</span>
      </h1>
    </div>
    <p class="hero-sub" id="live-sub" data-en="Premium, fully functional websites built by a passionate developer â€” at a price that actually makes sense. Quality you'd expect from a studio. A budget you'd expect from a student." data-ar="Ù…ÙˆØ§Ù‚Ø¹ Ù…ØªÙƒØ§Ù…Ù„Ø© ÙˆØ¹Ø§Ù„ÙŠØ© Ø§Ù„Ø¬ÙˆØ¯Ø© Ù…ØµÙ…Ù…Ø© Ø¨Ø´ØºÙ â€” Ø¨Ø³Ø¹Ø± Ù…Ù†Ø·Ù‚ÙŠ Ø­Ù‚Ù‹Ø§. Ø¬ÙˆØ¯Ø© ØªØªÙˆÙ‚Ø¹Ù‡Ø§ Ù…Ù† Ø§Ø³ØªÙˆØ¯ÙŠÙˆØŒ ÙˆÙ…ÙŠØ²Ø§Ù†ÙŠØ© ØªØªÙˆÙ‚Ø¹Ù‡Ø§ Ù…Ù† Ø·Ø§Ù„Ø¨.">Premium, fully functional websites built by a passionate developer â€” at a price that actually makes sense. Quality you'd expect from a studio. A budget you'd expect from a student.</p>
    <div class="hero-actions">
      <button class="btn-p" id="live-cta1" onclick="goTo('works')" data-en="View Work â†’" data-ar="â† Ø§Ø³ØªØ¹Ø±Ø¶ Ø§Ù„Ø£Ø¹Ù…Ø§Ù„">View Work â†’</button>
      <button class="btn-o" onclick="authBtnClick()" data-en="Get Started" data-ar="Ø§Ø¨Ø¯Ø£ Ø§Ù„Ø¢Ù†">Get Started</button>
    </div>
  </div>
</section>

<!-- Stats Row -->
<div class="marquee-strip" aria-hidden="true">
  <div class="marquee-track" id="marquee-track">
    <div class="marquee-item"><div class="marquee-dot"></div>Web Design</div>
    <div class="marquee-item"><div class="marquee-dot"></div>Brand Identity</div>
    <div class="marquee-item"><div class="marquee-dot"></div>UI / UX</div>
    <div class="marquee-item"><div class="marquee-dot"></div>Motion Design</div>
    <div class="marquee-item"><div class="marquee-dot"></div>Client Portals</div>
    <div class="marquee-item"><div class="marquee-dot"></div>E-Commerce</div>
    <div class="marquee-item"><div class="marquee-dot"></div>Landing Pages</div>
    <div class="marquee-item"><div class="marquee-dot"></div>Graphic Design</div>
    <div class="marquee-item"><div class="marquee-dot"></div>Web Design</div>
    <div class="marquee-item"><div class="marquee-dot"></div>Brand Identity</div>
    <div class="marquee-item"><div class="marquee-dot"></div>UI / UX</div>
    <div class="marquee-item"><div class="marquee-dot"></div>Motion Design</div>
    <div class="marquee-item"><div class="marquee-dot"></div>Client Portals</div>
    <div class="marquee-item"><div class="marquee-dot"></div>E-Commerce</div>
    <div class="marquee-item"><div class="marquee-dot"></div>Landing Pages</div>
    <div class="marquee-item"><div class="marquee-dot"></div>Graphic Design</div>
  </div>
</div>

<div class="stats-row reveal" id="stats-row">
  <div class="stat-item">
    <span class="stat-num" data-target="48" id="stat-projects">0</span>
    <span class="stat-label" data-en="Projects Done" data-ar="Ù…Ø´Ø±ÙˆØ¹ Ù…Ù†Ø¬Ø²">Projects Done</span>
  </div>
  <div class="stat-item">
    <span class="stat-num" data-target="120" id="stat-clients">0</span>
    <span class="stat-label" data-en="Happy Clients" data-ar="Ø¹Ù…ÙŠÙ„ Ø³Ø¹ÙŠØ¯">Happy Clients</span>
  </div>
  <div class="stat-item">
    <span class="stat-num" data-target="3" id="stat-years">0</span>
    <span class="stat-label" data-en="Years Experience" data-ar="Ø³Ù†ÙˆØ§Øª Ø®Ø¨Ø±Ø©">Years Experience</span>
  </div>
</div>

<div class="sep"></div>

<!-- â•â•â• ABOUT / CARDS â•â•â• -->
<section id="about" class="reveal">
  <span class="sec-eyebrow" data-en="The Story Behind the Studio" data-ar="Ù‚ØµØ© Ø§Ù„Ø§Ø³ØªÙˆØ¯ÙŠÙˆ">The Story Behind the Studio</span>
  <div class="sec-title" data-en="Built From Ambition." data-ar="Ø¨ÙÙ†ÙŠ Ù…Ù† Ø§Ù„Ø·Ù…ÙˆØ­.">Built From Ambition.</div>

  <div class="cards-row">
    <div class="acard active" id="ac1" onclick="activateCard('ac1')">
      <div class="acard-img" style="background:linear-gradient(135deg,var(--grad-c1),var(--grad-c2));display:flex;align-items:center;justify-content:center;font-size:28px;">âœ¦</div>
      <span class="acard-tag" id="live-c1tag" data-en="01 â€” Origin" data-ar="Ù Ù¡ â€” Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©">01 â€” Origin</span>
      <div class="acard-title" id="live-c1title" data-en="The Beginning" data-ar="Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©">The Beginning</div>
      <div class="acard-preview">
        <p class="acard-text" id="live-c1body"
          data-en="GBA didn't start in a boardroom or a funded startup. It started with a hunger â€” for growth, for craft, and for something real. Trained directly under a professional graphic designer, Amer absorbed the discipline, the eye for detail, and the uncompromising standards that define exceptional visual work. What began as an education became a calling. When ambition met necessity, GBA was born â€” a one-person studio that operates with the precision of an agency and the soul of an artist. Every project is personal. Every build is deliberate. Nothing ships unless it's exceptional."
          data-ar="Ù„Ù… ØªØ¨Ø¯Ø£ GBA ÙÙŠ Ù‚Ø§Ø¹Ø© Ø§Ø¬ØªÙ…Ø§Ø¹Ø§Øª Ø£Ùˆ Ø´Ø±ÙƒØ© Ù†Ø§Ø´Ø¦Ø© Ù…Ù…ÙˆÙ„Ø©. Ø¨Ø¯Ø£Øª Ø¨Ø¬ÙˆØ¹ â€” Ù„Ù„Ù†Ù…ÙˆØŒ Ù„Ù„Ø¥ØªÙ‚Ø§Ù†ØŒ ÙˆÙ„Ø´ÙŠØ¡ Ø­Ù‚ÙŠÙ‚ÙŠ. ØªÙ„Ù‚Ù‘Ù‰ Ø¹Ø§Ù…Ø± ØªØ¯Ø±ÙŠØ¨Ù‡ Ù…Ø¨Ø§Ø´Ø±Ø© ØªØ­Øª Ø¥Ø´Ø±Ø§Ù Ù…ØµÙ…Ù… Ø¬Ø±Ø§ÙÙŠÙƒ Ù…Ø­ØªØ±ÙØŒ Ø­ÙŠØ« Ø§Ø³ØªÙˆØ¹Ø¨ Ø§Ù„Ø§Ù†Ø¶Ø¨Ø§Ø· ÙˆØ§Ù„Ø¹ÙŠÙ† Ø§Ù„Ø¯Ù‚ÙŠÙ‚Ø© ÙˆØ§Ù„Ù…Ø¹Ø§ÙŠÙŠØ± Ø§Ù„ØªÙŠ Ù„Ø§ ØªÙ‡Ø§ÙˆÙ† ÙÙŠÙ‡Ø§. Ù…Ø§ Ø¨Ø¯Ø£ ÙƒØªØ¹Ù„ÙŠÙ… Ø£ØµØ¨Ø­ Ø±Ø³Ø§Ù„Ø©. Ø­ÙŠÙ† Ø§Ù„ØªÙ‚Ù‰ Ø§Ù„Ø·Ù…ÙˆØ­ Ø¨Ø§Ù„Ø¶Ø±ÙˆØ±Ø©ØŒ ÙˆÙÙ„Ø¯Øª GBA.">
          GBA didn't start in a boardroom or a funded startup. It started with a hunger â€” for growth, for craft, and for something real. Trained directly under a professional graphic designer, Amer absorbed the discipline, the eye for detail, and the uncompromising standards that define exceptional visual work.
          <br><br>
          What began as an education became a calling. When ambition met necessity, GBA was born â€” a one-person studio that operates with the precision of an agency and the soul of an artist. Every project is personal. Every build is deliberate. Nothing ships unless it's exceptional.
        </p>
      </div>
      <div class="acard-more"><div class="acard-more-line"></div><span data-en="Read more" data-ar="Ø§Ù‚Ø±Ø£ Ø§Ù„Ù…Ø²ÙŠØ¯">Read more</span></div>
    </div>

    <div class="acard" id="ac2" onclick="activateCard('ac2')">
      <div class="acard-img" style="background:linear-gradient(135deg,var(--grad-c2),var(--grad-c3));display:flex;align-items:center;justify-content:center;font-size:28px;">â¬¡</div>
      <span class="acard-tag" id="live-c2tag" data-en="02 â€” Services" data-ar="Ù Ù¢ â€” Ø§Ù„Ø®Ø¯Ù…Ø§Øª">02 â€” Services</span>
      <div class="acard-title" id="live-c2title" data-en="What We Deliver" data-ar="Ù…Ø§ Ù†Ù‚Ø¯Ù…Ù‡">What We Deliver</div>
      <div class="acard-preview">
        <p class="acard-text" id="live-c2body"
          data-en="GBA specializes in premium website development â€” from polished landing pages and brand portfolios, to fully functional client platforms with authentication, dashboards, and live features. Graphic design roots inform every layout decision: the hierarchy is intentional, the motion is purposeful, and the result is a product that looks like it cost ten times more than it did. Whether you're a business owner, a creator, or a startup â€” if you need a digital presence that commands attention, GBA delivers it."
          data-ar="ØªØªØ®ØµØµ GBA ÙÙŠ ØªØ·ÙˆÙŠØ± Ø§Ù„Ù…ÙˆØ§Ù‚Ø¹ Ø§Ù„Ù…ØªÙ…ÙŠØ²Ø© â€” Ù…Ù† ØµÙØ­Ø§Øª Ø§Ù„Ù‡Ø¨ÙˆØ· Ø§Ù„Ù…ØµÙ‚ÙˆÙ„Ø©ØŒ Ø¥Ù„Ù‰ Ø§Ù„Ù…Ù†ØµØ§Øª Ø§Ù„ÙƒØ§Ù…Ù„Ø© Ø¨Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø© ÙˆÙ„ÙˆØ­Ø§Øª Ø§Ù„ØªØ­ÙƒÙ… ÙˆØ§Ù„Ù…ÙŠØ²Ø§Øª Ø§Ù„Ø­ÙŠØ©. Ø¬Ø°ÙˆØ± Ø§Ù„ØªØµÙ…ÙŠÙ… Ø§Ù„Ø¬Ø±Ø§ÙÙŠÙƒÙŠ ØªÙØ´ÙƒÙ‘Ù„ ÙƒÙ„ Ù‚Ø±Ø§Ø± ÙÙŠ Ø§Ù„ØªØ®Ø·ÙŠØ·.">
          GBA specializes in premium website development â€” from polished landing pages and brand portfolios, to fully functional client platforms with authentication, dashboards, and live features.
          <br><br>
          Graphic design roots inform every layout decision: the hierarchy is intentional, the motion is purposeful, and the result is a product that looks like it cost ten times more than it did. If you need a digital presence that commands attention, GBA delivers it.
        </p>
      </div>
      <div class="acard-more"><div class="acard-more-line"></div><span data-en="Read more" data-ar="Ø§Ù‚Ø±Ø£ Ø§Ù„Ù…Ø²ÙŠØ¯">Read more</span></div>
    </div>

    <div class="acard" id="ac3" onclick="activateCard('ac3')">
      <div class="acard-img" style="background:linear-gradient(135deg,var(--grad-c1),var(--grad-c3));display:flex;align-items:center;justify-content:center;font-size:28px;">â—ˆ</div>
      <span class="acard-tag" id="live-c3tag" data-en="03 â€” Philosophy" data-ar="Ù Ù£ â€” Ø§Ù„ÙÙ„Ø³ÙØ©">03 â€” Philosophy</span>
      <div class="acard-title" id="live-c3title" data-en="The GBA Standard" data-ar="Ù…Ø¹ÙŠØ§Ø± GBA">The GBA Standard</div>
      <div class="acard-preview">
        <p class="acard-text" id="live-c3body"
          data-en="Most developers build websites. GBA builds experiences. The difference is in the obsession â€” over spacing, over transitions, over how a button feels when you hover over it at 2am. This level of craft doesn't usually come at an accessible price point. GBA exists precisely to change that. Studio-quality output, honest communication, fast delivery, and a price that respects your budget. No bloated agency overhead. No junior handed your project. Just Amer â€” accountable, invested, and relentless until the work is right."
          data-ar="Ù…Ø¹Ø¸Ù… Ø§Ù„Ù…Ø·ÙˆØ±ÙŠÙ† ÙŠØ¨Ù†ÙˆÙ† Ù…ÙˆØ§Ù‚Ø¹. GBA ØªØ¨Ù†ÙŠ ØªØ¬Ø§Ø±Ø¨. Ø§Ù„ÙØ§Ø±Ù‚ ÙŠÙƒÙ…Ù† ÙÙŠ Ø§Ù„Ù‡ÙˆØ³ â€” Ø¨Ø§Ù„Ù…Ø³Ø§ÙØ§ØªØŒ Ø¨Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„Ø§ØªØŒ Ø¨Ø·Ø±ÙŠÙ‚Ø© Ø´Ø¹ÙˆØ± Ø§Ù„Ø²Ø± Ø¹Ù†Ø¯ ØªØ­Ø±ÙŠÙƒ Ø§Ù„Ù…Ø§ÙˆØ³ Ø¹Ù„ÙŠÙ‡. Ù‡Ø°Ø§ Ø§Ù„Ù…Ø³ØªÙˆÙ‰ Ù…Ù† Ø§Ù„Ø¥ØªÙ‚Ø§Ù† Ù„Ø§ ÙŠØ£ØªÙŠ Ø¹Ø§Ø¯Ø©Ù‹ Ø¨Ø³Ø¹Ø± Ù…Ù†Ø§Ø³Ø¨. GBA Ù…ÙˆØ¬ÙˆØ¯Ø© Ù„ØªØºÙŠÙŠØ± Ø°Ù„Ùƒ ØªØ­Ø¯ÙŠØ¯Ø§Ù‹.">
          Most developers build websites. GBA builds experiences. The difference is in the obsession â€” over spacing, over transitions, over how a button feels when you hover over it at 2am.
          <br><br>
          This level of craft doesn't usually come at an accessible price point. GBA exists precisely to change that. Studio-quality output, honest communication, fast delivery â€” no bloated overhead, no junior handed your project. Just Amer: accountable, invested, and relentless until the work is right.
        </p>
      </div>
      <div class="acard-more"><div class="acard-more-line"></div><span data-en="Read more" data-ar="Ø§Ù‚Ø±Ø£ Ø§Ù„Ù…Ø²ÙŠØ¯">Read more</span></div>
    </div>
  </div>
</section>

<div class="sep"></div>

<!-- â•â•â• PREVIOUS WORKS â•â•â• -->
<section id="works" class="reveal" style="transition-delay:.1s">
  <div class="works-header">
    <div>
      <span class="sec-eyebrow" data-en="Portfolio" data-ar="Ø£Ø¹Ù…Ø§Ù„ÙŠ">Portfolio</span>
      <div class="sec-title" data-en="Previous Works" data-ar="Ø£Ø¹Ù…Ø§Ù„ Ø³Ø§Ø¨Ù‚Ø©">Previous Works</div>
    </div>
    <button class="works-arrow" data-en="View all â†’" data-ar="â† Ø¹Ø±Ø¶ Ø§Ù„ÙƒÙ„">View all â†’</button>
  </div>

  <div class="works-scroll">
    <div class="works-row">
      <div class="work-card"><div class="work-card-inner"><span class="work-label" id="live-w1">Project 01</span></div></div>
      <div class="work-card"><div class="work-card-inner"><span class="work-label" id="live-w2">Project 02</span></div></div>
      <div class="work-card"><div class="work-card-inner"><span class="work-label" id="live-w3">Project 03</span></div></div>
      <div class="work-card"><div class="work-card-inner"><span class="work-label" id="live-w4">Project 04</span></div></div>
      <div class="work-card"><div class="work-card-inner"><span class="work-label" id="live-w5">Project 05</span></div></div>
    </div>
  </div>
</section>

<div class="sep"></div>

<!-- â•â•â• NEWSLETTER â•â•â• -->
<section id="newsletter" class="reveal" style="transition-delay:.15s">
  <div class="newsletter-card">
    <span class="newsletter-eyebrow" data-en="Stay in the loop" data-ar="Ø§Ø¨Ù‚ Ø¹Ù„Ù‰ Ø§Ø·Ù„Ø§Ø¹">Stay in the loop</span>
    <div class="newsletter-title" data-en="Design Trends of the Month" data-ar="Ø§ØªØ¬Ø§Ù‡Ø§Øª Ø§Ù„ØªØµÙ…ÙŠÙ… Ø§Ù„Ø´Ù‡Ø±ÙŠØ©">Design Trends of the Month</div>
    <p class="newsletter-sub" data-en="Get curated design inspiration, project updates, and exclusive offers delivered straight to your inbox. No spam, ever." data-ar="Ø§Ø­ØµÙ„ Ø¹Ù„Ù‰ Ø¥Ù„Ù‡Ø§Ù… ØªØµÙ…ÙŠÙ…ÙŠ Ù…Ù†ØªÙ‚Ù‰ØŒ ÙˆØªØ­Ø¯ÙŠØ«Ø§Øª Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹ØŒ ÙˆØ¹Ø±ÙˆØ¶ Ø­ØµØ±ÙŠØ© Ù…Ø¨Ø§Ø´Ø±Ø© ÙÙŠ Ø¨Ø±ÙŠØ¯Ùƒ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ.">Get curated design inspiration, project updates, and exclusive offers delivered straight to your inbox. No spam, ever.</p>
    <div class="newsletter-form">
      <input type="email" id="nl-email" placeholder="your@email.com" data-en-ph="your@email.com" data-ar-ph="Ø¨Ø±ÙŠØ¯Ùƒ@Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ.com">
      <button class="btn-p" onclick="subscribeNewsletter()" style="white-space:nowrap;" data-en="Subscribe â†’" data-ar="â† Ø§Ø´ØªØ±Ùƒ">Subscribe â†’</button>
    </div>
    <div class="nl-success" id="nl-success" data-en="ğŸ‰ You're subscribed! Welcome to the GBA family." data-ar="ğŸ‰ ØªÙ… Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ! Ù…Ø±Ø­Ø¨Ù‹Ø§ Ø¨Ùƒ ÙÙŠ Ø¹Ø§Ø¦Ù„Ø© GBA.">ğŸ‰ You're subscribed! Welcome to the GBA family.</div>
  </div>
</section>

<div class="sep"></div>

<!-- â•â•â• FOOTER â•â•â• -->
<footer class="reveal" style="transition-delay:.15s">
  <div class="f-brand">
    <span class="f-logo-text">GBA</span>
    <span class="f-sub" id="live-ftag" data-en="Graphics By Amer Corporation" data-ar="Ø¬Ø±Ø§ÙÙŠÙƒØ³ Ø¨Ø§ÙŠ Ø¹Ø§Ù…Ø±">Graphics By Amer Corporation</span>
    <span class="f-sub" style="margin-top:4px">ğŸ“ <span id="live-phone">01515929659</span></span>
  </div>
  <div class="f-social">
    <span class="f-social-label" data-en="Contact & Support" data-ar="Ø§Ù„ØªÙˆØ§ØµÙ„ ÙˆØ§Ù„Ø¯Ø¹Ù…">Contact & Support</span>
    <div class="f-dots">
      <div class="fdot" title="WhatsApp">ğŸ’¬</div>
      <div class="fdot" title="Instagram">ğŸ“·</div>
      <div class="fdot" title="Email">âœ‰ï¸</div>
    </div>
  </div>
  <div class="f-copy">
    <p>Â© 2025 GBA</p>
    <p data-en="Graphics By Amer Corporation" data-ar="Ø¬Ø±Ø§ÙÙŠÙƒØ³ Ø¨Ø§ÙŠ Ø¹Ø§Ù…Ø±">Graphics By Amer Corporation</p>
    <p style="margin-top:6px;font-size:10px;opacity:.6;" id="live-fcopy" data-en="All rights reserved Â· Egypt" data-ar="Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø© Â· Ù…ØµØ±">All rights reserved Â· Egypt</p>
  </div>
</footer>

</main>

<!-- â•â•â• ANNOUNCEMENT BANNER â•â•â• -->
<div class="adm-announce" id="site-announce" style="position:fixed;top:68px;left:0;right:0;margin:0;border-radius:0;z-index:999;">
  <span id="site-announce-text"></span>
  <span style="float:right;cursor:pointer;opacity:.6;" onclick="dismissAnnounce()">âœ•</span>
</div>

<!-- â•â•â• LIVE SUPPORT CHAT â•â•â• -->
<button class="chat-fab" id="chat-fab" onclick="toggleChat()" title="Live Support">
  ğŸ’¬
  <span class="chat-notif" id="chat-notif">!</span>
</button>

<div class="chat-window" id="chat-window">
  <div class="chat-drag-overlay">ğŸ“<span>Drop files to send</span></div>
  <div class="chat-header">
    <div class="chat-avatar">âœ¨</div>
    <div class="chat-header-info">
      <div class="chat-header-name">GBA Support</div>
      <div class="chat-header-status" id="chat-status-text">Online â€” typically replies instantly</div>
    </div>
    <div class="chat-status-dot" id="chat-status-dot"></div>
    <button class="chat-close" onclick="toggleChat()">âœ•</button>
  </div>
  <div class="chat-messages" id="chat-messages">
    <div class="chat-empty" id="chat-empty">
      <div style="font-size:32px;margin-bottom:12px;">ğŸ‘‹</div>
      <strong>Hi! Welcome to GBA Support.</strong><br><br>
      Sign in to start a live chat with our team.
    </div>
  </div>
  <!-- Auth gate shown when not logged in -->
  <div class="chat-auth-gate" id="chat-auth-gate" style="display:none;">
    <div class="chat-auth-icon">ğŸ”</div>
    <div class="chat-auth-title">Members Only</div>
    <div class="chat-auth-sub">You need an account to contact us via live chat.</div>
    <div class="chat-auth-btns">
      <button class="btn-p" onclick="toggleChat();openFSOnTab('su');">Create Free Account â†’</button>
      <button class="btn-o" onclick="toggleChat();openFSOnTab('li');">Already have an account? Log in</button>
    </div>
  </div>
  <!-- Normal chat footer shown when logged in -->
  <div class="chat-footer" id="chat-footer-input" style="flex-direction:column;gap:0;padding:0;">
    <!-- File preview bar (shown when file selected) -->
    <div id="chat-file-preview-bar" style="display:none;padding:8px 14px 0;gap:8px;align-items:center;flex-wrap:wrap;"></div>
    <div style="display:flex;gap:8px;align-items:center;padding:10px 14px;">
      <!-- Hidden file input -->
      <input type="file" id="chat-file-input" multiple accept="image/*,video/*,.pdf,.doc,.docx,.xls,.xlsx,.ppt,.pptx,.txt,.zip,.rar,.html,.htm,.css,.js,.json,.csv" style="display:none;" onchange="handleChatFileSelect(event)">
      <button class="chat-attach" onclick="document.getElementById('chat-file-input').click()" title="Attach file">ğŸ“</button>
      <textarea class="chat-input" id="chat-input" placeholder="Type a messageâ€¦" rows="1" onkeydown="chatKeydown(event)" oninput="autoResizeChatInput(this)"></textarea>
      <button class="chat-send" onclick="sendChatMsg()" title="Send">â¤</button>
    </div>
  </div>
</div>

<!-- â•â•â• AUTH FULLSCREEN â•â•â• -->
<div class="fs" id="fs-ov">
  <div class="fsh">
    <div class="fsbrand" data-en="Account" data-ar="Ø§Ù„Ø­Ø³Ø§Ø¨">Account</div>
    <button class="fsclose" onclick="closeFS()">Ã—</button>
  </div>
  <div class="fsb">
    <div class="aw">
      <!-- Logged in state -->
      <div id="f-loggedin" style="display:none;flex-direction:column;gap:20px;padding:8px 0 10px;">
        <!-- Profile card -->
        <div class="loggedin-card">
          <div style="display:flex;align-items:center;gap:16px;">
            <div id="li-avatar" style="width:64px;height:64px;border-radius:50%;background:linear-gradient(135deg,var(--primary),var(--secondary));display:flex;align-items:center;justify-content:center;font-size:26px;box-shadow:0 8px 30px var(--primary-glow);flex-shrink:0;">ğŸ‘¤</div>
            <div style="flex:1;overflow:hidden;">
              <div id="li-name-display" style="font-family:'DM Serif Display',serif;font-size:22px;font-weight:400;margin-bottom:4px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;"></div>
              <div id="li-email-display" style="font-size:12px;color:var(--text-muted);letter-spacing:.03em;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;"></div>
              <div id="li-badge-row" style="display:flex;gap:6px;flex-wrap:wrap;margin-top:8px;"></div>
            </div>
          </div>
        </div>

        <!-- Stats / Session info -->
        <div style="display:grid;grid-template-columns:1fr 1fr 1fr;gap:10px;">
          <div style="background:var(--card-bg);border:1px solid var(--border-strong);border-radius:14px;padding:14px;text-align:center;">
            <div style="font-size:20px;margin-bottom:4px;" id="li-stat-icon">âœ¨</div>
            <div style="font-size:10px;letter-spacing:.1em;text-transform:uppercase;color:var(--text-muted);">Member</div>
          </div>
          <div style="background:var(--card-bg);border:1px solid var(--border-strong);border-radius:14px;padding:14px;text-align:center;">
            <div style="font-size:13px;font-weight:600;color:var(--primary);margin-bottom:2px;" id="li-session-time">8h</div>
            <div style="font-size:10px;letter-spacing:.1em;text-transform:uppercase;color:var(--text-muted);">Session</div>
          </div>
          <div style="background:var(--card-bg);border:1px solid var(--border-strong);border-radius:14px;padding:14px;text-align:center;">
            <div style="font-size:13px;font-weight:600;color:#4ade80;margin-bottom:2px;">â—</div>
            <div style="font-size:10px;letter-spacing:.1em;text-transform:uppercase;color:var(--text-muted);">Active</div>
          </div>
        </div>

        <!-- Action buttons -->
        <div style="display:flex;flex-direction:column;gap:10px;">
          <div id="li-admin-btn-wrap" style="display:none;">
            <button class="btn-p" style="width:100%;padding:13px;display:flex;align-items:center;justify-content:center;gap:8px;" onclick="closeFS();openAdminPanel();">
              ğŸ›¡ï¸ <span>Open Administration Panel</span>
            </button>
          </div>
          <button style="width:100%;padding:13px;background:var(--card-bg);border:1.5px solid var(--border-strong);border-radius:16px;font-family:'Jost',sans-serif;font-size:13px;color:var(--text);cursor:pointer;display:flex;align-items:center;justify-content:center;gap:8px;transition:all .2s;" onmouseover="this.style.borderColor='var(--primary)';this.style.color='var(--primary)';" onmouseout="this.style.borderColor='var(--border-strong)';this.style.color='var(--text)';" onclick="toggleChat();closeFS();">
            ğŸ’¬ <span>Open Live Chat</span>
          </button>
          <button style="width:100%;padding:13px;background:rgba(239,68,68,.08);border:1.5px solid rgba(239,68,68,.25);border-radius:16px;font-family:'Jost',sans-serif;font-size:13px;color:#ef4444;cursor:pointer;display:flex;align-items:center;justify-content:center;gap:8px;transition:all .2s;" onmouseover="this.style.background='#ef4444';this.style.color='#fff';" onmouseout="this.style.background='rgba(239,68,68,.08)';this.style.color='#ef4444';" onclick="closeFS();doLogout();">
            ğŸšª <span>Log Out</span>
          </button>
        </div>
      </div>

      <!-- Auth tabs -->
      <div class="atabs" id="auth-tabs">
        <button class="atab active" id="t-su" onclick="swTab('su')" data-en="Sign Up" data-ar="Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨">Sign Up</button>
        <button class="atab" id="t-li" onclick="swTab('li')" data-en="Login" data-ar="ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„">Login</button>
      </div>

      <!-- SIGN UP -->
      <div class="aform" id="f-su">
        <!-- Steps indicator -->
        <div class="signup-steps" id="su-step-indicator">
          <div class="signup-step-item">
            <div style="display:flex;flex-direction:column;align-items:center;gap:4px;">
              <div class="signup-step-circle active" id="su-sc-1">1</div>
              <div class="signup-step-label">Account</div>
            </div>
            <div class="signup-step-line" id="su-sl-1"></div>
          </div>
          <div class="signup-step-item">
            <div style="display:flex;flex-direction:column;align-items:center;gap:4px;">
              <div class="signup-step-circle" id="su-sc-2">2</div>
              <div class="signup-step-label">Profile</div>
            </div>
            <div class="signup-step-line" id="su-sl-2"></div>
          </div>
          <div class="signup-step-item" style="flex:0;">
            <div style="display:flex;flex-direction:column;align-items:center;gap:4px;">
              <div class="signup-step-circle" id="su-sc-3">3</div>
              <div class="signup-step-label">Verify</div>
            </div>
          </div>
        </div>



        <!-- Step 1: Account details -->
        <div id="su-step1">
          <div class="fg"><label class="fl" data-en="Full Name" data-ar="Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„">Full Name</label><input id="su-name" type="text" class="fi2" placeholder="Your full name" data-en-ph="Your full name" data-ar-ph="Ø§Ø³Ù…Ùƒ Ø§Ù„ÙƒØ§Ù…Ù„"></div>
          <div class="fg" style="margin-top:14px"><label class="fl" data-en="Email Address" data-ar="Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ">Email Address</label><input id="su-email" type="email" class="fi2" placeholder="your@email.com" data-en-ph="your@email.com" data-ar-ph="Ø¨Ø±ÙŠØ¯Ùƒ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ"></div>

          <!-- Age & DOB sliders -->
          <div class="fg" style="margin-top:14px;">
            <label class="fl">Date of Birth</label>
            <div id="dob-slider-wrap" style="background:var(--input-bg);border:1.5px solid var(--border-strong);border-radius:14px;padding:16px 14px 12px;display:flex;flex-direction:column;gap:14px;">

              <!-- Day -->
              <div style="display:flex;flex-direction:column;gap:6px;">
                <div style="display:flex;justify-content:space-between;align-items:center;">
                  <span style="font-size:11px;letter-spacing:.07em;color:var(--text-muted);text-transform:uppercase;">Day</span>
                  <span id="dob-day-val" style="font-size:15px;font-weight:500;color:var(--primary);min-width:28px;text-align:right;">1</span>
                </div>
                <input id="su-dob-day" type="range" min="1" max="31" value="1" class="dob-slider" oninput="updateDOBSliders()">
              </div>

              <!-- Month -->
              <div style="display:flex;flex-direction:column;gap:6px;">
                <div style="display:flex;justify-content:space-between;align-items:center;">
                  <span style="font-size:11px;letter-spacing:.07em;color:var(--text-muted);text-transform:uppercase;">Month</span>
                  <span id="dob-month-val" style="font-size:15px;font-weight:500;color:var(--primary);min-width:80px;text-align:right;">January</span>
                </div>
                <input id="su-dob-month" type="range" min="1" max="12" value="1" class="dob-slider" oninput="updateDOBSliders()">
              </div>

              <!-- Year -->
              <div style="display:flex;flex-direction:column;gap:6px;">
                <div style="display:flex;justify-content:space-between;align-items:center;">
                  <span style="font-size:11px;letter-spacing:.07em;color:var(--text-muted);text-transform:uppercase;">Year</span>
                  <span id="dob-year-val" style="font-size:15px;font-weight:500;color:var(--primary);min-width:48px;text-align:right;">2000</span>
                </div>
                <input id="su-dob-year" type="range" min="1924" max="2011" value="2000" class="dob-slider" oninput="updateDOBSliders()">
              </div>

              <!-- Summary -->
              <div style="display:flex;justify-content:space-between;align-items:center;padding-top:4px;border-top:1px solid var(--border);">
                <span id="dob-summary" style="font-size:12px;color:var(--text-muted);">January 1, 2000</span>
                <span id="su-age-display" style="font-size:13px;font-weight:500;color:var(--text);">24 years old</span>
              </div>
            </div>
            <!-- Hidden field to store computed dob string -->
            <input type="hidden" id="su-dob" value="">
          </div>

          <div class="fg" style="margin-top:14px">
            <label class="fl" data-en="Password" data-ar="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±">Password</label>
            <div class="pw-wrap">
              <input id="su-pass" type="password" class="fi2" placeholder="Create a strong password" data-en-ph="Create a strong password" data-ar-ph="Ø£Ù†Ø´Ø¦ ÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ±" oninput="checkStrength(this.value)">
              <button type="button" class="pw-eye" onclick="togglePw('su-pass',this)" title="Show/hide password">
                <svg id="su-pass-eye-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/><circle cx="12" cy="12" r="3"/></svg>
              </button>
            </div>
            <div id="strength-bar-wrap" style="margin-top:8px;display:none;">
              <div class="strength-dots" id="strength-dots">
                <div class="strength-dot" id="sd1"></div>
                <div class="strength-dot" id="sd2"></div>
                <div class="strength-dot" id="sd3"></div>
                <div class="strength-dot" id="sd4"></div>
                <div class="strength-dot" id="sd5"></div>
              </div>
              <span id="strength-label" style="font-size:11px;color:var(--text-muted);margin-top:4px;display:block;"></span>
            </div>
          </div>
          <div class="fg" style="margin-top:14px">
            <label class="fl">Terms & Conditions</label>
            <div class="tbox">By using GBA services, you agree to our terms. All purchases are final unless stated otherwise. We reserve the right to update these terms at any time. Your data is encrypted and never shared with third parties. Users must be 13 years or older to create an account.</div>
          </div>
          <label class="cbrow" style="margin-top:14px"><input id="su-agree" type="checkbox"><span data-en="I agree and have read all terms and conditions" data-ar="Ø£ÙˆØ§ÙÙ‚ ÙˆÙ‚Ø¯ Ù‚Ø±Ø£Øª Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø´Ø±ÙˆØ· ÙˆØ§Ù„Ø£Ø­ÙƒØ§Ù…">I agree and have read all terms and conditions</span></label>
          <div id="su-msg" style="font-size:12px;color:#ef4444;margin-top:8px;display:none;"></div>
          <button class="btn-p" style="margin-top:16px;width:100%;padding:13px;" onclick="suStep1()" data-en="Continue â†’" data-ar="â† Ù…ØªØ§Ø¨Ø¹Ø©">Continue â†’</button>
        </div>
        <div id="su-step2" style="display:none;flex-direction:column;gap:14px;">
          <p style="font-size:13px;color:var(--text-muted);line-height:1.7;" id="su-sent-msg">A 6-digit verification code has been sent to your email.</p>
          <div style="display:flex;align-items:center;gap:8px;">
            <span style="font-size:11px;color:var(--text-muted);" data-en="Code expires in" data-ar="ÙŠÙ†ØªÙ‡ÙŠ Ø§Ù„Ø±Ù…Ø² Ø®Ù„Ø§Ù„">Code expires in</span>
            <span id="su-expiry" style="font-size:12px;font-weight:500;color:var(--primary);font-variant-numeric:tabular-nums;">2:00</span>
          </div>
          <div class="fg"><label class="fl" data-en="Verification Code" data-ar="Ø±Ù…Ø² Ø§Ù„ØªØ­Ù‚Ù‚">Verification Code</label>
          <input id="su-code" type="text" class="fi2" placeholder="â€” â€” â€” â€” â€” â€”" maxlength="6" style="letter-spacing:.3em;font-size:20px;text-align:center;"></div>
          <div id="su-code-msg" style="font-size:12px;color:#ef4444;display:none;"></div>
          <button class="btn-p" style="padding:13px;width:100%;" onclick="suVerify()" data-en="Verify & Create Account" data-ar="ØªØ­Ù‚Ù‚ ÙˆØ£Ù†Ø´Ø¦ Ø§Ù„Ø­Ø³Ø§Ø¨">Verify & Create Account</button>
          <button class="btn-o" id="su-resend-btn" onclick="suResend()" style="font-size:12px;padding:8px 18px;" disabled>
            <span data-en="Resend Code" data-ar="Ø¥Ø¹Ø§Ø¯Ø© Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø±Ù…Ø²">Resend Code</span> <span id="su-resend-cd" style="opacity:.7;">(30s)</span>
          </button>
        </div>
      </div>

      <!-- LOGIN -->
      <div class="aform h" id="f-li">

        <div id="li-step1">
          <div id="quick-login-bar" style="display:none;background:rgba(var(--accent-rgb),.08);border:1.5px solid rgba(var(--accent-rgb),.25);border-radius:12px;padding:12px 14px;margin-bottom:14px;align-items:center;gap:10px;">
            <span style="font-size:13px;flex:1;" id="quick-login-label">Quick login as <strong></strong></span>
            <button class="btn-p" onclick="doQuickLogin()" style="padding:7px 16px;font-size:12px;">One-tap â†’</button>
            <button onclick="clearSavedLogin()" style="background:none;border:none;cursor:pointer;font-size:16px;color:var(--text-muted);padding:0 4px;">âœ•</button>
          </div>
          <div class="fg"><label class="fl">Email</label><input id="li-email" type="email" class="fi2" placeholder="Your email"></div>
          <div class="fg" style="margin-top:14px">
            <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:6px;">
              <label class="fl" style="margin:0;">Password</label>
              <button onclick="showForgotPassword()" style="background:none;border:none;cursor:pointer;font-size:11px;color:var(--primary);letter-spacing:.04em;">Forgot password?</button>
            </div>
            <div class="pw-wrap">
              <input id="li-pass" type="password" class="fi2" placeholder="Your password">
              <button type="button" class="pw-eye" onclick="togglePw('li-pass',this)" title="Show/hide password">
                <svg id="li-pass-eye-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/><circle cx="12" cy="12" r="3"/></svg>
              </button>
            </div>
          </div>
          <label class="cbrow" style="margin-top:12px;cursor:pointer;">
            <input type="checkbox" id="li-remember" style="width:15px;height:15px;accent-color:var(--primary);">
            <span style="font-size:12px;color:var(--text-muted);">Remember me on this device</span>
          </label>
          <div id="li-attempts-bar" style="display:none;margin-top:8px;">
            <div style="height:3px;background:var(--border-strong);border-radius:3px;overflow:hidden;">
              <div id="li-attempts-fill" style="height:100%;background:#ef4444;border-radius:3px;transition:width .3s;width:0%;"></div>
            </div>
            <span id="li-attempts-label" style="font-size:11px;color:#ef4444;margin-top:3px;display:block;"></span>
          </div>
          <div id="li-msg" style="font-size:12px;color:#ef4444;margin-top:8px;display:none;"></div>
          <button class="btn-p" onclick="doLogin()" style="margin-top:16px;width:100%;padding:13px;">Log In â†’</button>
        </div>
        <div id="li-step2" style="display:none;flex-direction:column;gap:14px;">
          <p style="font-size:13px;color:var(--text-muted);line-height:1.7;" id="li-sent-msg">A 6-digit code has been sent to your email to confirm your login.</p>
          <div style="display:flex;align-items:center;gap:8px;">
            <span style="font-size:11px;color:var(--text-muted);">Code expires in</span>
            <span id="li-expiry" style="font-size:12px;font-weight:500;color:var(--primary);font-variant-numeric:tabular-nums;">2:00</span>
          </div>
          <div class="fg"><label class="fl">Verification Code</label>
          <input id="li-code" type="text" class="fi2" placeholder="â€” â€” â€” â€” â€” â€”" maxlength="6" style="letter-spacing:.3em;font-size:20px;text-align:center;"></div>
          <div id="li-code-msg" style="font-size:12px;color:#ef4444;display:none;"></div>
          <button class="btn-p" style="padding:13px;width:100%;" onclick="liVerify()">Confirm Login</button>
          <button class="btn-o" id="li-resend-btn" onclick="liResend()" style="font-size:12px;padding:8px 18px;" disabled>
            Resend Code <span id="li-resend-cd" style="opacity:.7;">(30s)</span>
          </button>
        </div>
        <!-- Forgot password step -->
        <div id="li-forgot" style="display:none;flex-direction:column;gap:14px;">
          <p style="font-size:13px;color:var(--text-muted);line-height:1.7;">Enter your email address and we'll send you a recovery code.</p>
          <div class="fg"><label class="fl">Email</label><input id="fp-email" type="email" class="fi2" placeholder="Your email"></div>
          <div id="fp-msg" style="font-size:12px;display:none;"></div>
          <button class="btn-p" style="padding:13px;width:100%;" onclick="doForgotPassword()">Send Recovery Code â†’</button>
          <button class="btn-o" style="font-size:12px;padding:8px 18px;" onclick="hideForgotPassword()">â† Back to Login</button>
        </div>
      </div>

    </div>
  </div>
</div>

<!-- â•â•â• ADMIN PANEL â•â•â• -->
<div id="admin-panel">
  <div class="adm-header">
    <div class="adm-title">ğŸ›¡ï¸ Administration <span class="adm-badge" id="adm-role-badge">OWNER</span></div>
    <button class="adm-close" onclick="closeAdminPanel()">âœ•</button>
  </div>
  <div class="adm-tabs">
    <button class="adm-tab active" onclick="admTab('users',this)">ğŸ‘¥ Accounts</button>
    <button class="adm-tab" onclick="admTab('log',this)">ğŸ“‹ Audit Log</button>
    <button class="adm-tab" onclick="admTab('bans',this)">ğŸš« IP Bans</button>
    <button class="adm-tab" onclick="admTab('chat',this)">ğŸ’¬ Live Chat</button>
    <button class="adm-tab" id="adm-editor-tab" onclick="admTab('editor',this)" style="display:none;">âœï¸ Edit Site</button>
    <button class="adm-tab" onclick="admTab('settings',this)">âš™ï¸ Settings</button>
  </div>
  <div class="adm-body">

    <!-- ACCOUNTS -->
    <div class="adm-section active" id="adm-users">
      <div class="adm-stats" id="adm-stats"></div>
      <div class="adm-toolbar">
        <input class="adm-search" id="adm-user-search" placeholder="ğŸ”  Search name or emailâ€¦" oninput="renderUsers()">
        <select class="adm-filter" id="adm-user-filter" onchange="renderUsers()">
          <option value="all">All accounts</option>
          <option value="active">Active only</option>
          <option value="banned">Banned only</option>
          <option value="admin">Admins only</option>
          <option value="vip">VIP only</option>
        </select>
      </div>
      <div class="adm-table-wrap">
        <table class="adm-table">
          <thead><tr><th>Name</th><th>Email</th><th>Role</th><th>Status</th><th>Joined</th><th>Last Login</th><th>Actions</th></tr></thead>
          <tbody id="adm-user-tbody"></tbody>
        </table>
      </div>
      <div class="adm-empty" id="adm-no-users" style="display:none"><div class="adm-empty-icon">ğŸ‘¤</div>No accounts found.</div>
    </div>

    <!-- AUDIT LOG -->
    <div class="adm-section" id="adm-log">
      <div class="adm-toolbar">
        <input class="adm-search" id="adm-log-search" placeholder="ğŸ”  Search logâ€¦" oninput="renderLog()">
        <select class="adm-filter" id="adm-log-filter" onchange="renderLog()">
          <option value="all">All events</option>
          <option value="login">Logins</option>
          <option value="signup">Signups</option>
          <option value="fail">Failures</option>
          <option value="admin">Admin actions</option>
          <option value="chat">Chat events</option>
        </select>
        <button class="adm-btn danger" onclick="clearAuditLog()">ğŸ—‘ Clear Log</button>
      </div>
      <div id="adm-log-list"></div>
      <div class="adm-empty" id="adm-no-log" style="display:none"><div class="adm-empty-icon">ğŸ“‹</div>No log entries yet.</div>
    </div>

    <!-- IP BANS -->
    <div class="adm-section" id="adm-bans">
      <div class="adm-toolbar">
        <input class="adm-search" id="adm-ban-ip-input" placeholder="Enter IP address to banâ€¦" style="max-width:260px">
        <button class="adm-btn danger" onclick="manualIPBan()">+ Ban IP</button>
      </div>
      <div class="adm-table-wrap">
        <table class="adm-table">
          <thead><tr><th>IP Address</th><th>Reason</th><th>Banned</th><th>Actions</th></tr></thead>
          <tbody id="adm-ban-tbody"></tbody>
        </table>
      </div>
      <div class="adm-empty" id="adm-no-bans" style="display:none"><div class="adm-empty-icon">ğŸš«</div>No IP bans active.</div>
    </div>

    <!-- LIVE CHAT ADMIN -->
    <div class="adm-section" id="adm-chat">
      <div class="adm-chat-layout" id="adm-chat-layout">
        <div class="adm-chat-sidebar" id="adm-chat-sidebar">
          <div style="padding:12px 16px;border-bottom:1px solid var(--border);font-size:11px;text-transform:uppercase;letter-spacing:.12em;color:var(--text-muted);">Conversations</div>
          <div id="adm-chat-list-items"></div>
          <div class="adm-empty" id="adm-no-chats" style="padding:24px 16px;"><div class="adm-empty-icon" style="font-size:24px;">ğŸ’¬</div>No active chats.</div>
        </div>
        <div class="adm-chat-main" id="adm-chat-main">
          <div class="adm-chat-empty" id="adm-chat-placeholder">Select a conversation to reply</div>
          <div id="adm-chat-pane" style="display:none;flex:1;flex-direction:column;">
            <div class="adm-chat-header-pane" id="adm-chat-pane-header"></div>
            <div class="adm-chat-msgs" id="adm-chat-pane-msgs"></div>
            <div class="adm-chat-input-row">
              <input class="adm-search" id="adm-chat-reply-input" placeholder="Reply as GBA Supportâ€¦" style="flex:1;" onkeydown="admChatKeydown(event)">
              <button class="adm-btn info" onclick="admSendReply()" style="padding:9px 18px;">Send</button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- EDIT SITE -->
    <div class="adm-section" id="adm-editor">
      <div style="max-width:680px;display:flex;flex-direction:column;gap:20px;">
        <div style="font-size:11px;letter-spacing:.1em;text-transform:uppercase;color:var(--text-muted);padding-bottom:4px;border-bottom:1px solid var(--border);">Hero Section</div>
        <div style="display:grid;grid-template-columns:1fr 1fr;gap:14px;">
          <div><div style="font-size:11px;color:var(--text-muted);margin-bottom:6px;text-transform:uppercase;letter-spacing:.08em;">Eyebrow</div><input class="adm-search" id="ed-eyebrow" placeholder="Graphics By Amer â€” GBA" style="width:100%"></div>
          <div><div style="font-size:11px;color:var(--text-muted);margin-bottom:6px;text-transform:uppercase;letter-spacing:.08em;">Badge Text</div><input class="adm-search" id="ed-badge" placeholder="Available for new projects" style="width:100%"></div>
        </div>
        <div><div style="font-size:11px;color:var(--text-muted);margin-bottom:6px;text-transform:uppercase;letter-spacing:.08em;">Headline â€” Line 1</div><input class="adm-search" id="ed-h1" placeholder="Websites that" style="width:100%"></div>
        <div style="display:grid;grid-template-columns:1fr 1fr;gap:14px;">
          <div><div style="font-size:11px;color:var(--text-muted);margin-bottom:6px;text-transform:uppercase;letter-spacing:.08em;">Headline â€” Italic Word</div><input class="adm-search" id="ed-hem" placeholder="trillion" style="width:100%"></div>
          <div><div style="font-size:11px;color:var(--text-muted);margin-bottom:6px;text-transform:uppercase;letter-spacing:.08em;">Headline â€” Line 3</div><input class="adm-search" id="ed-h3" placeholder="dollar." style="width:100%"></div>
        </div>
        <div><div style="font-size:11px;color:var(--text-muted);margin-bottom:6px;text-transform:uppercase;letter-spacing:.08em;">Subtitle Paragraph</div><textarea class="adm-search" id="ed-sub" rows="3" style="width:100%;resize:vertical;font-family:'Jost',sans-serif;font-size:12px;" placeholder="Premium, fully functional websitesâ€¦"></textarea></div>
        <div style="display:grid;grid-template-columns:1fr 1fr;gap:14px;">
          <div><div style="font-size:11px;color:var(--text-muted);margin-bottom:6px;text-transform:uppercase;letter-spacing:.08em;">Phone Number</div><input class="adm-search" id="ed-phone" placeholder="01515929659" style="width:100%"></div>
          <div><div style="font-size:11px;color:var(--text-muted);margin-bottom:6px;text-transform:uppercase;letter-spacing:.08em;">CTA Button Text</div><input class="adm-search" id="ed-cta1" placeholder="View Work â†’" style="width:100%"></div>
        </div>
        <div style="font-size:11px;letter-spacing:.1em;text-transform:uppercase;color:var(--text-muted);padding-bottom:4px;border-bottom:1px solid var(--border);margin-top:6px;">About Cards</div>
        <div style="background:var(--card-bg);border:1px solid var(--border-strong);border-radius:14px;padding:16px;">
          <div style="font-size:11px;color:var(--primary);margin-bottom:10px;letter-spacing:.1em;">CARD 1</div>
          <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-bottom:10px;"><input class="adm-search" id="ed-c1tag" placeholder="01 â€” Identity" style="width:100%;font-size:11px;"><input class="adm-search" id="ed-c1title" placeholder="About GBA" style="width:100%;"></div>
          <textarea class="adm-search" id="ed-c1body" rows="3" style="width:100%;resize:vertical;font-family:'Jost',sans-serif;font-size:12px;" placeholder="Your story hereâ€¦"></textarea>
        </div>
        <div style="background:var(--card-bg);border:1px solid var(--border-strong);border-radius:14px;padding:16px;">
          <div style="font-size:11px;color:var(--primary);margin-bottom:10px;letter-spacing:.1em;">CARD 2</div>
          <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-bottom:10px;"><input class="adm-search" id="ed-c2tag" placeholder="02 â€” Services" style="width:100%;font-size:11px;"><input class="adm-search" id="ed-c2title" placeholder="What We Offer" style="width:100%;"></div>
          <textarea class="adm-search" id="ed-c2body" rows="3" style="width:100%;resize:vertical;font-family:'Jost',sans-serif;font-size:12px;" placeholder="Your services hereâ€¦"></textarea>
        </div>
        <div style="background:var(--card-bg);border:1px solid var(--border-strong);border-radius:14px;padding:16px;">
          <div style="font-size:11px;color:var(--primary);margin-bottom:10px;letter-spacing:.1em;">CARD 3</div>
          <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-bottom:10px;"><input class="adm-search" id="ed-c3tag" placeholder="03 â€” Why Us" style="width:100%;font-size:11px;"><input class="adm-search" id="ed-c3title" placeholder="Why Choose GBA" style="width:100%;"></div>
          <textarea class="adm-search" id="ed-c3body" rows="3" style="width:100%;resize:vertical;font-family:'Jost',sans-serif;font-size:12px;" placeholder="Your pitch hereâ€¦"></textarea>
        </div>
        <div style="font-size:11px;letter-spacing:.1em;text-transform:uppercase;color:var(--text-muted);padding-bottom:4px;border-bottom:1px solid var(--border);margin-top:6px;">Portfolio Work Labels</div>
        <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px;">
          <input class="adm-search" id="ed-w1" placeholder="Project 01" style="width:100%">
          <input class="adm-search" id="ed-w2" placeholder="Project 02" style="width:100%">
          <input class="adm-search" id="ed-w3" placeholder="Project 03" style="width:100%">
          <input class="adm-search" id="ed-w4" placeholder="Project 04" style="width:100%">
          <input class="adm-search" id="ed-w5" placeholder="Project 05" style="width:100%">
        </div>
        <div style="font-size:11px;letter-spacing:.1em;text-transform:uppercase;color:var(--text-muted);padding-bottom:4px;border-bottom:1px solid var(--border);margin-top:6px;">Footer</div>
        <div style="display:grid;grid-template-columns:1fr 1fr;gap:14px;">
          <div><div style="font-size:11px;color:var(--text-muted);margin-bottom:6px;text-transform:uppercase;letter-spacing:.08em;">Tagline</div><input class="adm-search" id="ed-ftag" placeholder="Graphics By Amer Corporation" style="width:100%"></div>
          <div><div style="font-size:11px;color:var(--text-muted);margin-bottom:6px;text-transform:uppercase;letter-spacing:.08em;">Copyright Note</div><input class="adm-search" id="ed-fcopy" placeholder="All rights reserved Â· Egypt" style="width:100%"></div>
        </div>
        <div style="display:flex;gap:10px;flex-wrap:wrap;padding-top:6px;">
          <button class="adm-btn info" onclick="saveEditorContent()" style="padding:10px 24px;font-size:13px;">ğŸ’¾ Save Changes</button>
          <button class="adm-btn neutral" onclick="loadEditorContent()" style="padding:10px 20px;font-size:13px;">â†º Reload</button>
        </div>
        <div id="ed-save-msg" style="font-size:12px;display:none;padding:8px 12px;border-radius:8px;"></div>
      </div>
    </div>

    <!-- SETTINGS -->
    <div class="adm-section" id="adm-settings">
      <div style="max-width:520px;display:flex;flex-direction:column;gap:16px;">
        <div class="adm-stat" style="border-color:rgba(var(--accent-rgb),.3)">
          <div style="font-size:12px;color:var(--text-muted);margin-bottom:10px;letter-spacing:.06em;text-transform:uppercase;">Change Admin Passphrase</div>
          <div style="display:flex;gap:10px;flex-wrap:wrap;">
            <input id="adm-new-pass" type="password" class="adm-search" placeholder="New passphrase (min 8 chars)" style="max-width:260px">
            <button class="adm-btn info" onclick="changeAdminPass()">Update</button>
          </div>
          <div id="adm-pass-msg" style="font-size:12px;margin-top:8px;display:none;"></div>
        </div>
        <div class="adm-stat">
          <div style="font-size:12px;color:var(--text-muted);margin-bottom:10px;letter-spacing:.06em;text-transform:uppercase;">Broadcast Announcement</div>
          <div style="display:flex;gap:10px;flex-wrap:wrap;margin-bottom:8px;">
            <input id="adm-announce-txt" type="text" class="adm-search" placeholder="Message to all usersâ€¦">
            <button class="adm-btn info" onclick="broadcastAnnounce()">Send</button>
          </div>
          <div style="font-size:11px;color:var(--text-muted);">Shows as a banner on the main site until dismissed.</div>
        </div>
        <div class="adm-stat" style="border-color:rgba(239,68,68,.3)">
          <div style="font-size:12px;color:var(--text-muted);margin-bottom:10px;letter-spacing:.06em;text-transform:uppercase;">Danger Zone</div>
          <div style="display:flex;gap:10px;flex-wrap:wrap;" id="danger-zone-btns">
            <button class="adm-btn danger" id="btn-wipe-all" onclick="admConfirm('Wipe ALL user accounts? This cannot be undone.','Wipe All Accounts',wipeAllAccounts)">ğŸ—‘ Wipe All Accounts</button>
            <button class="adm-btn warn" id="btn-force-logout" onclick="admConfirm('Force logout ALL currently logged-in users?','Force Logout All',forceLogoutAll)">âš¡ Force Logout All</button>
          </div>
          <div id="danger-owner-note" style="display:none;font-size:11px;color:var(--text-muted);margin-top:8px;">These actions are restricted to the site owner.</div>
        </div>
        <div class="adm-stat">
          <div style="font-size:12px;color:var(--text-muted);margin-bottom:10px;letter-spacing:.06em;text-transform:uppercase;">About This Panel</div>
          <div style="font-size:12px;color:var(--text-muted);line-height:1.8;">
            Access: Hidden OTP passphrase<br>
            Encryption: AES-GCM 256-bit<br>
            Password hashing: PBKDF2-SHA256 (310,000 iterations)<br>
            Sessions: HMAC-SHA256 signed + device fingerprint<br>
            Live Chat: localStorage pub/sub with real-time polling<br>
            Version: GBA Auth Fortress v4
          </div>
        </div>
      </div>
    </div>

  </div>
</div>

<!-- Confirm Modal -->
<div class="adm-modal-bg" id="adm-modal-bg">
  <div class="adm-modal">
    <h3 id="adm-modal-title">Confirm</h3>
    <p id="adm-modal-msg"></p>
    <div class="adm-modal-btns">
      <button class="adm-btn neutral" onclick="closeAdmModal()">Cancel</button>
      <button class="adm-btn danger" id="adm-modal-confirm">Confirm</button>
    </div>
  </div>
</div>

<!-- Toast -->
<div class="gba-toast" id="gba-toast">
  <span class="gba-toast-icon" id="gba-toast-icon">âœ…</span>
  <span id="gba-toast-msg">Done!</span>
</div>

<script>
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// OPTIMIZED CANVAS BACKGROUND (WebGL-style particles)
// Uses requestAnimationFrame with will-change optimization
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
(function(){
  const cv = document.getElementById('bg-canvas');
  const cx = cv.getContext('2d');
  const N = 65, MD = 140;
  let dots = [], W, H;

  function resize(){
    W = cv.width = innerWidth;
    H = cv.height = innerHeight;
  }

  function getAccentRGB(){
    const theme = document.documentElement.getAttribute('data-theme');
    const accent = document.documentElement.getAttribute('data-accent');
    if(theme === 'dark'){
      if(accent === 'cherry') return [200,38,74];
      if(accent === 'mango')  return [240,123,0];
      return [0,201,167];
    } else {
      if(accent === 'cherry') return [176,31,62];
      if(accent === 'mango')  return [212,105,0];
      return [0,140,116];
    }
  }

  function mk(fi){
    const t = Date.now(), life = 7000 + Math.random()*12000;
    return { x:Math.random()*W, y:Math.random()*H,
      vx:(Math.random()-.5)*.45, vy:(Math.random()-.5)*.45,
      r:Math.random()*2+.7, born:t, die:t+life,
      a:fi?0:.5, fo:false };
  }

  function init(){ dots=[]; for(let i=0;i<N;i++) dots.push(mk(false)); }

  function tick(){
    cx.clearRect(0,0,W,H);
    const [r,g,b] = getAccentRGB();
    const now = Date.now();

    for(let i=dots.length-1;i>=0;i--){
      const d=dots[i], left=d.die-now;
      if(!d.fo && d.a<.5) d.a = Math.min(.5, d.a+.008);
      if(left<2500){ d.fo=true; d.a*=(left/2500); }
      if(now>d.die && d.a<=0){ dots.splice(i,1); dots.push(mk(true)); }
    }
    while(dots.length<N) dots.push(mk(true));

    // Draw connections
    for(let i=0;i<dots.length;i++){
      for(let j=i+1;j<dots.length;j++){
        const dx=dots[i].x-dots[j].x, dy=dots[i].y-dots[j].y;
        const dist=Math.sqrt(dx*dx+dy*dy);
        if(dist<MD){
          const a=(1-dist/MD)*.15*Math.min(dots[i].a,dots[j].a);
          cx.beginPath(); cx.moveTo(dots[i].x,dots[i].y); cx.lineTo(dots[j].x,dots[j].y);
          cx.strokeStyle=`rgba(${r},${g},${b},${a})`; cx.lineWidth=.6; cx.stroke();
        }
      }
    }

    // Draw dots
    dots.forEach(d=>{
      d.x+=d.vx; d.y+=d.vy;
      if(d.x<0||d.x>W) d.vx*=-1;
      if(d.y<0||d.y>H) d.vy*=-1;
      cx.beginPath(); cx.arc(d.x,d.y,d.r,0,Math.PI*2);
      cx.fillStyle=`rgba(${r},${g},${b},${d.a})`; cx.fill();
    });

    requestAnimationFrame(tick);
  }

  resize(); init(); tick();
  window.addEventListener('resize', resize);
})();

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// CURSOR EFFECTS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
(function(){
  const blob = document.getElementById('cursor-blob');
  const canvas = document.getElementById('cursor-trail-canvas');
  const ctx = canvas.getContext('2d');
  const TL = 24;
  let mx=0,my=0,bx=0,by=0, trail=[];

  function isDesktop(){ return matchMedia('(hover:hover)').matches; }
  function resize(){ canvas.width=innerWidth; canvas.height=innerHeight; }

  window.addEventListener('mousemove',e=>{
    if(!isDesktop()) return;
    mx=e.clientX; my=e.clientY;
    blob.style.left=mx+'px'; blob.style.top=my+'px';
  });

  document.querySelectorAll('button, a, .acard, .work-card, .mode-btn, .fdot, .chat-fab').forEach(el=>{
    el.addEventListener('mouseenter',()=>blob.classList.add('hovered'));
    el.addEventListener('mouseleave',()=>blob.classList.remove('hovered'));
  });

  resize();
  window.addEventListener('resize', resize);

  function getTrailColor(a){
    const accent = document.documentElement.getAttribute('data-accent');
    if(accent==='mango') return `rgba(240,123,0,${a})`;
    if(accent==='cocktail') return `rgba(0,201,167,${a})`;
    if(accent==='void') return `rgba(139,92,246,${a})`;
    if(accent==='arctic') return `rgba(56,189,248,${a})`;
    if(accent==='ember') return `rgba(249,115,22,${a})`;
    if(accent==='forest') return `rgba(34,197,94,${a})`;
    if(accent==='rosegold') return `rgba(232,165,152,${a})`;
    return `rgba(200,38,74,${a})`;
  }

  function tick(){
    if(!isDesktop()){ requestAnimationFrame(tick); return; }
    bx+=(mx-bx)*.14; by+=(my-by)*.14;
    trail.unshift({x:bx,y:by});
    if(trail.length>TL) trail.pop();
    ctx.clearRect(0,0,canvas.width,canvas.height);
    trail.forEach((p,i)=>{
      const a=(1-i/TL)*0.2, r=7*(1-i/TL)+2;
      ctx.beginPath(); ctx.arc(p.x,p.y,r,0,Math.PI*2);
      ctx.fillStyle=getTrailColor(a); ctx.fill();
    });
    requestAnimationFrame(tick);
  }

  blob.style.display='block';
  tick();
})();

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// THEME ENGINE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function detectTheme(){ return localStorage.getItem('gba_theme')||(matchMedia('(prefers-color-scheme:dark)').matches?'dark':'light'); }
function detectAccent(){ return localStorage.getItem('gba_accent')||'cherry'; }

function applyTheme(t){
  document.documentElement.setAttribute('data-theme',t);
  localStorage.setItem('gba_theme',t);
  const icon=document.getElementById('mode-icon');
  if(icon) icon.textContent = t==='dark'?'ğŸŒ™':'â˜€ï¸';
  document.getElementById('pill-dark')?.classList.toggle('active',t==='dark');
  document.getElementById('pill-light')?.classList.toggle('active',t==='light');
}

function applyAccent(a){
  document.documentElement.setAttribute('data-accent',a);
  localStorage.setItem('gba_accent',a);
  ['cherry','mango','cocktail','void','arctic','ember','forest','rosegold'].forEach(acc=>{
    document.getElementById('acc-'+acc)?.classList.toggle('active',acc===a);
  });
}

function setBaseMode(mode){
  applyTheme(mode);
}
function setAccent(acc){
  applyAccent(acc);
}

function toggleModePanel(e){
  e.stopPropagation();
  const mp = document.getElementById('mode-panel');
  mp.classList.toggle('open');
  closeDD();
}
function closeModePanel(){ document.getElementById('mode-panel').classList.remove('open'); }

// Init theme
applyTheme(detectTheme());
applyAccent(detectAccent());

document.addEventListener('click',e=>{
  if(!e.target.closest('#mode-panel') && !e.target.closest('#mode-btn-trigger')) closeModePanel();
});

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// GSAP ANIMATIONS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
gsap.registerPlugin(ScrollTrigger);

window.addEventListener('load',()=>{
  // Hero entrance
  gsap.fromTo('#hero-left',
    {opacity:0, x:-50},
    {opacity:1, x:0, duration:1, ease:'power3.out', delay:.1}
  );
  gsap.fromTo('#hero-right',
    {opacity:0, x:50},
    {opacity:1, x:0, duration:1, ease:'power3.out', delay:.3}
  );

  // Stats row
  gsap.fromTo('.stat-item',
    {opacity:0, y:30},
    {opacity:1, y:0, duration:.7, stagger:.15, ease:'power2.out',
      scrollTrigger:{trigger:'#stats-row',start:'top 85%'}
    }
  );

  // Work cards stagger
  gsap.fromTo('.work-card',
    {opacity:0, y:40, scale:.96},
    {opacity:1, y:0, scale:1, duration:.7, stagger:.1, ease:'power2.out',
      scrollTrigger:{trigger:'.works-row',start:'top 85%'}
    }
  );
});

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// HEADER SHRINK ON SCROLL
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
window.addEventListener('scroll',()=>{
  const h = document.getElementById('site-header');
  if(window.scrollY > 60) h.classList.add('shrunk');
  else h.classList.remove('shrunk');
}, {passive:true});

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// COUNTER ANIMATION (IntersectionObserver)
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
(function(){
  const counters = document.querySelectorAll('.stat-num[data-target]');
  const obs = new IntersectionObserver(entries=>{
    entries.forEach(e=>{
      if(!e.isIntersecting) return;
      const el = e.target;
      const target = parseInt(el.getAttribute('data-target'));
      const dur = 1800;
      const start = Date.now();
      obs.unobserve(el);
      function step(){
        const p = Math.min(1,(Date.now()-start)/dur);
        const ease = 1-Math.pow(1-p,3);
        el.textContent = Math.floor(ease*target);
        if(p<1) requestAnimationFrame(step);
        else el.textContent = target + (target>=10?'+':'');
      }
      step();
    });
  },{threshold:.5});
  counters.forEach(c=>obs.observe(c));
})();

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// NAVIGATION
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function positionIndicator(linkEl){
  const ind=document.getElementById('nav-indicator');
  const nav=document.getElementById('main-nav');
  const lr=linkEl.getBoundingClientRect();
  const nr=nav.getBoundingClientRect();
  const targetLeft=lr.left-nr.left+16;
  const targetWidth=lr.width-32;
  ind.style.transition='none';
  const currentLeft=parseFloat(ind.style.left||targetLeft);
  ind.style.left=currentLeft+'px';
  ind.style.width=targetWidth+'px';
  requestAnimationFrame(()=>{
    ind.style.transition='left .38s cubic-bezier(.34,1.56,.64,1), width .28s cubic-bezier(.34,1.56,.64,1), transform .28s ease';
    ind.style.left=targetLeft+'px';
    ind.style.width=targetWidth+'px';
    ind.style.transform='scaleY(1.5)';
    setTimeout(()=>{ind.style.transform='scaleY(1)';},280);
  });
}
function initIndicator(){
  const active=document.querySelector('.nav-link.active');
  if(active) positionIndicator(active);
}
setTimeout(initIndicator,100);
window.addEventListener('resize',initIndicator);

function goTo(id,btn){
  const el=document.getElementById(id);
  if(el) el.scrollIntoView({behavior:'smooth'});
  if(btn){
    document.querySelectorAll('.nav-link').forEach(l=>l.classList.remove('active'));
    btn.classList.add('active');
    positionIndicator(btn);
  }
}

window.addEventListener('scroll',()=>{
  const sections=[{id:'home',nl:'nl-home'},{id:'about',nl:'nl-about'},{id:'works',nl:'nl-works'}];
  const scrollY=window.scrollY+100;
  let active=null;
  sections.forEach(s=>{ const el=document.getElementById(s.id); if(el&&el.offsetTop<=scrollY) active=s; });
  if(active){
    document.querySelectorAll('.nav-link').forEach(l=>l.classList.remove('active'));
    const nl=document.getElementById(active.nl);
    if(nl){ nl.classList.add('active'); positionIndicator(nl); }
  }
},{passive:true});

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// HAMBURGER
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function toggleDD(e){ e.stopPropagation(); document.getElementById('dd').classList.toggle('open'); }
function closeDD(){ document.getElementById('dd').classList.remove('open'); }
document.addEventListener('click',e=>{ if(!document.getElementById('hbg').contains(e.target)) closeDD(); });

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ACCORDION CARDS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function activateCard(id){
  ['ac1','ac2','ac3'].forEach(c=>{
    document.getElementById(c).classList.toggle('active',c===id);
  });
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// SCROLL REVEAL
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const revealObs=new IntersectionObserver(entries=>{
  entries.forEach(e=>{ if(e.isIntersecting) e.target.classList.add('visible'); });
},{threshold:.12});
document.querySelectorAll('.reveal').forEach(el=>revealObs.observe(el));

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// 3D CARD TILT
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
(function(){
  function addTilt(el){
    el.addEventListener('mousemove',e=>{
      if(!matchMedia('(hover:hover)').matches) return;
      const r=el.getBoundingClientRect();
      const x=(e.clientX-r.left)/r.width-.5;
      const y=(e.clientY-r.top)/r.height-.5;
      el.style.transform=`perspective(800px) rotateX(${-y*12}deg) rotateY(${x*12}deg) scale3d(1.02,1.02,1.02)`;
    });
    el.addEventListener('mouseleave',()=>{
      el.style.transform='perspective(800px) rotateX(0deg) rotateY(0deg) scale3d(1,1,1)';
    });
  }
  document.querySelectorAll('.work-card').forEach(addTilt);
})();

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// MAGNETIC BUTTON EFFECT
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
document.querySelectorAll('.btn-p, .btn-signup, .chat-send').forEach(btn=>{
  btn.addEventListener('mousemove',e=>{
    const r=btn.getBoundingClientRect();
    const x=(e.clientX-r.left-r.width/2)*.3;
    const y=(e.clientY-r.top-r.height/2)*.3;
    btn.style.transform=`translateX(${x}px) translateY(${y}px)`;
  });
  btn.addEventListener('mouseleave',()=>{
    btn.style.transform='';
  });
});

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// SEARCH
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let st;
function handleSearch(v){
  clearTimeout(st); clearHL();
  if(!v.trim()) return;
  st=setTimeout(()=>{
    hlNode(document.body,v.trim());
    const f=document.querySelector('mark.hl');
    if(f) f.scrollIntoView({behavior:'smooth',block:'center'});
  },280);
}
function hlNode(n,q){
  if(n.nodeType===3){
    const i=n.nodeValue.toLowerCase().indexOf(q.toLowerCase());
    if(i>=0){
      const s=document.createElement('span');
      s.innerHTML=esc(n.nodeValue.slice(0,i))+`<mark class="hl">${esc(n.nodeValue.slice(i,i+q.length))}</mark>`+esc(n.nodeValue.slice(i+q.length));
      n.parentNode.replaceChild(s,n);
    }
  }else if(n.nodeType===1&&!['SCRIPT','STYLE','INPUT','TEXTAREA','CANVAS'].includes(n.tagName)){
    [...n.childNodes].forEach(c=>hlNode(c,q));
  }
}
function esc(t){ return t.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;'); }
function clearHL(){
  document.querySelectorAll('mark.hl').forEach(m=>m.parentNode.replaceChild(document.createTextNode(m.textContent),m));
}
document.addEventListener('click',e=>{
  if(!e.target.closest('.search-bar')&&!e.target.closest('mark.hl')){ clearHL(); document.getElementById('gsearch').value=''; }
});

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// NEWSLETTER
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function subscribeNewsletter(){
  const emailEl = document.getElementById('nl-email');
  const email = emailEl.value.trim();
  if(!/^[^\s@]+@[^\s@]+\.[^\s@]{2,}$/.test(email)){
    emailEl.style.borderColor='#ef4444';
    setTimeout(()=>emailEl.style.borderColor='',2000);
    return;
  }
  // Save to localStorage
  const subs = JSON.parse(localStorage.getItem('gba_subscribers')||'[]');
  if(!subs.includes(email)){
    subs.push(email);
    localStorage.setItem('gba_subscribers',JSON.stringify(subs));
  }
  const success = document.getElementById('nl-success');
  success.style.display='block';
  emailEl.value='';
  gsap.fromTo(success,{opacity:0,y:10},{opacity:1,y:0,duration:.4});
}

// â”€â”€ Toast helper â”€â”€
function showToast(icon, msg, duration=3500){
  const toast=document.getElementById('gba-toast');
  document.getElementById('gba-toast-icon').textContent=icon;
  document.getElementById('gba-toast-msg').textContent=msg;
  toast.classList.add('show');
  clearTimeout(toast._t);
  toast._t=setTimeout(()=>toast.classList.remove('show'), duration);
}

// Social Auth notice (legacy)
function socialAuthNotice(provider){
  showToast('â„¹ï¸',`${provider} OAuth requires a backend server`);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// LIVE SUPPORT CHAT SYSTEM
// Uses localStorage as a real-time message bus between tabs.
// Admin replies in the Admin Panel â€” client sees them instantly.
// Polling every 1.5s checks for new messages from the other side.
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const CHAT = {
  STORAGE_KEY: '_gba_chat_rooms',   // all chat sessions
  NOTIF_KEY:   '_gba_chat_notif',   // new-message notification flag
  POLL_MS:     1500,                 // polling interval
};

let _chatOpen = false;
let _chatPollTimer = null;
let _chatSessionId = null;          // this client's unique chat session
let _admSelectedSession = null;     // which session admin is viewing
let _lastMsgCount = 0;

// Get or create a session ID for this browser tab
function getChatSessionId(){
  if(_chatSessionId) return _chatSessionId;
  let sid = sessionStorage.getItem('_gba_chat_sid');
  if(!sid){ sid = 'chat_' + Date.now() + '_' + Math.random().toString(36).slice(2,8); sessionStorage.setItem('_gba_chat_sid',sid); }
  _chatSessionId = sid;
  return sid;
}

function getChatRooms(){
  try{ return JSON.parse(localStorage.getItem(CHAT.STORAGE_KEY)||'{}'); }
  catch{ return {}; }
}
function saveChatRooms(rooms){ localStorage.setItem(CHAT.STORAGE_KEY, JSON.stringify(rooms)); }

function getMyRoom(){
  const sid = getChatSessionId();
  const rooms = getChatRooms();
  return rooms[sid] || {sid, name:'Guest', msgs:[], unreadAdmin:0, active:true, lastTs:Date.now()};
}
function saveMyRoom(room){
  const sid = getChatSessionId();
  const rooms = getChatRooms();
  rooms[sid] = room;
  saveChatRooms(rooms);
}

// â”€â”€ Chat drag-and-drop â”€â”€
(function(){
  function initChatDrop(){
    const win = document.getElementById('chat-window');
    if(!win) return;
    let dragCount = 0;
    win.addEventListener('dragenter', e=>{ e.preventDefault(); dragCount++; win.classList.add('drag-over'); }, false);
    win.addEventListener('dragleave', e=>{ e.preventDefault(); dragCount--; if(dragCount<=0){dragCount=0;win.classList.remove('drag-over');} }, false);
    win.addEventListener('dragover',  e=>{ e.preventDefault(); }, false);
    win.addEventListener('drop', e=>{
      e.preventDefault(); dragCount=0; win.classList.remove('drag-over');
      const isLoggedIn = !!sessionStorage.getItem('_g$st');
      if(!isLoggedIn){ showToast('ğŸ”','Please log in to send files'); return; }
      const files = Array.from(e.dataTransfer.files);
      files.forEach(f=>{
        if(f.size > 15*1024*1024){ showToast('âš ï¸', f.name+' is too large (max 15MB)'); return; }
        const reader = new FileReader();
        reader.onload = ev=>{
          _chatStagedFiles.push({ name:f.name, size:f.size, type:f.type, data:ev.target.result });
          renderChatFilePreviewBar();
        };
        reader.readAsDataURL(f);
      });
    }, false);
  }
  // Init after DOM ready
  if(document.readyState==='loading') document.addEventListener('DOMContentLoaded', initChatDrop);
  else initChatDrop();
})();

function toggleChat(){
  _chatOpen = !_chatOpen;
  const win = document.getElementById('chat-window');
  win.classList.toggle('open', _chatOpen);
  if(_chatOpen){
    // Update auth gate visibility
    updateChatAuthGate();
    // Clear notif
    document.getElementById('chat-notif').classList.remove('show');
    // Mark admin messages as read
    const room = getMyRoom();
    room.unreadClient = 0;
    saveMyRoom(room);
    renderChatMessages();
    startChatPolling();
    const inputEl=document.getElementById('chat-input');
    const isLoggedIn=!!sessionStorage.getItem('_g$st');
    if(isLoggedIn && inputEl) setTimeout(()=>inputEl.focus(),100);
  } else {
    stopChatPolling();
  }
}

// Staged files waiting to send
let _chatStagedFiles = [];

function handleChatFileSelect(e){
  const files = Array.from(e.target.files);
  e.target.value = ''; // reset so same file can be re-selected
  files.forEach(f => {
    // Cap at 15MB per file
    if(f.size > 15 * 1024 * 1024){
      showToast('âš ï¸', f.name + ' is too large (max 15MB)'); return;
    }
    const reader = new FileReader();
    reader.onload = ev => {
      _chatStagedFiles.push({ name: f.name, size: f.size, type: f.type, data: ev.target.result });
      renderChatFilePreviewBar();
    };
    reader.readAsDataURL(f);
  });
}

function renderChatFilePreviewBar(){
  const bar = document.getElementById('chat-file-preview-bar');
  if(!bar) return;
  if(_chatStagedFiles.length === 0){ bar.style.display = 'none'; bar.innerHTML = ''; return; }
  bar.style.display = 'flex';
  bar.innerHTML = '';
  _chatStagedFiles.forEach((f, i) => {
    const pill = document.createElement('div');
    pill.style.cssText = 'display:flex;align-items:center;gap:6px;background:var(--card-bg);border:1px solid var(--border-strong);border-radius:20px;padding:4px 10px 4px 8px;font-size:11px;max-width:160px;';
    const icon = _chatFileIcon(f.type, f.name);
    pill.innerHTML = `<span style="font-size:14px;">${icon}</span><span style="flex:1;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;color:var(--text);">${_escHtml(f.name)}</span>`;
    const rm = document.createElement('button');
    rm.textContent = 'âœ•';
    rm.style.cssText = 'background:none;border:none;cursor:pointer;color:var(--text-muted);font-size:12px;padding:0;margin-left:2px;flex-shrink:0;';
    rm.onclick = () => { _chatStagedFiles.splice(i, 1); renderChatFilePreviewBar(); };
    pill.appendChild(rm);
    bar.appendChild(pill);
  });
}

function _chatFileIcon(mime, name){
  if(mime.startsWith('image/')) return 'ğŸ–¼ï¸';
  if(mime.startsWith('video/')) return 'ğŸ¬';
  const ext = (name||'').split('.').pop().toLowerCase();
  if(['html','htm'].includes(ext)) return 'ğŸŒ';
  if(['pdf'].includes(ext)) return 'ğŸ“„';
  if(['doc','docx'].includes(ext)) return 'ğŸ“';
  if(['xls','xlsx','csv'].includes(ext)) return 'ğŸ“Š';
  if(['ppt','pptx'].includes(ext)) return 'ğŸ“Š';
  if(['zip','rar','7z'].includes(ext)) return 'ğŸ—œï¸';
  if(['js','json','css'].includes(ext)) return 'âš™ï¸';
  if(['txt','md'].includes(ext)) return 'ğŸ“‹';
  return 'ğŸ“';
}

function _fmtFileSize(bytes){
  if(bytes < 1024) return bytes + ' B';
  if(bytes < 1024*1024) return (bytes/1024).toFixed(1) + ' KB';
  return (bytes/(1024*1024)).toFixed(1) + ' MB';
}

function sendChatMsg(){
  const input = document.getElementById('chat-input');
  const text = input.value.trim();
  const hasFiles = _chatStagedFiles.length > 0;
  if(!text && !hasFiles) return;
  input.value=''; input.style.height='';

  const room = getMyRoom();
  const _sess = _currentSession;
  if(_sess) room.name = _sess.name || 'User';

  // Send text message first if any
  if(text){
    room.msgs.push({ from:'user', name:room.name, text, ts:Date.now() });
  }

  // Send each file as its own message
  _chatStagedFiles.forEach(f => {
    room.msgs.push({
      from: 'user',
      name: room.name,
      text: '',
      ts: Date.now(),
      file: { name: f.name, size: f.size, type: f.type, data: f.data }
    });
  });

  _chatStagedFiles = [];
  renderChatFilePreviewBar();

  room.unreadAdmin = (room.unreadAdmin||0) + 1;
  room.lastTs = Date.now();
  room.active = true;
  saveMyRoom(room);
  renderChatMessages();
  localStorage.setItem(CHAT.NOTIF_KEY, Date.now().toString());
}

function chatKeydown(e){
  if(e.key==='Enter' && !e.shiftKey){ e.preventDefault(); sendChatMsg(); }
}

function autoResizeChatInput(el){
  el.style.height='auto';
  el.style.height=Math.min(el.scrollHeight,80)+'px';
}

function _buildFileBubble(file){
  const wrap = document.createElement('div');
  wrap.className = 'chat-file-bubble';

  const isImage = file.type && file.type.startsWith('image/');
  const isVideo = file.type && file.type.startsWith('video/');
  const ext = (file.name||'').split('.').pop().toLowerCase();
  const isHTML = ['html','htm'].includes(ext);

  if(isImage){
    const img = document.createElement('img');
    img.src = file.data;
    img.alt = file.name;
    img.style.cursor = 'pointer';
    img.onclick = () => _chatOpenLightbox(file.data, file.name);
    wrap.appendChild(img);
  } else if(isVideo){
    const vid = document.createElement('video');
    vid.src = file.data;
    vid.controls = true;
    vid.preload = 'metadata';
    wrap.appendChild(vid);
  }

  // File info row (shown for all types, below media if applicable)
  const info = document.createElement('div');
  info.className = 'chat-file-info';

  const icon = document.createElement('span');
  icon.className = 'chat-file-icon';
  icon.textContent = _chatFileIcon(file.type, file.name);

  const nameEl = document.createElement('span');
  nameEl.className = 'chat-file-name';
  nameEl.textContent = file.name;
  nameEl.title = file.name;

  const sizeEl = document.createElement('span');
  sizeEl.className = 'chat-file-size';
  sizeEl.textContent = _fmtFileSize(file.size);

  // Download / open link
  const dl = document.createElement('a');
  dl.className = 'chat-file-dl';
  dl.href = file.data;
  dl.download = file.name;
  dl.textContent = isHTML ? 'ğŸŒ Open' : 'â†“ Save';
  if(isHTML){
    // Open HTML in new tab as blob
    dl.onclick = e => {
      e.preventDefault();
      const blob = _dataURLtoBlob(file.data);
      const url = URL.createObjectURL(blob);
      window.open(url, '_blank');
    };
  }

  info.appendChild(icon);
  info.appendChild(nameEl);
  info.appendChild(sizeEl);
  info.appendChild(dl);
  wrap.appendChild(info);
  return wrap;
}

function _chatOpenLightbox(src, name){
  const lb = document.createElement('div');
  lb.style.cssText = 'position:fixed;inset:0;z-index:99999;background:rgba(0,0,0,.92);display:flex;flex-direction:column;align-items:center;justify-content:center;gap:12px;cursor:zoom-out;';
  lb.onclick = () => document.body.removeChild(lb);
  const img = document.createElement('img');
  img.src = src;
  img.style.cssText = 'max-width:90vw;max-height:80vh;border-radius:12px;object-fit:contain;box-shadow:0 24px 80px rgba(0,0,0,.8);';
  const caption = document.createElement('div');
  caption.textContent = name;
  caption.style.cssText = 'color:rgba(255,255,255,.6);font-size:12px;font-family:Jost,sans-serif;';
  lb.appendChild(img);
  lb.appendChild(caption);
  document.body.appendChild(lb);
}

function _dataURLtoBlob(dataURL){
  const [header, data] = dataURL.split(',');
  const mime = header.match(/:(.*?);/)[1];
  const bin = atob(data);
  const arr = new Uint8Array(bin.length);
  for(let i=0;i<bin.length;i++) arr[i] = bin.charCodeAt(i);
  return new Blob([arr], {type: mime});
}

function renderChatMessages(){
  const room = getMyRoom();
  const container = document.getElementById('chat-messages');
  const empty = document.getElementById('chat-empty');
  
  if(room.msgs.length===0){
    empty.style.display='block';
    // Show welcome message
    container.innerHTML='';
    container.appendChild(empty);
    return;
  }
  
  empty.style.display='none';
  const msgs = room.msgs;
  
  // Only re-render if count changed
  if(msgs.length === _lastMsgCount && !document.getElementById('admin-panel')?.classList.contains('open')) return;
  _lastMsgCount = msgs.length;
  
  container.innerHTML='';
  
  // System message
  const sysEl = document.createElement('div');
  sysEl.className = 'chat-sys';
  sysEl.textContent = 'Chat session started';
  container.appendChild(sysEl);
  
  msgs.forEach(msg=>{
    const isMe = msg.from==='user';
    const wrapper = document.createElement('div');
    wrapper.className = 'chat-msg' + (isMe?' mine':'');

    const time = document.createElement('div');
    time.className = 'chat-time';
    time.textContent = new Date(msg.ts).toLocaleTimeString([],{hour:'2-digit',minute:'2-digit'});

    const avatarEl = document.createElement('div');
    avatarEl.className = 'chat-msg-avatar';
    avatarEl.textContent = isMe ? 'ğŸ‘¤' : 'âœ¨';

    let contentEl;
    if(msg.file){
      contentEl = _buildFileBubble(msg.file);
    } else {
      contentEl = document.createElement('div');
      contentEl.className = 'chat-bubble';
      contentEl.textContent = msg.text;
    }

    if(isMe){
      wrapper.appendChild(time);
      wrapper.appendChild(contentEl);
      wrapper.appendChild(avatarEl);
    } else {
      wrapper.appendChild(avatarEl);
      wrapper.appendChild(contentEl);
      wrapper.appendChild(time);
    }
    container.appendChild(wrapper);
  });
  
  // Scroll to bottom
  container.scrollTop=container.scrollHeight;
}

function startChatPolling(){
  stopChatPolling();
  _chatPollTimer = setInterval(()=>{
    // Check for new admin replies
    const room = getMyRoom();
    const prevCount = _lastMsgCount;
    if(room.msgs.length !== prevCount) renderChatMessages();
    
    // Check for new messages when chat is closed
    if(!_chatOpen && (room.unreadClient||0)>0){
      document.getElementById('chat-notif').classList.add('show');
      document.getElementById('chat-notif').textContent = room.unreadClient;
    }
  }, CHAT.POLL_MS);
}
function stopChatPolling(){ clearInterval(_chatPollTimer); }

// Start passive polling for notifications even when chat closed
setInterval(()=>{
  if(_chatOpen) return;
  const room = getMyRoom();
  if((room.unreadClient||0)>0){
    const notif = document.getElementById('chat-notif');
    notif.classList.add('show');
    notif.textContent = room.unreadClient;
  }
}, 2000);

// â”€â”€ ADMIN CHAT functions â”€â”€
function renderAdminChatList(){
  const rooms = getChatRooms();
  const listEl = document.getElementById('adm-chat-list-items');
  const noChats = document.getElementById('adm-no-chats');
  const keys = Object.keys(rooms);
  
  if(keys.length===0){
    listEl.innerHTML=''; noChats.style.display='block'; return;
  }
  noChats.style.display='none';
  
  // Sort by lastTs desc
  keys.sort((a,b)=>(rooms[b].lastTs||0)-(rooms[a].lastTs||0));
  
  listEl.innerHTML='';
  keys.forEach(sid=>{
    const room = rooms[sid];
    if(!room.msgs||room.msgs.length===0) return;
    const lastMsg = room.msgs[room.msgs.length-1];
    const unread = room.unreadAdmin||0;
    
    const item = document.createElement('div');
    item.className = 'adm-chat-item' + (sid===_admSelectedSession?' active':'');
    item.onclick = ()=>selectAdminChatSession(sid);
    item.innerHTML = `
      <div class="adm-chat-item-dot ${room.active?'':'offline'}"></div>
      <div style="flex:1;overflow:hidden;">
        <div class="adm-chat-item-name">${_escHtml(room.name||'Guest')}</div>
        <div class="adm-chat-item-preview">${lastMsg?.file ? (_chatFileIcon(lastMsg.file.type, lastMsg.file.name)+' '+_escHtml(lastMsg.file.name)) : _escHtml(lastMsg?.text||'...')}</div>
      </div>
      ${unread>0?`<div class="adm-chat-item-unread">${unread}</div>`:''}
    `;
    listEl.appendChild(item);
  });
}

function selectAdminChatSession(sid){
  _admSelectedSession = sid;
  
  // Clear unread count for this session
  const rooms = getChatRooms();
  if(rooms[sid]){ rooms[sid].unreadAdmin=0; saveChatRooms(rooms); }
  
  renderAdminChatList();
  renderAdminChatPane(sid);
}

function renderAdminChatPane(sid){
  const rooms = getChatRooms();
  const room = rooms[sid];
  
  document.getElementById('adm-chat-placeholder').style.display='none';
  const pane = document.getElementById('adm-chat-pane');
  pane.style.display='flex';
  pane.style.flexDirection='column';
  
  document.getElementById('adm-chat-pane-header').innerHTML=`
    <div class="chat-avatar" style="width:28px;height:28px;font-size:13px;">ğŸ‘¤</div>
    <div style="flex:1;">
      <div style="font-size:13px;font-weight:500;">${_escHtml(room?.name||'Guest')}</div>
      <div style="font-size:11px;color:var(--text-muted);">${sid} Â· ${room?.msgs?.length||0} messages</div>
    </div>
    <button class="adm-btn neutral" onclick="endAdminChat('${sid}')" style="font-size:11px;padding:5px 10px;">End Chat</button>
  `;
  
  const msgsEl = document.getElementById('adm-chat-pane-msgs');
  msgsEl.innerHTML='';
  (room?.msgs||[]).forEach(msg=>{
    const isUser = msg.from==='user';
    const wrapper=document.createElement('div');
    wrapper.className='chat-msg'+(isUser?'':' mine');

    const avatar=document.createElement('div');
    avatar.className='chat-msg-avatar';
    avatar.textContent=isUser?'ğŸ‘¤':'âœ¨';

    let contentEl;
    if(msg.file){
      contentEl = _buildFileBubble(msg.file);
    } else {
      contentEl = document.createElement('div');
      contentEl.className = 'chat-bubble';
      contentEl.textContent = msg.text;
    }

    const timeEl=document.createElement('div');
    timeEl.className='chat-time';
    timeEl.textContent=new Date(msg.ts).toLocaleTimeString([],{hour:'2-digit',minute:'2-digit'});

    if(isUser){
      wrapper.appendChild(avatar);
      wrapper.appendChild(contentEl);
      wrapper.appendChild(timeEl);
    } else {
      wrapper.appendChild(timeEl);
      wrapper.appendChild(contentEl);
      wrapper.appendChild(avatar);
    }
    msgsEl.appendChild(wrapper);
  });
  msgsEl.scrollTop=msgsEl.scrollHeight;
}

function admChatKeydown(e){
  if(e.key==='Enter') admSendReply();
}

function admSendReply(){
  if(!_admSelectedSession) return;
  const input = document.getElementById('adm-chat-reply-input');
  const text = input.value.trim();
  if(!text) return;
  input.value='';
  
  const rooms = getChatRooms();
  const room = rooms[_admSelectedSession];
  if(!room) return;
  
  room.msgs.push({
    from:'admin',
    name:'GBA Support',
    text,
    ts:Date.now()
  });
  room.unreadClient = (room.unreadClient||0)+1;
  room.lastTs=Date.now();
  saveChatRooms(rooms);
  
  renderAdminChatList();
  renderAdminChatPane(_admSelectedSession);
  _auditLog('chat',`Admin replied to session ${_admSelectedSession}`);
}

function endAdminChat(sid){
  const rooms = getChatRooms();
  if(rooms[sid]){ rooms[sid].active=false; saveChatRooms(rooms); }
  _admSelectedSession=null;
  document.getElementById('adm-chat-placeholder').style.display='flex';
  document.getElementById('adm-chat-pane').style.display='none';
  renderAdminChatList();
}

// Poll admin chat when panel is open
setInterval(()=>{
  const panel = document.getElementById('admin-panel');
  if(panel.classList.contains('open') && document.getElementById('adm-chat').classList.contains('active')){
    renderAdminChatList();
    if(_admSelectedSession) renderAdminChatPane(_admSelectedSession);
  }
}, 1500);

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// GBA AUTH FORTRESS â€” v4 (preserved from v3)
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const EJS_PUBLIC_KEY  = 'h6B8TrwasfBC3Qjd8';
const EJS_SERVICE_ID  = 'service_0e2hicm';
const EJS_TEMPLATE_ID = 'template_j43ylzj';
let _ejsReady = false;
let _ejsQueue = []; // queued sends before library loaded

const _s = document.createElement('script');
_s.src = 'https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js';
_s.onload = () => {
  emailjs.init(EJS_PUBLIC_KEY);
  _ejsReady = true;
  // Flush any sends that arrived before the script loaded
  _ejsQueue.forEach(fn => fn());
  _ejsQueue = [];
};
_s.onerror = () => console.error('[GBA] EmailJS failed to load');
document.head.appendChild(_s);

const SEC={
  CODE_TTL:3*60*1000, RESEND_DELAY:30, MAX_ATTEMPTS:5,
  LOCKOUT_BASE_MS:15*60*1000, SESSION_TTL:8*60*60*1000,
  PBKDF2_ITERS:310000, PBKDF2_HASH:'SHA-256', KEY_LENGTH:256,
  S_USERS:'_g$u', S_SESSION:'_g$s', S_ATTS:'_g$a_', S_VAULT_K:'_g$k',
  GLOBAL_WINDOW_MS:60*1000, GLOBAL_MAX_OPS:10,
};

const Vault=(()=>{
  let _masterKey=null;
  function _b64ToBytes(b64){return Uint8Array.from(atob(b64),c=>c.charCodeAt(0));}
  function _bytesToB64(bytes){return btoa(String.fromCharCode(...bytes));}
  async function _ensureKey(){
    if(_masterKey) return _masterKey;
    const stored=localStorage.getItem(SEC.S_VAULT_K);
    if(stored){
      try{
        const raw=_b64ToBytes(stored);
        _masterKey=await crypto.subtle.importKey('raw',raw,{name:'AES-GCM'},false,['encrypt','decrypt']);
        return _masterKey;
      }catch(e){}
    }
    _masterKey=await crypto.subtle.generateKey({name:'AES-GCM',length:256},true,['encrypt','decrypt']);
    const exported=await crypto.subtle.exportKey('raw',_masterKey);
    localStorage.setItem(SEC.S_VAULT_K,_bytesToB64(new Uint8Array(exported)));
    return _masterKey;
  }
  async function encrypt(data){
    const key=await _ensureKey();
    const iv=crypto.getRandomValues(new Uint8Array(12));
    const encoded=new TextEncoder().encode(JSON.stringify(data));
    const ciphertext=await crypto.subtle.encrypt({name:'AES-GCM',iv},key,encoded);
    const combined=new Uint8Array(12+ciphertext.byteLength);
    combined.set(iv,0); combined.set(new Uint8Array(ciphertext),12);
    return _bytesToB64(combined);
  }
  async function decrypt(b64){
    const key=await _ensureKey();
    const combined=_b64ToBytes(b64);
    const iv=combined.slice(0,12), ciphertext=combined.slice(12);
    const decrypted=await crypto.subtle.decrypt({name:'AES-GCM',iv},key,ciphertext);
    return JSON.parse(new TextDecoder().decode(decrypted));
  }
  async function get(lsKey){try{const raw=localStorage.getItem(lsKey);if(!raw) return null;return await decrypt(raw);}catch{return null;}}
  async function set(lsKey,data){try{const enc=await encrypt(data);localStorage.setItem(lsKey,enc);return true;}catch{return false;}}
  function del(lsKey){localStorage.removeItem(lsKey);}
  return{get,set,del};
})();

function _bytesToB64(bytes){return btoa(String.fromCharCode(...bytes));}
function _b64ToBytes(b64){return Uint8Array.from(atob(b64),c=>c.charCodeAt(0));}
function _validateEmail(email){return /^[^\s@]+@[^\s@]+\.[^\s@]{2,}$/.test(email);}
function _validatePassword(pass){
  const issues=[];
  if(pass.length<10) issues.push('at least 10 characters');
  if(!/[A-Z]/.test(pass)) issues.push('an uppercase letter');
  if(!/[a-z]/.test(pass)) issues.push('a lowercase letter');
  if(!/[0-9]/.test(pass)) issues.push('a number');
  if(!/[^A-Za-z0-9]/.test(pass)) issues.push('a special character');
  return issues;
}
function _timingSafeEqual(a,b){
  if(typeof a!=='string'||typeof b!=='string') return false;
  const la=a.length,lb=b.length;let result=la^lb;
  const len=Math.min(la,lb);
  for(let i=0;i<len;i++) result|=a.charCodeAt(i)^b.charCodeAt(i);
  return result===0;
}
function _simpleHash(str){
  let h=0;for(let i=0;i<str.length;i++){h=(Math.imul(31,h)+str.charCodeAt(i))|0;}return Math.abs(h).toString(36);
}

async function _pbkdf2Hash(password,saltBytes){
  const enc=new TextEncoder().encode(password);
  const km=await crypto.subtle.importKey('raw',enc,{name:'PBKDF2'},false,['deriveBits']);
  const bits=await crypto.subtle.deriveBits({name:'PBKDF2',hash:SEC.PBKDF2_HASH,salt:saltBytes,iterations:SEC.PBKDF2_ITERS},km,SEC.KEY_LENGTH);
  return _bytesToB64(new Uint8Array(bits));
}
async function _hashNewPassword(password){
  const salt=crypto.getRandomValues(new Uint8Array(16));
  const hash=await _pbkdf2Hash(password,salt);
  return{hash,salt:_bytesToB64(salt)};
}
async function _verifyPassword(password,storedHash,storedSaltB64){
  const salt=_b64ToBytes(storedSaltB64);
  const hash=await _pbkdf2Hash(password,salt);
  return _timingSafeEqual(hash,storedHash);
}

async function _signSession(payload){
  const keyBytes=await _getOrCreateHmacKey();
  const key=await crypto.subtle.importKey('raw',keyBytes,{name:'HMAC',hash:'SHA-256'},false,['sign']);
  const data=JSON.stringify(payload);
  const sig=await crypto.subtle.sign('HMAC',key,new TextEncoder().encode(data));
  return{data,sig:_bytesToB64(new Uint8Array(sig))};
}
async function _verifySession(token){
  try{
    if(!token||!token.data||!token.sig) return null;
    const keyBytes=await _getOrCreateHmacKey();
    const key=await crypto.subtle.importKey('raw',keyBytes,{name:'HMAC',hash:'SHA-256'},false,['verify']);
    const sigBytes=_b64ToBytes(token.sig);
    const valid=await crypto.subtle.verify('HMAC',key,sigBytes,new TextEncoder().encode(token.data));
    if(!valid) return null;
    const payload=JSON.parse(token.data);
    if(Date.now()>payload.exp) return null;
    return payload;
  }catch{return null;}
}
async function _getOrCreateHmacKey(){
  // Store HMAC key ONLY in localStorage (NOT sessionStorage) so it persists across tabs/reloads
  // Never delete this key on logout â€” it's a device key, not a user key
  const stored=localStorage.getItem('_g$hk');
  if(stored){ return _b64ToBytes(stored); }
  const key=crypto.getRandomValues(new Uint8Array(32));
  localStorage.setItem('_g$hk',_bytesToB64(key));
  return key;
}

async function _deviceFingerprint(){
  const components=[navigator.userAgent,navigator.language,screen.colorDepth,screen.width+'x'+screen.height,Intl.DateTimeFormat().resolvedOptions().timeZone,navigator.hardwareConcurrency||0].join('|');
  const enc=new TextEncoder().encode(components);
  const hash=await crypto.subtle.digest('SHA-256',enc);
  return _bytesToB64(new Uint8Array(hash)).slice(0,32);
}

const _globalOps={count:0,windowStart:Date.now()};
function _checkGlobalRateLimit(){
  const now=Date.now();
  if(now-_globalOps.windowStart>SEC.GLOBAL_WINDOW_MS){_globalOps.count=0;_globalOps.windowStart=now;}
  if(_globalOps.count>=SEC.GLOBAL_MAX_OPS) return false;
  _globalOps.count++; return true;
}
async function _getAttempts(email){const data=await Vault.get(SEC.S_ATTS+_simpleHash(email));return data||{count:0,lockUntil:0};}
async function _recordFailedAttempt(email){
  const d=await _getAttempts(email); d.count++;
  if(d.count>=SEC.MAX_ATTEMPTS){const mul=Math.pow(2,Math.floor(d.count/SEC.MAX_ATTEMPTS)-1);d.lockUntil=Date.now()+SEC.LOCKOUT_BASE_MS*mul;}
  await Vault.set(SEC.S_ATTS+_simpleHash(email),d); return d;
}
async function _clearAttempts(email){Vault.del(SEC.S_ATTS+_simpleHash(email));}
async function _antiEnumerationDelay(){const ms=80+Math.floor(Math.random()*100);return new Promise(r=>setTimeout(r,ms));}

let _OTP=Object.seal({su_code:null,su_expiry:null,su_used:false,li_code:null,li_expiry:null,li_used:false});
let _pendingUser=null,_pendingLogin=null;
let _suExpiryTimer=null,_liExpiryTimer=null,_suResendTimer=null,_liResendTimer=null;
let _currentSession=null;

function _generateOTP(){
  let val;const arr=new Uint32Array(1);
  do{crypto.getRandomValues(arr);val=arr[0];}while(val>=4294900000);
  return String(100000+(val%900000));
}
function _wipeOTPState(which){
  if(which==='su'){_OTP.su_code=null;_OTP.su_expiry=null;_OTP.su_used=false;if(_suExpiryTimer)clearTimeout(_suExpiryTimer);if(_suResendTimer)clearInterval(_suResendTimer);}
  else{_OTP.li_code=null;_OTP.li_expiry=null;_OTP.li_used=false;if(_liExpiryTimer)clearTimeout(_liExpiryTimer);if(_liResendTimer)clearInterval(_liResendTimer);}
}
// Full reset of all OTP state â€” called on logout and panel close to guarantee clean slate
function _resetOTPState(){_wipeOTPState('su');_wipeOTPState('li');}

function _sendCode(email, name, code){
  const params = {
    to_email: email,
    to_name:  name,
    code:     code,
    // Include common alternative param names so it works regardless of template setup
    user_email: email,
    user_name:  name,
    otp:        code,
    passcode:   code,
    message:    'Your GBA verification code is: ' + code
  };
  const doSend = () => {
    emailjs.send(EJS_SERVICE_ID, EJS_TEMPLATE_ID, params)
      .then(() => console.log('[GBA] Verification email sent to', email))
      .catch(err => console.error('[GBA] EmailJS send failed:', err));
  };
  if(_ejsReady){
    doSend();
  } else {
    // Library still loading â€” queue it
    _ejsQueue.push(doSend);
  }
}

function _startExpiryCountdown(elId,onExpire){
  const el=document.getElementById(elId);let remaining=Math.floor(SEC.CODE_TTL/1000);
  function tick(){const m=Math.floor(remaining/60),s=remaining%60;el.textContent=m+':'+(s<10?'0':'')+s;if(remaining<=0){el.textContent='0:00';el.style.color='#ef4444';if(onExpire)onExpire();return;}remaining--;return setTimeout(tick,1000);}
  el.style.color='var(--primary)';return tick();
}
function _startResendCountdown(btnId,cdId){
  const btn=document.getElementById(btnId),cd=document.getElementById(cdId);
  btn.disabled=true;let s=SEC.RESEND_DELAY;
  const t=setInterval(()=>{s--;cd.textContent='('+s+'s)';if(s<=0){clearInterval(t);btn.disabled=false;cd.textContent='';}},1000);
  cd.textContent='('+SEC.RESEND_DELAY+'s)'; return t;
}

function checkStrength(val){
  const wrap=document.getElementById('strength-bar-wrap'),lbl=document.getElementById('strength-label');
  if(!val){wrap.style.display='none';return;}wrap.style.display='block';
  let score=0;
  if(val.length>=8)score++;if(val.length>=12)score++;
  if(/[A-Z]/.test(val)&&/[a-z]/.test(val))score++;if(/[0-9]/.test(val))score++;if(/[^A-Za-z0-9]/.test(val))score++;
  const colors=['#ef4444','#f97316','#eab308','#84cc16','#22c55e'];
  const texts=['Very weak','Weak','Fair','Strong','Very strong! ğŸ”¥'];
  const dots=document.querySelectorAll('.strength-dot');
  dots.forEach((d,i)=>{ d.style.background = i<score ? colors[Math.min(score-1,4)] : 'var(--border-strong)'; });
  if(lbl){lbl.textContent=texts[Math.min(score,4)];lbl.style.color=colors[Math.min(score-1,4)]||'var(--text-muted)';}
}

// â”€â”€ Password visibility toggle â”€â”€
function togglePw(inputId, btn){
  const inp=document.getElementById(inputId);
  const isHidden=inp.type==='password';
  inp.type=isHidden?'text':'password';
  const svg=btn.querySelector('svg');
  if(isHidden){
    // Show "eye-off" icon
    svg.innerHTML='<path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94"/><path d="M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19"/><line x1="1" y1="1" x2="23" y2="23"/>';
  } else {
    // Show "eye" icon
    svg.innerHTML='<path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/><circle cx="12" cy="12" r="3"/>';
  }
}

// â”€â”€ DOB â†’ Age auto-calculator â”€â”€
// â”€â”€ DOB Slider System â”€â”€
const _MONTHS = ['January','February','March','April','May','June','July','August','September','October','November','December'];
const _DAYS_IN_MONTH = [31,29,28,31,30,31,30,31,31,30,31,30,31]; // index 0 unused, 1-12

function updateDOBSliders(){
  const dayEl   = document.getElementById('su-dob-day');
  const monthEl = document.getElementById('su-dob-month');
  const yearEl  = document.getElementById('su-dob-year');
  if(!dayEl||!monthEl||!yearEl) return;

  const month = parseInt(monthEl.value);
  const year  = parseInt(yearEl.value);

  // Clamp day max to actual days in selected month/year
  const isLeap = (year%4===0&&year%100!==0)||(year%400===0);
  const maxDay = month===2 ? (isLeap?29:28) : _DAYS_IN_MONTH[month];
  dayEl.max = maxDay;
  if(parseInt(dayEl.value) > maxDay) dayEl.value = maxDay;

  const day = parseInt(dayEl.value);

  // Update display labels
  document.getElementById('dob-day-val').textContent   = day;
  document.getElementById('dob-month-val').textContent = _MONTHS[month-1];
  document.getElementById('dob-year-val').textContent  = year;

  // Summary
  document.getElementById('dob-summary').textContent = _MONTHS[month-1]+' '+day+', '+year;

  // Calculate age
  const today = new Date();
  let age = today.getFullYear() - year;
  const mDiff = today.getMonth()+1 - month;
  if(mDiff < 0 || (mDiff===0 && today.getDate() < day)) age--;
  document.getElementById('su-age-display').textContent = age >= 0 ? age+' years old' : '';

  // Update slider fill track
  _updateSliderFill(dayEl,   1, maxDay);
  _updateSliderFill(monthEl, 1, 12);
  _updateSliderFill(yearEl,  1924, 2011);

  // Write hidden dob value as YYYY-MM-DD
  const mm = String(month).padStart(2,'0');
  const dd = String(day).padStart(2,'0');
  const dobHidden = document.getElementById('su-dob');
  if(dobHidden) dobHidden.value = year+'-'+mm+'-'+dd;
}

function _updateSliderFill(slider, min, max){
  const pct = ((slider.value - min) / (max - min)) * 100;
  slider.style.background = `linear-gradient(to right, var(--primary) ${pct}%, var(--border-strong) ${pct}%)`;
}

function resetDOBSliders(){
  const dayEl   = document.getElementById('su-dob-day');
  const monthEl = document.getElementById('su-dob-month');
  const yearEl  = document.getElementById('su-dob-year');
  if(!dayEl||!monthEl||!yearEl) return;
  dayEl.value='1'; monthEl.value='1'; yearEl.value='2000';
  updateDOBSliders();
}

document.addEventListener('DOMContentLoaded',()=>{
  // Set year max to 13 years ago
  const yearEl = document.getElementById('su-dob-year');
  if(yearEl){
    yearEl.max = new Date().getFullYear() - 13;
    updateDOBSliders();
  }
});

// â”€â”€ Open auth overlay on specific tab â”€â”€
function openFSOnTab(tab){
  swTab(tab);
  openFS();
}

// â”€â”€ Chat auth gate visibility â”€â”€
function updateChatAuthGate(){
  const gate=document.getElementById('chat-auth-gate');
  const footer=document.getElementById('chat-footer-input');
  const session=sessionStorage.getItem('_g$st');
  const isLoggedIn=!!session;
  if(gate) gate.style.display=isLoggedIn?'none':'flex';
  if(footer) footer.style.display=isLoggedIn?'flex':'none';
}

async function suStep1(){
  const name=document.getElementById('su-name').value.trim();
  const email=document.getElementById('su-email').value.trim().toLowerCase();
  const pass=document.getElementById('su-pass').value;
  const agree=document.getElementById('su-agree').checked;
  const dob=document.getElementById('su-dob')?.value||'';
  const msg=document.getElementById('su-msg');
  msg.style.display='none';
  if(!_checkGlobalRateLimit()){msg.textContent='Too many requests. Please wait a moment.';msg.style.display='block';return;}
  if(!name||name.length<2){msg.textContent='Please enter your full name (at least 2 characters).';msg.style.display='block';return;}
  if(!_validateEmail(email)){msg.textContent='Please enter a valid email address.';msg.style.display='block';return;}
  // Age check (sliders always produce a value)
  {
    const birth=new Date(dob), today=new Date();
    let age=today.getFullYear()-birth.getFullYear();
    const m=today.getMonth()-birth.getMonth();
    if(m<0||(m===0&&today.getDate()<birth.getDate()))age--;
    if(age<13){msg.textContent='You must be at least 13 years old to create an account.';msg.style.display='block';return;}
  }
  const passIssues=_validatePassword(pass);
  if(passIssues.length>0){msg.textContent='Password requires: '+passIssues.join(', ')+'.';msg.style.display='block';return;}
  if(!agree){msg.textContent='You must agree to the terms and conditions.';msg.style.display='block';return;}
  // Update step indicator
  document.getElementById('su-sc-1')?.classList.add('done');document.getElementById('su-sc-1')&&(document.getElementById('su-sc-1').textContent='âœ“');
  document.getElementById('su-sl-1')?.classList.add('done');
  document.getElementById('su-sc-2')?.classList.add('active');
  await _antiEnumerationDelay();
  const users=await Vault.get(SEC.S_USERS)||{};
  if(users[_simpleHash(email)]){msg.textContent='An account with this email already exists.';msg.style.display='block';return;}
  const btn=document.querySelector('#su-step1 .btn-p');
  btn.disabled=true;btn.textContent='Securingâ€¦';
  const{hash,salt}=await _hashNewPassword(pass);
  btn.disabled=false;btn.textContent='Continue â†’';
  _pendingUser={name,email,hash,salt};
  _OTP.su_code=_generateOTP();_OTP.su_expiry=Date.now()+SEC.CODE_TTL;_OTP.su_used=false;
  _sendCode(email,name,_OTP.su_code);
  document.getElementById('su-sent-msg').textContent=`Verification code sent to ${email}. Check your inbox and spam folder.`;
  document.getElementById('su-step1').style.display='none';
  document.getElementById('su-step2').style.display='flex';
  if(_suExpiryTimer)clearTimeout(_suExpiryTimer);if(_suResendTimer)clearInterval(_suResendTimer);
  _suExpiryTimer=_startExpiryCountdown('su-expiry',()=>{_OTP.su_code=null;const m=document.getElementById('su-code-msg');m.textContent='Code expired. Please resend.';m.style.display='block';});
  _suResendTimer=_startResendCountdown('su-resend-btn','su-resend-cd');
}

async function suVerify(){
  const entered=document.getElementById('su-code').value.trim();
  const msg=document.getElementById('su-code-msg');msg.style.display='none';
  if(!_OTP.su_code||!_pendingUser){msg.textContent='Session expired. Please restart.';msg.style.color='#ef4444';msg.style.display='block';return;}
  if(_OTP.su_used){msg.textContent='This code has already been used.';msg.style.color='#ef4444';msg.style.display='block';return;}
  if(Date.now()>_OTP.su_expiry){_OTP.su_code=null;msg.textContent='Code expired. Please resend.';msg.style.color='#ef4444';msg.style.display='block';return;}
  await _antiEnumerationDelay();
  if(!_timingSafeEqual(entered,_OTP.su_code)){msg.textContent='Incorrect code. Please try again.';msg.style.color='#ef4444';msg.style.display='block';return;}
  _OTP.su_used=true;
  const users=await Vault.get(SEC.S_USERS)||{};
  const isOwner=_pendingUser.email==='amermirohiro@gmail.com';
  const dobVal=document.getElementById('su-dob')?.value||'';
  const ageVal=document.getElementById('su-age-display')?.textContent||'';
  const newUser={name:_pendingUser.name,email:_pendingUser.email,hash:_pendingUser.hash,salt:_pendingUser.salt,dob:dobVal,age:ageVal,created:Date.now()};
  if(isOwner) newUser.role='owner';
  users[_simpleHash(_pendingUser.email)]=newUser;
  await Vault.set(SEC.S_USERS,users);
  await _auditLog('signup',`New account: ${_pendingUser.name} (${_pendingUser.email})${isOwner?' â€” Owner':''}`);
  // Mark step 3 done
  document.getElementById('su-sc-2')?.classList.add('done');document.getElementById('su-sc-2')&&(document.getElementById('su-sc-2').textContent='âœ“');
  document.getElementById('su-sl-2')?.classList.add('done');
  document.getElementById('su-sc-3')?.classList.add('done','active');document.getElementById('su-sc-3')&&(document.getElementById('su-sc-3').textContent='âœ“');
  await _createSession(_pendingUser.email,_pendingUser.name);
  _pendingUser=null;_wipeOTPState('su');
  closeFS();updateAuthUI();
  showToast('ğŸ‰','Account created successfully! Welcome to GBA.');
  setTimeout(()=>{
    document.getElementById('su-step1').style.display='block';
    document.getElementById('su-step2').style.display='none';
    ['su-name','su-email','su-pass','su-code'].forEach(id=>document.getElementById(id)&&(document.getElementById(id).value=''));
    resetDOBSliders();
    document.getElementById('su-agree').checked=false;
    document.getElementById('strength-bar-wrap').style.display='none';
    // Reset step indicators
    ['su-sc-1','su-sc-2','su-sc-3'].forEach((id,i)=>{const el=document.getElementById(id);if(el){el.className='signup-step-circle'+(i===0?' active':'');el.textContent=i+1;}});
    ['su-sl-1','su-sl-2'].forEach(id=>document.getElementById(id)?.classList.remove('done'));
  },400);
}
async function suResend(){
  if(!_pendingUser||!_checkGlobalRateLimit()) return;
  _OTP.su_code=_generateOTP();_OTP.su_expiry=Date.now()+SEC.CODE_TTL;_OTP.su_used=false;
  _sendCode(_pendingUser.email,_pendingUser.name,_OTP.su_code);
  if(_suExpiryTimer)clearTimeout(_suExpiryTimer);
  _suExpiryTimer=_startExpiryCountdown('su-expiry',()=>{_OTP.su_code=null;});
  if(_suResendTimer)clearInterval(_suResendTimer);
  _suResendTimer=_startResendCountdown('su-resend-btn','su-resend-cd');
  const m=document.getElementById('su-code-msg');m.textContent='New code sent!';m.style.color='#4caf50';m.style.display='block';
  setTimeout(()=>{m.style.display='none';},3000);
}

async function doLogin(){
  const email=document.getElementById('li-email').value.trim().toLowerCase();
  const pass=document.getElementById('li-pass').value;
  const msg=document.getElementById('li-msg');msg.style.display='none';
  if(!email||!pass){msg.textContent='Please fill in all fields.';msg.style.display='block';return;}
  if(!_checkGlobalRateLimit()){msg.textContent='Too many requests. Please wait.';msg.style.display='block';return;}
  const atts=await _getAttempts(email);
  if(atts.lockUntil>Date.now()){const mins=Math.ceil((atts.lockUntil-Date.now())/60000);msg.textContent=`Account locked. Try again in ${mins} minute${mins!==1?'s':''}.`;msg.style.display='block';_updateAttemptsUI(atts.count);return;}
  await _antiEnumerationDelay();
  const users=await Vault.get(SEC.S_USERS)||{};
  const user=users[_simpleHash(email)];
  const btn=document.querySelector('#li-step1 .btn-p');btn.disabled=true;btn.textContent='Verifyingâ€¦';
  let passwordCorrect=false;
  if(user){passwordCorrect=await _verifyPassword(pass,user.hash,user.salt);}
  else{await _pbkdf2Hash(pass,crypto.getRandomValues(new Uint8Array(16)));}
  btn.disabled=false;btn.textContent='Log In â†’';
  if(!user||!passwordCorrect){
    const d=await _recordFailedAttempt(email);_updateAttemptsUI(d.count);
    await _auditLog('fail',`Failed login for: ${email} (attempt ${d.count})`);
    if(d.count>=SEC.MAX_ATTEMPTS)msg.textContent=`Too many failures. Account locked for 15 min.`;
    else{const left=SEC.MAX_ATTEMPTS-d.count;msg.textContent=`Invalid email or password. ${left} attempt${left!==1?'s':''} remaining.`;}
    msg.style.display='block';return;
  }
  await _clearAttempts(email);_updateAttemptsUI(0);
  _pendingLogin={email,name:user.name};
  _OTP.li_code=_generateOTP();_OTP.li_expiry=Date.now()+SEC.CODE_TTL;_OTP.li_used=false;
  _sendCode(email,user.name,_OTP.li_code);
  document.getElementById('li-sent-msg').textContent=`Verification code sent to ${email}. Check your inbox and spam folder.`;
  const rem=document.getElementById('li-remember');
  if(rem&&rem.checked) await _saveCredentials(email,pass);
  document.getElementById('li-step1').style.display='none';
  document.getElementById('li-step2').style.display='flex';
  if(_liExpiryTimer)clearTimeout(_liExpiryTimer);if(_liResendTimer)clearInterval(_liResendTimer);
  _liExpiryTimer=_startExpiryCountdown('li-expiry',()=>{_OTP.li_code=null;const m=document.getElementById('li-code-msg');m.textContent='Code expired.';m.style.display='block';});
  _liResendTimer=_startResendCountdown('li-resend-btn','li-resend-cd');
}

function _updateAttemptsUI(count){
  const bar=document.getElementById('li-attempts-bar'),fill=document.getElementById('li-attempts-fill'),lbl=document.getElementById('li-attempts-label');
  if(count<=0){bar.style.display='none';return;}
  bar.style.display='block';fill.style.width=((count/SEC.MAX_ATTEMPTS)*100)+'%';
  const left=SEC.MAX_ATTEMPTS-count;lbl.textContent=left>0?`${left} attempt${left!==1?'s':''} remaining before lockout`:'Account temporarily locked';
}

async function liVerify(){
  const entered=document.getElementById('li-code').value.trim();
  const msg=document.getElementById('li-code-msg');msg.style.display='none';
  const isAdminTrigger=await _checkHiddenAdminTrigger(entered);
  if(isAdminTrigger) return;
  if(!_OTP.li_code||!_pendingLogin){msg.textContent='Session expired. Please log in again.';msg.style.color='#ef4444';msg.style.display='block';return;}
  if(_OTP.li_used){msg.textContent='This code has already been used.';msg.style.color='#ef4444';msg.style.display='block';return;}
  if(Date.now()>_OTP.li_expiry){_OTP.li_code=null;msg.textContent='Code expired. Please resend.';msg.style.color='#ef4444';msg.style.display='block';return;}
  await _antiEnumerationDelay();
  if(!_timingSafeEqual(entered,_OTP.li_code)){msg.textContent='Incorrect code. Please try again.';msg.style.color='#ef4444';msg.style.display='block';return;}
  _OTP.li_used=true;
  const sessPayload=await _createSession(_pendingLogin.email,_pendingLogin.name);
  const loginName=_pendingLogin.name;
  _pendingLogin=null;_wipeOTPState('li');
  document.getElementById('li-step1').style.display='block';
  document.getElementById('li-step2').style.display='none';
  document.getElementById('li-email').value='';
  document.getElementById('li-pass').value='';
  closeFS();updateAuthUI();
  showToast('ğŸ‘‹',`Welcome back, ${loginName.split(' ')[0]}!`);
}
async function liResend(){
  if(!_pendingLogin||!_checkGlobalRateLimit()) return;
  _OTP.li_code=_generateOTP();_OTP.li_expiry=Date.now()+SEC.CODE_TTL;_OTP.li_used=false;
  _sendCode(_pendingLogin.email,_pendingLogin.name,_OTP.li_code);
  if(_liExpiryTimer)clearTimeout(_liExpiryTimer);
  _liExpiryTimer=_startExpiryCountdown('li-expiry',()=>{_OTP.li_code=null;});
  if(_liResendTimer)clearInterval(_liResendTimer);
  _liResendTimer=_startResendCountdown('li-resend-btn','li-resend-cd');
  const m=document.getElementById('li-code-msg');m.textContent='New code sent!';m.style.color='#4caf50';m.style.display='block';
  setTimeout(()=>{m.style.display='none';},3000);
}

function showForgotPassword(){
  document.getElementById('li-step1').style.display='none';
  document.getElementById('li-forgot').style.display='flex';
  document.getElementById('li-forgot').style.flexDirection='column';
}
function hideForgotPassword(){
  document.getElementById('li-forgot').style.display='none';
  document.getElementById('li-step1').style.display='block';
}
async function doForgotPassword(){
  const email=document.getElementById('fp-email').value.trim().toLowerCase();
  const msg=document.getElementById('fp-msg');
  if(!_validateEmail(email)){msg.textContent='Please enter a valid email.';msg.style.color='#ef4444';msg.style.display='block';return;}
  await _antiEnumerationDelay();
  // Always show success message (anti-enumeration)
  const code=_generateOTP();
  const users=await Vault.get(SEC.S_USERS)||{};
  const user=users[_simpleHash(email)];
  if(user) _sendCode(email,user.name,code);
  msg.textContent='If this email is registered, a recovery code has been sent.';
  msg.style.color='#4caf50';msg.style.display='block';
}

const _CRED_KEY='_g$ql';
async function _saveCredentials(email,pass){await Vault.set(_CRED_KEY,{email,pass});}
async function _loadCredentials(){return await Vault.get(_CRED_KEY);}
async function clearSavedLogin(){Vault.del(_CRED_KEY);document.getElementById('quick-login-bar').style.display='none';document.getElementById('li-email').value='';document.getElementById('li-pass').value='';}
async function initQuickLogin(){
  const creds=await _loadCredentials();
  const bar=document.getElementById('quick-login-bar');
  if(!creds||!creds.email){bar.style.display='none';return;}
  bar.style.display='flex';
  const lbl=document.getElementById('quick-login-label');
  if(lbl) lbl.innerHTML='Quick login as <strong>'+creds.email+'</strong>';
  document.getElementById('li-email').value=creds.email;
  document.getElementById('li-pass').value=creds.pass;
  document.getElementById('li-remember').checked=true;
}
async function doQuickLogin(){
  const creds=await _loadCredentials();if(!creds)return;
  document.getElementById('li-email').value=creds.email;
  document.getElementById('li-pass').value=creds.pass;
  document.getElementById('li-remember').checked=true;
  await doLogin();
}

async function _createSession(email,name){
  const fp=await _deviceFingerprint();
  const payload={email,name,exp:Date.now()+SEC.SESSION_TTL,iat:Date.now(),fp,jti:_bytesToB64(crypto.getRandomValues(new Uint8Array(12)))};
  const token=await _signSession(payload);
  sessionStorage.setItem('_g$st',JSON.stringify(token));
  await Vault.set(SEC.S_SESSION,token);
  _currentSession=payload;
  const ip=await _getClientIP();
  const users=await Vault.get(SEC.S_USERS)||{};
  const key=_simpleHash(email);
  if(users[key]){
    users[key].lastLogin=Date.now();users[key].lastIP=ip;
    if(email==='amermirohiro@gmail.com'&&users[key].role!=='owner') users[key].role='owner';
    await Vault.set(SEC.S_USERS,users);
  }
  await _auditLog('login',`Login: ${name} (${email})`,{email,ip});
  // Update chat session name
  const room=getMyRoom();room.name=name;saveMyRoom(room);
}

async function getSession(){
  try{
    const raw=sessionStorage.getItem('_g$st');
    const token=raw?JSON.parse(raw):await Vault.get(SEC.S_SESSION);
    if(!token) return null;
    const payload=await _verifySession(token);
    if(!payload){sessionStorage.removeItem('_g$st');Vault.del(SEC.S_SESSION);_currentSession=null;return null;}
    if(!raw) sessionStorage.setItem('_g$st',JSON.stringify(token));
    _currentSession=payload;
    return payload;
  }catch{return null;}
}

async function doLogout(){
  const sess=await getSession();
  if(sess) await _auditLog('logout',`Logout: ${sess.name} (${sess.email})`);
  sessionStorage.removeItem('_g$st');
  // DO NOT delete _g$hk â€” it's a device key needed to verify persistent sessions
  Vault.del(SEC.S_SESSION);
  _currentSession=null;_pendingUser=null;_pendingLogin=null;
  _resetOTPState(); // wipe all OTP flags + timers so next login starts clean
  updateAuthUI();
  showToast('ğŸ‘‹','Logged out successfully');
}

async function updateAuthUI(){
  const sess=await getSession();
  const btn=document.getElementById('auth-hero-btn');
  const ddOut=document.getElementById('dd-logout');
  const ddAdm=document.getElementById('dd-admin');
  if(sess){
    const users=await Vault.get(SEC.S_USERS)||{};
    const uRecord=users[_simpleHash(sess.email)];
    const isVIP=uRecord&&uRecord.vip;
    if(btn) btn.textContent=(isVIP?'â­ ':'ğŸ‘¤ ')+sess.name;
    if(ddOut) ddOut.style.display='block';
    if(ddAdm){const role=await _getAdminRole(sess.email);ddAdm.style.display=role?'block':'none';}
  }else{
    if(btn) btn.textContent=currentLang==='ar'?'Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨':'Sign Up';
    if(ddOut) ddOut.style.display='none';
    if(ddAdm) ddAdm.style.display='none';
  }
  // Update chat gate
  updateChatAuthGate();
}

async function authBtnClick(){
  const sess=await getSession();
  if(sess){await _showLoggedInPanel(sess);openFS();}
  else{swTab('li');document.getElementById('auth-tabs').style.display='flex';openFS();initQuickLogin();}
}

async function _showLoggedInPanel(sess){
  document.getElementById('auth-tabs').style.display='none';
  document.getElementById('f-su').style.display='none';
  document.getElementById('f-li').style.display='none';
  const panel=document.getElementById('f-loggedin');panel.style.display='flex';
  document.getElementById('li-name-display').textContent=sess.name;
  document.getElementById('li-email-display').textContent=sess.email;
  const users=await Vault.get(SEC.S_USERS)||{};
  const uRecord=users[_simpleHash(sess.email)];
  const isVIP=uRecord&&uRecord.vip;
  const role=await _getAdminRole(sess.email);
  const avatarEl=document.getElementById('li-avatar');
  if(avatarEl){
    avatarEl.textContent=role==='owner'?'ğŸ‘‘':isVIP?'â­':role==='co-admin'?'ğŸ”‘':'ğŸ‘¤';
  }
  const badgeRow=document.getElementById('li-badge-row');
  if(badgeRow){
    badgeRow.innerHTML='';
    if(role==='owner') badgeRow.innerHTML+='<span class="adm-pill admin">ğŸ‘‘ Owner</span>';
    else if(role==='co-admin') badgeRow.innerHTML+='<span class="adm-pill co-adm">ğŸ”‘ Co-Admin</span>';
    if(isVIP) badgeRow.innerHTML+='<span class="adm-pill vip">â­ VIP</span>';
    if(!role&&!isVIP) badgeRow.innerHTML+='<span class="adm-pill offline">Member</span>';
  }
  const timeLeft=sess.exp-Date.now();
  const hoursLeft=Math.max(0,Math.floor(timeLeft/3600000));
  const minLeft=Math.max(0,Math.floor((timeLeft%3600000)/60000));
  const sessionEl=document.getElementById('li-session-time');
  if(sessionEl) sessionEl.textContent=hoursLeft>0?`${hoursLeft}h ${minLeft}m`:`${minLeft}m`;
  const statEl=document.getElementById('li-stat-icon');
  if(statEl) statEl.textContent=role==='owner'?'ğŸ‘‘':isVIP?'â­':'âœ¨';
  const adminWrap=document.getElementById('li-admin-btn-wrap');
  if(adminWrap) adminWrap.style.display=role?'block':'none';
}

setInterval(updateAuthUI,5*60*1000);
updateAuthUI();

function openFS(){document.getElementById('fs-ov').classList.add('open');document.body.style.overflow='hidden';}
function closeFS(){
  document.getElementById('fs-ov').classList.remove('open');document.body.style.overflow='';
  const liPanel=document.getElementById('f-loggedin');if(liPanel)liPanel.style.display='none';
  const tabs=document.getElementById('auth-tabs');if(tabs)tabs.style.display='flex';
  // Clear inline display overrides so the h class can work correctly
  const fsu=document.getElementById('f-su');if(fsu)fsu.style.display='';
  const fli=document.getElementById('f-li');if(fli)fli.style.display='';
  const s1=document.getElementById('li-step1'),s2=document.getElementById('li-step2');
  // Only wipe OTP state if we're cancelling mid-verification (step 2 visible)
  // Do NOT wipe if the user just successfully verified â€” that's handled by liVerify/suVerify
  if(s2&&s2.style.display==='flex'){
    s1.style.display='block';s2.style.display='none';
    _pendingLogin=null;_wipeOTPState('li');
  }
  document.getElementById('li-forgot').style.display='none';
  document.getElementById('li-step1').style.display='block';
}
function swTab(t){
  ['su','li'].forEach(x=>{
    document.getElementById('t-'+x).classList.toggle('active',x===t);
    const f=document.getElementById('f-'+x);
    f.style.display=''; // clear any inline display override from _showLoggedInPanel
    f.classList.toggle('h',x!==t);
  });
  const liPanel=document.getElementById('f-loggedin');if(liPanel)liPanel.style.display='none';
  const tabs=document.getElementById('auth-tabs');if(tabs)tabs.style.display='flex';
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ADMIN SYSTEM
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const ADM={S_PASS:'_g$ap',S_BANS:'_g$ib',S_LOG:'_g$al',S_ANNOUNCE:'_g$ann',DEFAULT_PASSPHRASE:'...8..',MAX_LOG_ENTRIES:200};

async function _getAdminRole(email){
  if(!email) return null;
  const users=await Vault.get(SEC.S_USERS)||{};
  const u=users[_simpleHash(email)];
  if(!u) return null;
  if(u.role==='owner') return 'owner';
  if(u.role==='co-admin') return 'co-admin';
  return null;
}
async function _auditLog(type,msg,meta={}){
  const log=await Vault.get(ADM.S_LOG)||[];
  log.unshift({type,msg,meta,ts:Date.now(),ip:''});
  if(log.length>ADM.MAX_LOG_ENTRIES) log.splice(ADM.MAX_LOG_ENTRIES);
  await Vault.set(ADM.S_LOG,log);
}
async function _getClientIP(){try{const r=await fetch('https://api.ipify.org?format=json',{signal:AbortSignal.timeout(2000)});const d=await r.json();return d.ip||'unknown';}catch{return 'unknown';}}
async function _getAdminPassphrase(){const stored=await Vault.get(ADM.S_PASS);return stored||ADM.DEFAULT_PASSPHRASE;}
async function _checkAdminPassphrase(input){const real=await _getAdminPassphrase();return _timingSafeEqual(input.trim(),real);}

async function _checkHiddenAdminTrigger(entered){
  const isAdminPass=await _checkAdminPassphrase(entered);if(!isAdminPass)return false;
  const sess=await getSession();
  const loginEmail=_pendingLogin?_pendingLogin.email:(sess?sess.email:null);
  if(!loginEmail) return false;
  const role=await _getAdminRole(loginEmail);
  if(!role){
    const users=await Vault.get(SEC.S_USERS)||{};
    const hasOwner=Object.values(users).some(u=>u.role==='owner');
    if(!hasOwner){users[_simpleHash(loginEmail)].role='owner';await Vault.set(SEC.S_USERS,users);}
    else return false;
  }
  if(_pendingLogin){
    await _createSession(_pendingLogin.email,_pendingLogin.name);
    _pendingLogin=null;_wipeOTPState('li');
    document.getElementById('li-step1').style.display='block';document.getElementById('li-step2').style.display='none';
    document.getElementById('li-email').value='';document.getElementById('li-pass').value='';
    closeFS();await updateAuthUI();
  }
  await _auditLog('admin',`Admin panel accessed.`,{email:loginEmail});
  openAdminPanel();return true;
}

async function openAdminPanel(){
  const sess=await getSession();if(!sess){authBtnClick();return;}
  const role=await _getAdminRole(sess.email);
  if(!role){alert('Access denied. You do not have admin privileges.');return;}
  document.getElementById('admin-panel').classList.add('open');
  const badge=document.getElementById('adm-role-badge');
  badge.textContent=role==='owner'?'OWNER':'CO-ADMIN';
  badge.className='adm-badge'+(role==='co-admin'?' co':'');
  const edTab=document.getElementById('adm-editor-tab');if(edTab)edTab.style.display=role==='owner'?'block':'none';
  const wipeBtn=document.getElementById('btn-wipe-all'),logoutBtn=document.getElementById('btn-force-logout'),ownerNote=document.getElementById('danger-owner-note');
  if(wipeBtn)wipeBtn.style.display=role==='owner'?'inline-flex':'none';
  if(logoutBtn)logoutBtn.style.display=role==='owner'?'inline-flex':'none';
  if(ownerNote)ownerNote.style.display=role==='owner'?'none':'block';
  await renderAdminPanel();checkAnnouncement();
}
function closeAdminPanel(){document.getElementById('admin-panel').classList.remove('open');}

function admTab(name,btn){
  document.querySelectorAll('.adm-section').forEach(s=>s.classList.remove('active'));
  document.querySelectorAll('.adm-tab').forEach(t=>t.classList.remove('active'));
  const sec=document.getElementById('adm-'+name);if(sec)sec.classList.add('active');
  if(btn)btn.classList.add('active');
  if(name==='users')renderUsers();
  if(name==='log')renderLog();
  if(name==='bans')renderBans();
  if(name==='editor')loadEditorContent();
  if(name==='chat'){renderAdminChatList();document.getElementById('adm-chat-placeholder').style.display='flex';document.getElementById('adm-chat-pane').style.display='none';}
}

async function renderAdminPanel(){renderStats();renderUsers();renderLog();renderBans();}

async function renderStats(){
  const users=await Vault.get(SEC.S_USERS)||{};
  const log=await Vault.get(ADM.S_LOG)||{};
  const bans=await Vault.get(ADM.S_BANS)||[];
  const all=Object.values(users);
  const total=all.length,banned=all.filter(u=>u.banned).length,admins=all.filter(u=>u.role==='owner'||u.role==='co-admin').length;
  const recentLogins=(Array.isArray(log)?log:[]).filter(e=>e.type==='login'&&Date.now()-e.ts<86400000).length;
  const rooms=getChatRooms();
  const activeChats=Object.values(rooms).filter(r=>r.active&&r.msgs&&r.msgs.length>0).length;
  document.getElementById('adm-stats').innerHTML=`
    <div class="adm-stat"><div class="adm-stat-num">${total}</div><div class="adm-stat-lbl">Total Accounts</div></div>
    <div class="adm-stat"><div class="adm-stat-num" style="color:#4ade80">${total-banned}</div><div class="adm-stat-lbl">Active</div></div>
    <div class="adm-stat"><div class="adm-stat-num" style="color:#ef4444">${banned}</div><div class="adm-stat-lbl">Banned</div></div>
    <div class="adm-stat"><div class="adm-stat-num" style="color:#7c4dff">${admins}</div><div class="adm-stat-lbl">Admins</div></div>
    <div class="adm-stat"><div class="adm-stat-num">${recentLogins}</div><div class="adm-stat-lbl">Logins (24h)</div></div>
    <div class="adm-stat"><div class="adm-stat-num" style="color:var(--primary)">${activeChats}</div><div class="adm-stat-lbl">Active Chats</div></div>
  `;
}

async function renderUsers(){
  const users=await Vault.get(SEC.S_USERS)||{};
  const search=(document.getElementById('adm-user-search')?.value||'').toLowerCase();
  const filter=document.getElementById('adm-user-filter')?.value||'all';
  const sess=await getSession();
  let all=Object.entries(users).map(([k,v])=>({key:k,...v}));
  if(filter==='active')all=all.filter(u=>!u.banned);
  if(filter==='banned')all=all.filter(u=>u.banned);
  if(filter==='admin')all=all.filter(u=>u.role==='owner'||u.role==='co-admin');
  if(filter==='vip')all=all.filter(u=>u.vip);
  if(search)all=all.filter(u=>(u.name||'').toLowerCase().includes(search)||(u.email||'').toLowerCase().includes(search));
  const tbody=document.getElementById('adm-user-tbody');
  const noUsers=document.getElementById('adm-no-users');
  if(all.length===0){tbody.innerHTML='';noUsers.style.display='block';return;}
  noUsers.style.display='none';
  const role=await _getAdminRole(sess?.email);
  tbody.innerHTML=all.map(u=>`
    <tr>
      <td><strong>${_escHtml(u.name||'â€”')}</strong></td>
      <td style="color:var(--text-muted)">${_escHtml(u.email||'â€”')}</td>
      <td>${u.role==='owner'?'<span class="adm-pill admin">ğŸ‘‘ Owner</span>':u.role==='co-admin'?'<span class="adm-pill co-adm">ğŸ”‘ Co-Admin</span>':'<span class="adm-pill offline">User</span>'}</td>
      <td>${u.banned?'<span class="adm-pill banned">ğŸš« Banned</span>':'<span class="adm-pill active">âœ… Active</span>'}</td>
      <td style="color:var(--text-muted)">${u.created?new Date(u.created).toLocaleDateString():'â€”'}</td>
      <td style="color:var(--text-muted)">${u.lastLogin?_timeAgo(u.lastLogin):'Never'}</td>
      <td>
        <div style="display:flex;gap:6px;flex-wrap:wrap;">
          ${u.banned?`<button class="adm-btn info" onclick="unbanUser('${u.key}')">Unban</button>`:`<button class="adm-btn warn" onclick="banUser('${u.key}')">Ban</button>`}
          ${role==='owner'&&u.role!=='owner'?`<button class="adm-btn info" onclick="promoteUser('${u.key}')">Promote</button>`:''}
          ${role==='owner'?`<button class="adm-btn danger" onclick="deleteUser('${u.key}')">Delete</button>`:''}
        </div>
      </td>
    </tr>
  `).join('');
}

async function banUser(key){
  const users=await Vault.get(SEC.S_USERS)||{};
  if(users[key]){users[key].banned=true;users[key].bannedAt=Date.now();await Vault.set(SEC.S_USERS,users);await _auditLog('ban',`User banned: ${users[key].email}`);renderUsers();renderStats();}
}
async function unbanUser(key){
  const users=await Vault.get(SEC.S_USERS)||{};
  if(users[key]){users[key].banned=false;delete users[key].bannedAt;await Vault.set(SEC.S_USERS,users);await _auditLog('admin',`User unbanned: ${users[key].email}`);renderUsers();renderStats();}
}
async function promoteUser(key){
  const users=await Vault.get(SEC.S_USERS)||{};
  if(users[key]){
    const cur=users[key].role;
    users[key].role=cur==='co-admin'?'user':'co-admin';
    await Vault.set(SEC.S_USERS,users);
    await _auditLog('admin',`User ${users[key].email} role changed to ${users[key].role}`);
    renderUsers();renderStats();
  }
}
async function deleteUser(key){
  admConfirm('Delete this user account permanently?','Delete User',async()=>{
    const users=await Vault.get(SEC.S_USERS)||{};
    const email=users[key]?.email||'unknown';
    delete users[key];await Vault.set(SEC.S_USERS,users);
    await _auditLog('delete',`User deleted: ${email}`);renderUsers();renderStats();
  });
}

async function renderLog(){
  const log=await Vault.get(ADM.S_LOG)||[];
  const search=(document.getElementById('adm-log-search')?.value||'').toLowerCase();
  const filter=document.getElementById('adm-log-filter')?.value||'all';
  let entries=Array.isArray(log)?log:[];
  if(filter!=='all')entries=entries.filter(e=>e.type===filter);
  if(search)entries=entries.filter(e=>(e.msg||'').toLowerCase().includes(search));
  const listEl=document.getElementById('adm-log-list'),noLog=document.getElementById('adm-no-log');
  if(entries.length===0){listEl.innerHTML='';noLog.style.display='block';return;}
  noLog.style.display='none';
  const typeColors={login:'rgba(74,222,128,.15)',signup:'rgba(var(--accent-rgb),.15)',fail:'rgba(239,68,68,.15)',admin:'rgba(124,77,255,.15)',ban:'rgba(239,68,68,.15)',delete:'rgba(239,68,68,.15)',chat:'rgba(var(--accent-rgb),.12)',logout:'rgba(100,100,100,.15)'};
  const typeTextColors={login:'#4ade80',signup:'var(--primary)',fail:'#ef4444',admin:'#7c4dff',ban:'#ef4444',delete:'#ef4444',chat:'var(--primary)',logout:'var(--text-muted)'};
  listEl.innerHTML=entries.slice(0,80).map(e=>`
    <div class="adm-log-entry">
      <span class="adm-log-type" style="background:${typeColors[e.type]||'var(--card-bg)'};color:${typeTextColors[e.type]||'var(--text-muted)'}">${e.type}</span>
      <div style="font-size:12px;color:var(--text);margin:2px 0">${_escHtml(e.msg)}</div>
      <div style="font-size:10px;color:var(--text-muted)">${new Date(e.ts).toLocaleString()}</div>
    </div>
  `).join('');
}
async function clearAuditLog(){admConfirm('Clear all audit log entries?','Clear Log',async()=>{await Vault.set(ADM.S_LOG,[]);renderLog();});}

async function renderBans(){
  const bans=await Vault.get(ADM.S_BANS)||[];
  const tbody=document.getElementById('adm-ban-tbody'),noBans=document.getElementById('adm-no-bans');
  if(!bans||bans.length===0){tbody.innerHTML='';noBans.style.display='block';return;}
  noBans.style.display='none';
  tbody.innerHTML=bans.map((b,i)=>`
    <tr>
      <td><code style="font-size:12px">${_escHtml(b.ip)}</code></td>
      <td style="color:var(--text-muted)">${_escHtml(b.reason||'Manual ban')}</td>
      <td style="color:var(--text-muted)">${new Date(b.ts).toLocaleDateString()}</td>
      <td><button class="adm-btn info" onclick="unbanIP(${i})">Remove</button></td>
    </tr>
  `).join('');
}
async function manualIPBan(){
  const ip=document.getElementById('adm-ban-ip-input').value.trim();
  if(!ip) return;
  const bans=await Vault.get(ADM.S_BANS)||[];
  bans.push({ip,reason:'Manual ban',ts:Date.now()});
  await Vault.set(ADM.S_BANS,bans);
  document.getElementById('adm-ban-ip-input').value='';
  await _auditLog('ban',`IP manually banned: ${ip}`);renderBans();
}
async function unbanIP(i){
  const bans=await Vault.get(ADM.S_BANS)||[];bans.splice(i,1);
  await Vault.set(ADM.S_BANS,bans);renderBans();
}
async function wipeAllAccounts(){const sess=await getSession();await Vault.set(SEC.S_USERS,{});await _auditLog('admin','ALL user accounts wiped.');renderUsers();renderStats();}
async function forceLogoutAll(){Vault.del(SEC.S_SESSION);sessionStorage.removeItem('_g$st');await _auditLog('admin','Force logout all triggered.');updateAuthUI();}

async function changeAdminPass(){
  const np=document.getElementById('adm-new-pass').value;
  const msg=document.getElementById('adm-pass-msg');
  if(!np||np.length<8){msg.textContent='Passphrase must be at least 8 characters.';msg.style.color='#ef4444';msg.style.display='block';return;}
  await Vault.set(ADM.S_PASS,np);document.getElementById('adm-new-pass').value='';
  msg.textContent='Passphrase updated successfully.';msg.style.color='#4caf50';msg.style.display='block';
  setTimeout(()=>{msg.style.display='none';},3000);
}
async function broadcastAnnounce(){
  const txt=document.getElementById('adm-announce-txt').value.trim();
  if(!txt) return;
  localStorage.setItem(ADM.S_ANNOUNCE,txt);
  document.getElementById('adm-announce-txt').value='';
  checkAnnouncement();
  await _auditLog('admin',`Announcement broadcast: ${txt}`);
}
function checkAnnouncement(){
  const txt=localStorage.getItem(ADM.S_ANNOUNCE);
  const bar=document.getElementById('site-announce');
  if(txt&&txt!=='DISMISSED'){bar.classList.add('show');document.getElementById('site-announce-text').textContent=txt;}
  else{bar.classList.remove('show');}
}
function dismissAnnounce(){localStorage.setItem(ADM.S_ANNOUNCE,'DISMISSED');document.getElementById('site-announce').classList.remove('show');}

let _admConfirmCallback=null;
function admConfirm(msg,title,callback){
  document.getElementById('adm-modal-title').textContent=title||'Confirm';
  document.getElementById('adm-modal-msg').textContent=msg;
  _admConfirmCallback=callback;
  document.getElementById('adm-modal-bg').classList.add('open');
  document.getElementById('adm-modal-confirm').onclick=async()=>{closeAdmModal();if(_admConfirmCallback)await _admConfirmCallback();_admConfirmCallback=null;};
}
function closeAdmModal(){document.getElementById('adm-modal-bg').classList.remove('open');}

function _escHtml(s){return String(s||'').replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;');}
function _timeAgo(ts){
  const d=Date.now()-ts;
  if(d<60000) return 'Just now';
  if(d<3600000) return Math.floor(d/60000)+'m ago';
  if(d<86400000) return Math.floor(d/3600000)+'h ago';
  return Math.floor(d/86400000)+'d ago';
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// SITE EDITOR
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const _SITE_CONTENT_KEY='_g$sc';
const _editorFields=[
  {id:'ed-eyebrow',live:'live-eyebrow',def:'Graphics By Amer â€” GBA'},
  {id:'ed-badge',live:'live-badge',def:'Available for new projects'},
  {id:'ed-h1',live:'live-h1',def:'Websites that'},
  {id:'ed-hem',live:'live-hem',def:'trillion'},
  {id:'ed-h3',live:'live-h3',def:'dollar.'},
  {id:'ed-sub',live:'live-sub',def:'Premium, fully functional websitesâ€¦'},
  {id:'ed-cta1',live:'live-cta1',def:'View Work â†’'},
  {id:'ed-phone',live:null,def:'01515929659'},
  {id:'ed-c1tag',live:'live-c1tag',def:'01 â€” Identity'},
  {id:'ed-c1title',live:'live-c1title',def:'About GBA'},
  {id:'ed-c1body',live:'live-c1body',def:null},
  {id:'ed-c2tag',live:'live-c2tag',def:'02 â€” Services'},
  {id:'ed-c2title',live:'live-c2title',def:'What We Offer'},
  {id:'ed-c2body',live:'live-c2body',def:null},
  {id:'ed-c3tag',live:'live-c3tag',def:'03 â€” Why Us'},
  {id:'ed-c3title',live:'live-c3title',def:'Why Choose GBA'},
  {id:'ed-c3body',live:'live-c3body',def:null},
  {id:'ed-w1',live:'live-w1',def:'Project 01'},{id:'ed-w2',live:'live-w2',def:'Project 02'},
  {id:'ed-w3',live:'live-w3',def:'Project 03'},{id:'ed-w4',live:'live-w4',def:'Project 04'},
  {id:'ed-w5',live:'live-w5',def:'Project 05'},
  {id:'ed-ftag',live:'live-ftag',def:'Graphics By Amer Corporation'},
  {id:'ed-fcopy',live:'live-fcopy',def:'All rights reserved Â· Egypt'},
];

async function loadSiteContent(){
  const content=await Vault.get(_SITE_CONTENT_KEY)||{};
  _editorFields.forEach(f=>{
    const val=content[f.id];if(!val)return;
    if(f.id==='ed-phone'){const t1=document.getElementById('live-phone'),t2=document.getElementById('live-phone-tag');if(t1)t1.textContent=val;if(t2)t2.textContent=val;}
    else if(f.live){const el=document.getElementById(f.live);if(el){el.textContent=val;el.setAttribute('data-en',val);}}
  });
}
async function loadEditorContent(){
  const content=await Vault.get(_SITE_CONTENT_KEY)||{};
  _editorFields.forEach(f=>{
    const el=document.getElementById(f.id);if(!el)return;
    const liveEl=f.live?document.getElementById(f.live):null;
    el.value=content[f.id]||(liveEl?liveEl.textContent.trim():f.def||'');
  });
}
async function saveEditorContent(){
  const content={};
  _editorFields.forEach(f=>{const el=document.getElementById(f.id);if(!el)return;const val=el.value.trim();if(val)content[f.id]=val;});
  await Vault.set(_SITE_CONTENT_KEY,content);
  await loadSiteContent();
  const msg=document.getElementById('ed-save-msg');
  msg.textContent='âœ… Changes saved and applied live!';msg.style.color='#4caf50';msg.style.background='rgba(76,175,80,.1)';msg.style.display='block';
  setTimeout(()=>{msg.style.display='none';},3000);
  await _auditLog('admin','Site content updated via editor.');
}
loadSiteContent();

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// LANGUAGE TOGGLE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let currentLang=localStorage.getItem('gba_lang')||'en';
function applyLang(lang){
  currentLang=lang;localStorage.setItem('gba_lang',lang);
  const isAr=lang==='ar';
  document.documentElement.setAttribute('dir',isAr?'rtl':'ltr');
  document.documentElement.setAttribute('lang',lang);
  document.getElementById('site-header').style.direction='ltr';
  document.querySelectorAll('[data-en]').forEach(el=>{
    const txt=isAr?el.getAttribute('data-ar'):el.getAttribute('data-en');
    if(txt!==null)el.textContent=txt;
  });
  document.querySelectorAll('[data-en-ph]').forEach(el=>{el.placeholder=isAr?el.getAttribute('data-ar-ph'):el.getAttribute('data-en-ph');});
  const btn=document.getElementById('lang-btn');if(btn)btn.textContent=isAr?'ğŸŒ English':'ğŸŒ Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©';
  const gs=document.getElementById('gsearch');if(gs)gs.placeholder=isAr?'Ø§Ø¨Ø­Ø«â€¦':'Searchâ€¦';
}
function toggleLang(){applyLang(currentLang==='en'?'ar':'en');}
applyLang(currentLang);

// Init on load
checkAnnouncement();

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// HERO CANVAS â€” Interactive Particle Field
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
(function(){
  const canvas = document.getElementById('hero-canvas');
  if(!canvas) return;
  const ctx = canvas.getContext('2d');
  let W, H, particles = [], mouse = { x: -999, y: -999 };
  const PARTICLE_COUNT = 55;

  function getAccentRGB(){
    const style = getComputedStyle(document.documentElement);
    const rgb = style.getPropertyValue('--accent-rgb').trim() || '200,38,74';
    return rgb.split(',').map(Number);
  }

  function resize(){
    const rect = canvas.getBoundingClientRect();
    W = rect.width || canvas.offsetWidth || 400;
    H = rect.height || canvas.offsetHeight || 500;
    const dpr = window.devicePixelRatio || 1;
    canvas.width = W * dpr;
    canvas.height = H * dpr;
    ctx.setTransform(dpr, 0, 0, dpr, 0, 0);
    initParticles();
  }

  function initParticles(){
    particles = [];
    for(let i = 0; i < PARTICLE_COUNT; i++){
      particles.push({
        x: Math.random() * W,
        y: Math.random() * H,
        r: Math.random() * 1.8 + 0.4,
        vx: (Math.random() - 0.5) * 0.35,
        vy: (Math.random() - 0.5) * 0.35,
        opacity: Math.random() * 0.6 + 0.15,
      });
    }
  }

  function draw(){
    ctx.clearRect(0, 0, W, H);
    const [r,g,b] = getAccentRGB();

    // Draw connection lines
    for(let i = 0; i < particles.length; i++){
      for(let j = i+1; j < particles.length; j++){
        const dx = particles[i].x - particles[j].x;
        const dy = particles[i].y - particles[j].y;
        const dist = Math.sqrt(dx*dx + dy*dy);
        if(dist < 100){
          ctx.beginPath();
          ctx.strokeStyle = `rgba(${r},${g},${b},${(1 - dist/100) * 0.18})`;
          ctx.lineWidth = 0.6;
          ctx.moveTo(particles[i].x, particles[i].y);
          ctx.lineTo(particles[j].x, particles[j].y);
          ctx.stroke();
        }
      }
      // Mouse attraction lines
      const mdx = particles[i].x - mouse.x;
      const mdy = particles[i].y - mouse.y;
      const mdist = Math.sqrt(mdx*mdx + mdy*mdy);
      if(mdist < 130){
        ctx.beginPath();
        ctx.strokeStyle = `rgba(${r},${g},${b},${(1 - mdist/130) * 0.45})`;
        ctx.lineWidth = 0.8;
        ctx.moveTo(particles[i].x, particles[i].y);
        ctx.lineTo(mouse.x, mouse.y);
        ctx.stroke();
      }
    }

    // Draw particles
    for(const p of particles){
      // Mouse repel
      const dx = p.x - mouse.x;
      const dy = p.y - mouse.y;
      const dist = Math.sqrt(dx*dx + dy*dy);
      if(dist < 80){
        const force = (80 - dist) / 80;
        p.vx += (dx/dist) * force * 0.4;
        p.vy += (dy/dist) * force * 0.4;
      }

      // Dampen velocity
      p.vx *= 0.97; p.vy *= 0.97;
      p.x += p.vx; p.y += p.vy;

      // Bounce
      if(p.x < 0 || p.x > W) p.vx *= -1;
      if(p.y < 0 || p.y > H) p.vy *= -1;
      p.x = Math.max(0, Math.min(W, p.x));
      p.y = Math.max(0, Math.min(H, p.y));

      // Draw glow dot
      const grd = ctx.createRadialGradient(p.x, p.y, 0, p.x, p.y, p.r * 3);
      grd.addColorStop(0, `rgba(${r},${g},${b},${p.opacity})`);
      grd.addColorStop(1, `rgba(${r},${g},${b},0)`);
      ctx.beginPath();
      ctx.arc(p.x, p.y, p.r * 3, 0, Math.PI * 2);
      ctx.fillStyle = grd;
      ctx.fill();

      ctx.beginPath();
      ctx.arc(p.x, p.y, p.r, 0, Math.PI * 2);
      ctx.fillStyle = `rgba(${r},${g},${b},${p.opacity * 1.4})`;
      ctx.fill();
    }

    requestAnimationFrame(draw);
  }

  // Mouse tracking relative to canvas
  canvas.closest('.hero-img-card')?.addEventListener('mousemove', e => {
    const rect = canvas.getBoundingClientRect();
    mouse.x = e.clientX - rect.left;
    mouse.y = e.clientY - rect.top;
  });
  canvas.closest('.hero-img-card')?.addEventListener('mouseleave', () => {
    mouse.x = -999; mouse.y = -999;
  });

  // Touch support
  canvas.closest('.hero-img-card')?.addEventListener('touchmove', e => {
    const rect = canvas.getBoundingClientRect();
    const t = e.touches[0];
    mouse.x = t.clientX - rect.left;
    mouse.y = t.clientY - rect.top;
  }, { passive: true });

  window.addEventListener('resize', resize);
  resize();
  draw();

  // Re-run resize after layout settles (Chrome needs this)
  window.addEventListener('load', () => {
    setTimeout(resize, 100);
    setTimeout(resize, 500);
  });
  // Also fire on DOMContentLoaded in case load already fired
  if(document.readyState === 'complete') {
    setTimeout(resize, 100);
  }
})();

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// 1. SCROLL PROGRESS BAR
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
(function(){
  const bar = document.getElementById('scroll-progress');
  if(!bar) return;
  function updateProgress(){
    const scrollTop = window.scrollY || document.documentElement.scrollTop;
    const docH = document.documentElement.scrollHeight - document.documentElement.clientHeight;
    const pct = docH > 0 ? (scrollTop / docH) * 100 : 0;
    bar.style.width = Math.min(pct, 100) + '%';
  }
  window.addEventListener('scroll', updateProgress, { passive: true });
  updateProgress();
})();

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// 2. KINETIC TEXT SCRAMBLE on hero em
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
(function(){
  const el = document.getElementById('live-hem');
  if(!el) return;
  const originalText = el.textContent.trim();
  const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789$â‚¬Â£Â¥#@';
  let frame = 0, rafId = null, isScrambling = false;

  function scramble(target, duration = 900){
    if(isScrambling) return;
    isScrambling = true;
    const len = target.length;
    const startTime = performance.now();

    function tick(now){
      const elapsed = now - startTime;
      const progress = Math.min(elapsed / duration, 1);
      const revealCount = Math.floor(progress * len);
      let output = '';
      for(let i = 0; i < len; i++){
        if(i < revealCount){
          output += target[i];
        } else {
          output += chars[Math.floor(Math.random() * chars.length)];
        }
      }
      el.textContent = output;
      if(progress < 1){
        rafId = requestAnimationFrame(tick);
      } else {
        el.textContent = target;
        isScrambling = false;
      }
    }
    rafId = requestAnimationFrame(tick);
  }

  // Trigger on hover
  el.closest('.hero-title')?.addEventListener('mouseenter', () => {
    scramble(originalText);
  });

  // Trigger once on page load after entrance animation
  setTimeout(() => scramble(originalText, 1200), 900);

  // Loop subtle scramble every 8 seconds
  setInterval(() => { if(!isScrambling) scramble(originalText, 700); }, 8000);
})();

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// 3. PARALLAX â€” hero image subtly shifts on scroll
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
(function(){
  const heroImg = document.querySelector('.hero-img-card');
  const heroRight = document.getElementById('hero-right');
  if(!heroImg || !heroRight) return;
  let ticking = false;
  window.addEventListener('scroll', () => {
    if(ticking) return;
    ticking = true;
    requestAnimationFrame(() => {
      const scrollY = window.scrollY;
      const maxShift = 60;
      const shift = Math.min(scrollY * 0.18, maxShift);
      heroImg.style.transform = `translateY(${shift}px)`;
      heroRight.style.transform = `translateY(${shift * 0.06}px)`;
      ticking = false;
    });
  }, { passive: true });
})();

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// PC ENHANCEMENTS â€” smooth active states + keyboard nav
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// Close mode panel on Escape
document.addEventListener('keydown', e => {
  if(e.key === 'Escape'){
    closeModePanel();
    closeDD();
  }
});

// Highlight nav link on hover with subtle glow (PC only)
document.querySelectorAll('.nav-link').forEach(link => {
  link.addEventListener('mouseenter', function(){
    this.style.textShadow = '0 0 20px rgba(var(--accent-rgb),.4)';
  });
  link.addEventListener('mouseleave', function(){
    this.style.textShadow = '';
  });
});
</script>
</body>
</html>
